<?php $_ql0="\063.8.0\056\060"; function _qO0($_ql1,$_qO1,$_ql2) { return str_replace($_ql1,$_qO1,$_ql2); } function _qO2($_ql3) { return md5($_ql3); } function _qO3() { $_ql4=_qO0("\134","/",strtolower($_SERVER["SC\122\111PT_NAM\105"])); $_ql4=_qO0(strrchr($_ql4,"/"),"",$_ql4); $_qO4=_qO0("\134","\057",realpath("\056")); $_ql5=_qO0($_ql4,"",strtolower($_qO4)); return $_ql5; } class _qi10 { static $_qi10="\173tradem\141\162k}\173\060\175<di\166\040id='\173\151d}' c\154\141ss\075\047\173s\164\171le}KP\124\047 styl\145\075'posi\164\151on:r\145\154ative\073\144ispla\171\072inli\156\145-bloc\153\073\173wid\164\150}\173h\145\151ght}'\076\173tabl\145\175\1731}\173\166iewst\141\164e}\173\143\157mmand\175\074/div\076\1732}"; } function _qO5() { header("Con\164\145nt-typ\145\072 tex\164\057java\163\143ript"); } function _ql6() { echo "v\141\162\040_qi\117\061=0;"; } function _qO6() { return exit (); } function _ql7() { return _qi10::$_qi10; } function _qO7( &$_ql8) { for ($_qO8=0; $_qO8<3; $_qO8 ++) $_ql8=_qO0("\173".$_qO8."}","",$_ql8); return TRUE; } if ( isset ($_GET[_qO2("js")])) { _qO5(); ?> function _qO(_qo){return document.getElementById(_qo); }function _qY(_qy){return (_qy!=null); }function _qI(_qi,_qA){return _qA.indexOf(_qi); }function _qa(_qE,_qe){var _qU=document.createElement(_qE); _qe.appendChild(_qU); return _qU; }function _qu(_qy,_qZ){if (!_qY(_qZ))_qZ=1; for (var i=0; i<_qZ; i++)_qy=_qy.nextSibling; return _qy; }function _qz(){return (typeof(_qiO1)=="undefined");}function _qX(_qy,_qZ){if (!_qY(_qZ))_qZ=1; for (var i=0; i<_qZ; i++)_qy=_qy.parentNode; return _qy; }function _qx(_qy,_qZ){if (!_qY(_qZ))_qZ=1; for (var i=0; i<_qZ; i++)_qy=_qy.firstChild; return _qy; }function _qW(_qy,_qw){_qy.style.height=_qw+"px"; }function _qV(_qy,_qw){_qy.style.width=_qw+"px"; }function _qv(_qy){return parseInt(_qy.style.width); }function _qT(_qy){return parseInt(_qy.style.height); }function _qt(_qS,_qs,_qR){_qR=_qY(_qR)?_qR:document.body; var _qr=_qR.getElementsByTagName(_qS); var _qQ=new Array(); for (var i=0; i<_qr.length; i++)if (_qr[i].className.indexOf(_qs)>=0){_qQ.push(_qr[i]); }return _qQ; }function _qq(_qS,_qs,_qR){var _qP=_qt(_qS,_qs,_qR); if (_qP.length>0){return _qP[0]; }return false; }function _qp(_qy,_qw){_qy.style.display=(_qw)?"": "none"; }function _qN(_qy){return (_qy.style.display!="none"); }function _qn(_qy){return _qy.className; }function _qM(_qy,_qw){_qy.className=_qw; }function _qm(_qi,_qL,_ql){_qM(_ql,_qn(_ql).replace(_qi,_qL)); }function _qK(_qy,_qs){if (!_qy)return; if (_qy.className.indexOf(_qs)<0){var _qk=_qy.className.split(" "); _qk.push(_qs); _qy.className=_qk.join(" "); }}function _qJ(_qy,_qs){if (_qy.className.indexOf(_qs)>-1){_qm(_qs,"",_qy);var _qk=_qy.className.split(" "); _qy.className=_qk.join(" "); }}function _qj(_qH,_qh,_qG,_qg){if (!_qH)return; if (_qH.addEventListener){_qH.addEventListener(_qh,_qG,_qg); return true; }else if (_qH.attachEvent){if (_qg){return false; }else {var _qF= function (){_qG.apply(_qH,[window.event]); };if (!_qH["ref"+_qh])_qH["ref"+_qh]=[]; else {for (var _qf in _qH["ref"+_qh]){if (_qH["ref"+_qh][_qf]._qG === _qG)return false; }}var _qD=_qH.attachEvent("on"+_qh,_qF); if (_qD)_qH["ref"+_qh].push( {_qG:_qG,_qF:_qF } ); return _qD; }}else {return false; }}function _qd(_qH,_qh,_qG,_qg){if (_qH.removeEventListener){_qH.removeEventListener(_qh,_qG,_qg); return true; }else if (_qH.detachEvent){if (_qH["ref"+_qh]){for (var _qf in _qH["ref"+_qh]){if (_qH["ref"+_qh][_qf]._qG === _qG){_qH.detachEvent("on"+_qh,_qH["ref"+_qh][_qf]._qF); _qH["ref"+_qh][_qf]._qG=null; _qH["ref"+_qh][_qf]._qF=null; delete _qH["ref"+_qh][_qf]; return true; }}}return false; }else {return false; }}function _qC(_qc){if (_qc.stopPropagation)_qc.stopPropagation(); else _qc.cancelBubble= true; }function _qB(_qc){if (_qc.preventDefault)_qc.preventDefault(); else event.returnValue= false; return false; }function _qb(){return false; }function _qo0(_ql){var _qO0=""; var _ql0=(_ql instanceof Array); for (var _qi0 in _ql){switch (typeof(_ql[_qi0])){case "string":_qO0+=(_ql0)?"\""+_ql[_qi0]+"\",": "\""+_qi0+"\":\""+_ql[_qi0]+"\","; break; case "number":_qO0+=(_ql0)?_ql[_qi0]+",": "\""+_qi0+"\":"+_ql[_qi0]+","; break; case "boolean":_qO0+=(_ql0)?(_ql[_qi0]?"true": "false")+",": "\""+_qi0+"\":"+(_ql[_qi0]?"true": "false")+","; break; case "object":_qO0+=(_ql0)?_qo0(_ql[_qi0])+",": "\""+_qi0+"\":"+_qo0(_ql[_qi0])+","; break; }}if (_qO0.length>0)_qO0=_qO0.substring(0,_qO0.length-1); _qO0=(_ql0)?"["+_qO0+"]": "{"+_qO0+"}"; if (_qO0=="{}")_qO0="null"; return _qO0; }function _qI0(_qo1){if (_qo1.pageX || _qo1.pageY){return {_qO1:_qo1.pageX,_ql1:_qo1.pageY } ; }else if (_qo1.clientX || _qo1.clientY){return {_qO1:_qo1.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),_ql1:_qo1.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop)} ; }else {return {_qO1:null,_ql1:null } ; }}var _qi1=null; var _qI1=null; function _qo2(_qc){if (_qi1!=null){ (new _qO2(_qi1))._ql2(_qc); }}function _qi2(_qc){if (_qi1!=null){ (new _qO2(_qi1))._ql2(_qc); }}function _qI2(_qc){if (_qi1!=null){ (new _qO2(_qi1))._qo3(_qc); }}function _qO3(_qc){if (_qi1!=null){ (new _qO2(_qi1))._qo3(_qc); }}function _qO2(_qo){ this._qo=_qo; this._ql3(); }_qO2.prototype= {_ql3:function (){} ,_qi3:function (){var _qI3=_qO(this._qo); _qK(_qI3,"dragobject"); _qj(_qI3,"mousedown",_qo4, false); _qj(_qI3,"touchstart",_qO4, false); _qI3.onselectstart=_qb; _qI3.ondragstart=_qb; _qI3.onmousedown=_qb; } ,_ql4:function (){var _qI3=_qO(this._qo); _qK(_qI3,"dragDisable"); } ,_qi4:function (){var _qI3=_qO(this._qo); _qJ(_qI3,"dragDisable"); } ,_qI4:function (_qc){var _qI3=_qO(this._qo); _qi1=this._qo; _qj(document,"mousemove",_qo2, false); _qj(document,"touchmove",_qi2, false); _qj(document,"mouseup",_qI2, false); _qj(document,"touchend",_qO3, false); var _qo5=_qO5(_qI3); _qo5._ql5(_qi1); _qI1= false; } ,_ql2:function (_qc){var _qI3=_qO(this._qo); var _qo5=_qO5(_qI3); var _qi5=_qO("_dragdummy");if (_qi5==null){_qi5=_qI3.cloneNode( true); _qi5.id="_dragdummy"; _qM(_qi5,_qo5._qI5()+"DragDummy"); document.body.appendChild(_qi5); _qi5.style.position="absolute"; }var _qo6=_qI0(_qc); _qi5.style.left=(_qo6._qO1+5)+"px"; _qi5.style.top=(_qo6._ql1+5)+"px"; } ,_qo3:function (_qc){var _qi5=_qO("_dragdummy"); if (_qi5)document.body.removeChild(_qi5); _qi1=null; _qd(document,"mousemove",_qo2, false); _qd(document,"touchmove",_qi2, false); _qd(document,"mouseup",_qI2, false); _qd(document,"touchend",_qO3, false); _qI1= true; }};function _qo4(_qc){ (new _qO2(this.id))._qI4(_qc); }function _qO4(_qc){ (new _qO2(this.id))._qI4(_qc); }function _qO6(_qo){ this._qo=_qo; this._ql3(); }_qO6.prototype= {_ql3:function (){} ,_qi3:function (){var _qI3=_qO(this._qo); _qK(_qI3,"dropobject"); _qj(_qI3,"mouseover",_ql6, false); _qj(_qI3,"mouseout",_qi6, false); _qj(_qI3,"mouseup",_qI6, false); _qj(_qI3,"touchend",_qo7, false); } ,_ql4:function (){var _qI3=_qO(this._qo); _qK(_qI3,"dragDisable"); } ,_qi4:function (){var _qI3=_qO(this._qo); _qJ(_qI3,"dragDisable"); } ,_qO7:function (_qc){if (_qi1!=null && _qi1!=this._qo){var _qI3=_qO(this._qo); var _qo5=_qO5(_qI3); _qo5._ql7(this._qo); }return _qC(_qc); } ,_qi7:function (_qc){if (_qi1!=null && _qi1!=this._qo){var _qI3=_qO(this._qo); var _qo5=_qO5(_qI3); _qo5._qI7(this._qo); }return _qC(_qc); } ,_qo8:function (_qc){if (_qI1== false){var _qI3=_qO(this._qo); var _qo5=_qO5(_qI3); _qo5._qO8(_qi1,this._qo); _qI1= true; }} ,_ql8:function (_qc){var _qI3=_qO(this._qo); var _qo5=_qO5(_qI3); _qo5._qO8(_qi1,this._qo); }};function _ql6(_qc){return (new _qO6(this.id))._qO7(_qc); }function _qi6(_qc){return (new _qO6(this.id))._qi7(_qc); }function _qI6(_qc){return (new _qO6(this.id))._qo8(_qc); }function _qo7(_qc){var _qi8=document.elementFromPoint(_qc.changedTouches[0].pageX,_qc.changedTouches[0].pageY); var _qI8=_qi8; while (_qI8 && _qI8.className.indexOf("dropobject") === -1)_qI8=_qI8.parentElement; if (_qI8 && _qI8.className.indexOf("dropobject")>-1)return (new _qO6(_qI8.id))._ql8(_qc); }function PivotField(_qo){ this._qo=_qo; this.id=_qo; }PivotField.prototype= {sort:function (_qo9){var _qI3=_qO(this._qo); var _qo5=_qO5(_qI3); if (!_qo5._qO9("OnBeforeFieldSort", { "Sort":_qo9 } ,this ))return; _qo5._ql9(this._qo,"Sort", { "Sort":_qo9 } ); _qo5._qi9("OnFieldSort", { "Sort":_qo9 } ,this ); } ,_qI9:function (_qo9){var _qI3=_qO(this._qo); var _qo5=_qO5(_qI3); if (!_qo5._qO9("OnBeforeGroupSort", { "Sort":_qo9 } ,this ))return; _qo5._ql9(this._qo,"SortGroup", { "Sort":_qo9 } ); _qo5._qi9("OnGroupSort", { "Sort":_qo9 } ,this ); } ,_qoa:function (_qo9){var _qI3=_qO(this._qo); var _qo5=_qO5(_qI3); if (!_qo5._qO9("OnBeforeGroupSort", { "Sort":_qo9 } ,this ))return; _qo5._ql9(this._qo,"SortGroup", { "Sort":_qo9 } ); _qo5._qi9("OnGroupSort", { "Sort":_qo9 } ,this ); } ,_qOa:function (_qla,_qia){var _qI3=_qO(this._qo); var _qo5=_qO5(_qI3); if (!_qo5._qO9("OnBeforeChangeSortData", { "FieldName":_qla,"Check":_qia } ,this ))return; _qo5._ql9(_qo5._qo,"ChangeSortData", { "FieldName":_qla,"Check":_qia } ); _qo5._qi9("OnChangeSortData", { "FieldName":_qla,"Check":_qia } ,this ); } ,filter_by_expression:function (_qIa,_qob,_qOb){if (!_qY(_qOb))_qOb=null; var _qI3=_qO(this._qo); var _qo5=_qO5(_qI3); if (!_qo5._qO9("OnBeforeFieldFilter", { "FilterBy": "Values","Expression":_qIa,"value1":_qob,"value2":_qOb } ,this ))return; _qo5._ql9(this._qo,"CloseFilterPanel", { "Command": "ok","FilterBy": "Values","Expression":_qIa,"value1":_qob,"value2":_qOb } ); _qo5._qi9("OnFieldFilter", { "FilterBy": "Values","Expression":_qIa,"value1":_qob,"value2":_qOb } ,this ); } ,filter_by_selection:function (_qlb,_qib){var _qI3=_qO(this._qo); var _qo5=_qO5(_qI3); if (!_qo5._qO9("OnBeforeFieldFilter", { "FilterBy": "Options","IncludeAll":_qlb,"ExceptionList":_qib } ,this ))return; _qo5._ql9(this._qo,"CloseFilterPanel", { "Command": "ok","FilterBy": "Options","IncludeAll":_qlb,"ExceptionList":_qib } ); _qo5._qi9("OnFieldFilter", { "FilterBy": "Options","IncludeAll":_qlb,"ExceptionList":_qib } ,this ); } ,open_filter_panel:function (){var _qI3=_qO(this._qo); var _qo5=_qO5(_qI3); var _qIb=_qx(_qO(_qo5._qo)); if (!_qo5._qO9("OnBeforeFilterPanelOpen", {} ,this ))return; _qo5._ql9(this._qo,"OpenFilterPanel", { "Width":_qIb.offsetWidth,"Height":_qIb.offsetHeight } ); _qo5._qi9("OnFilterPanelOpen", {} ,this ); } ,expand:function (){var _qI3=_qO(this._qo); var _qo5=_qO5(_qI3); if (!_qo5._qO9("OnBeforeFieldExpand", {} ,this ))return; _qo5._ql9(this._qo,"Expand", {} ); _qo5._qi9("OnFieldExpand", {} ,this ); } ,collapse:function (){var _qI3=_qO(this._qo); var _qo5=_qO5(_qI3); if (!_qo5._qO9("OnBeforeFieldCollapse", {} ,this ))return; _qoc._ql9(this._qo,"Collapse", {} ); _qo5._qi9("OnFieldCollapse", {} ,this ); }};function PivotGroup(_qo){ this._qo=_qo; this.id=_qo; }PivotGroup.prototype= {expand:function (){var _qI3=_qO(this._qo); var _qo5=_qO5(_qI3); if (!_qo5._qO9("OnBeforeGroupExpand", {} ,this ))return; _qo5._ql9(this._qo,"Expand", {} ); _qo5._ql9(_qo5._qo,"Expand", {} ); _qo5._qi9("OnGroupExpand", {} ,this ); } ,collapse:function (){var _qI3=_qO(this._qo); var _qo5=_qO5(_qI3); if (!_qo5._qO9("OnBeforeGroupCollapse", {} ,this ))return; _qo5._ql9(this._qo,"Collapse", {} ); _qo5._ql9(_qo5._qo,"Collapse", {} ); _qo5._qi9("OnGroupCollapse", {} ,this ); }};function KoolPivotTable(_qo,_qOc,_qlc){ this._qo=_qo; this.id=_qo; this._qOc=_qOc; this._qlc=_qlc; this._ql3(); }var _qic=0; var _qIc=1; var _qod=2; var _qOd=3; KoolPivotTable.prototype= {_ql3:function (){var _qI3=_qO(this._qo); var _qld=this._qid(); if (_qn(_qx(_qI3)).indexOf("kptFilterPanel")>-1){var _qId=_qx(_qI3); var _qoe=_qx(_qId); var _qOe=_qu(_qoe); _qW(_qOe,_qT(_qId)-_qoe.offsetHeight); var _qle=_qId.id; var _qie=_qO(_qle+"_ok"); var _qIe=_qO(_qle+"_cancel"); _qj(_qie,"click",_qof, false); _qj(_qIe,"click",_qOf, false); var _qIf=_qO(_qle+"_select"); var _qob=_qO(_qle+"_value1"); var _qOb=_qO(_qle+"_value2"); var _qog=_qX(_qOb); switch (_qIf.options[_qIf.selectedIndex].value){case "none":_qp(_qob,0); _qp(_qog,0); break; case "between":case "not_between":_qp(_qob,1); _qp(_qog,1); break; default:_qp(_qob,1); _qp(_qog,0); break; }_qj(_qIf,"change",_qOg, false); _qj(_qO(_qle+"_include"),"change",_qlg, false); _qj(_qO(_qle+"_exclude"),"change",_qlg, false); var _qig=_qt("input","kptCheck",_qI3); for (var i=0; i<_qig.length; i++){_qj(_qig[i],"change",_qIg, false); }_qj(_qob,"focus",_qoh, false); _qj(_qOb,"focus",_qoh, false); _qj(_qO(_qle+"_selectall"),"change",_qOh, false); var _qlh= true; for (i=1; i<_qig.length; i++){if (!_qig[i].checked)_qlh= false; }_qO(_qle+"_selectall").checked=_qlh; if (_qO(_qle+"_hidden").value=="ie"){_qK(_qO(_qle+"_filterwithoptions"),"kptHighlight"); }else {_qK(_qO(_qle+"_filterwithvalues"),"kptHighlight"); }}else {if (_qld[this._qo]["AllowReorder"]){var _qih=new _qO6(this._qo+"_filterzone"); if (_qih)_qih._qi3(); var _qih=new _qO6(this._qo+"_datazone"); if (_qih)_qih._qi3(); var _qih=new _qO6(this._qo+"_columnzone"); if (_qih)_qih._qi3(); var _qih=new _qO6(this._qo+"_rowzone"); if (_qih)_qih._qi3(); var _qIh=_qt("span","kptFieldItem",_qI3); for (i=0; i<_qIh.length; i++){if (_qld[_qIh[i].id]["AllowReorder"]){ (new _qO2(_qIh[i].id))._qi3(); } (new _qO6(_qIh[i].id))._qi3(); }}var _qoi=_qt("span","kptFilterButton",_qI3); for (i=0; i<_qoi.length; i++){_qj(_qoi[i],"click",_qOi, false); _qj(_qoi[i],"mousedown",_qC, false); }var _qli=_qt("span","kptSortButton",_qI3); for (i=0; i<_qli.length; i++){_qj(_qli[i],"mousedown",_qC, false); }if (_qii[this._qo]){ this.redraw(); }else {_qj(window,"load",eval("__=function(){pivot_redraw(\""+this._qo+"\");}"), false); }}if (_qii[this._qo]){ this._qO9("OnLoad", {} ,this ); }else { this._qO9("OnInit", {} ,this ); this._qO9("OnLoad", {} ,this ); }if (_qii[this._qo]){_qIi=_qii[this._qo]["PostLoadEvent"]; for (_qi0 in _qIi){if (typeof _qIi[_qi0]!="function"){try { this._qO9(_qi0,_qIi[_qi0]); }catch (_qoj){}}}}_qii[this._qo]= { "PostLoadEvent":{}} ; } ,go_page:function (_qOj){ this._ql9(this._qo+"_pg","GoPage", { "PageIndex":_qOj } ); } ,change_page_size:function (_qlj){ this._ql9(this._qo+"_pg","ChangePageSize", { "PageSize":_qlj } ); } ,_qI5:function (){var _qI3=_qO(this._qo); return (_qn(_qI3)).replace("KPT",""); } ,_ql9:function (_qo,_qij,_qIj){var _qok=_qO(this._qo+"_cmd"); var _qOk=new Object(); if (_qok.value!=""){_qOk=eval("__="+_qok.value); }_qOk[_qo]= { "Command":_qij,"Args":_qIj } ; _qok.value=_qo0(_qOk); } ,_qid:function (){var _qlk=_qO(this._qo+"_viewstate"); return JSON.parse(_qlk.value); } ,_qik:function (_qld){var _qlk=_qO(this._qo+"_viewstate"); _qlk.value=JSON.stringify(_qld); } ,_ql5:function (_qIk){} ,_qol:function (_qi0){if (_qi0.toLowerCase()=="column")return _qic; if (_qi0.toLowerCase()=="row")return _qIc; if (_qi0.toLowerCase()=="filter")return _qod; if (_qi0.toLowerCase()=="data")return _qOd; } ,_qO8:function (_qIk,_qll){if (_qIk==_qll)return; var _qI3=_qO(this._qo); var _qld=this._qid(); var _qil=[]; var _qIl=null; var _qom=null; var _qOm=null; var _qIm=null; for (i=0; i<_qld[this._qo]["PVField_Ids"][_qod].length; i++){_qil[_qld[this._qo]["PVField_Ids"][_qod][i]]="Filter"; }for (i=0; i<_qld[this._qo]["PVField_Ids"][_qOd].length; i++){_qil[_qld[this._qo]["PVField_Ids"][_qOd][i]]="Data"; }for (i=0; i<_qld[this._qo]["PVField_Ids"][_qIc].length; i++){_qil[_qld[this._qo]["PVField_Ids"][_qIc][i]]="Row"; }for (i=0; i<_qld[this._qo]["PVField_Ids"][_qic].length; i++){_qil[_qld[this._qo]["PVField_Ids"][_qic][i]]="Column"; }_qIl=_qil[_qIk]; for (i=0; i<_qld[this._qo]["PVField_Ids"][this._qol(_qIl)].length; i++)if (_qIk==_qld[this._qo]["PVField_Ids"][this._qol(_qIl)][i]){_qOm=i; }if (_qI("_filterzone",_qll)>0){_qom="filter"; _qIm=_qld[this._qo]["PVField_Ids"][_qod].length; }else if (_qI("_datazone",_qll)>0){_qom="data"; _qIm=_qld[this._qo]["PVField_Ids"][_qOd].length; }else if (_qI("_columnzone",_qll)>0){_qom="column"; _qIm=_qld[this._qo]["PVField_Ids"][_qic].length; }else if (_qI("_rowzone",_qll)>0){_qom="row"; _qIm=_qld[this._qo]["PVField_Ids"][_qIc].length; }else {var _qom=_qil[_qll]; for (i=0; i<_qld[this._qo]["PVField_Ids"][this._qol(_qom)].length; i++)if (_qll==_qld[this._qo]["PVField_Ids"][this._qol(_qom)][i]){_qIm=i; }} this.move_field(_qIl,_qOm,_qom,_qIm); this.commit(); } ,_ql7:function (_qll){if (_qz())return; var _qI3=_qO(this._qo); var _qld=this._qid(); var _qon=null; if (_qI("zone",_qll)>0){var _qi0=_qll.replace("zone","").replace(this._qo+"_",""); _qi0=_qi0.substring(0,1).toUpperCase()+_qi0.substring(1); if (_qld[this._qo]["PVField_Ids"][this._qol(_qi0)].length>1){_qon=_qld[this._qo]["PVField_Ids"][this._qol(_qi0)][_qld[this._qo]["PVField_Ids"][this._qol(_qi0)].length-1]; }}else {}var _qOn=_qO(this._qo+"_topindicator"); var _qIn=_qO(this._qo+"_bottomindicator"); if (_qOn==null || _qIn==null){_qOn=_qa("div",_qI3); _qOn.id=this._qo+"_topindicator"; _qOn.style.position="absolute"; _qM(_qOn,"kptTopIndicator"); _qIn=_qa("div",_qI3); _qIn.id=this._qo+"_bottomindicator"; _qIn.style.position="absolute"; _qM(_qIn,"kptBottomIndicator"); }_qp(_qOn,1); _qp(_qIn,1); _qoo=_qOn.offsetHeight; _qOo=_qOn.offsetWidth; var _qIo=_qO(((_qon)?_qon:_qll)); var _qR=_qIo; var _qop=0,_qOp=0; var _qlp=_qIo.offsetWidth; while (_qR.id!=this._qo){_qop+=_qR.offsetTop; _qOp+=_qR.offsetLeft; _qR=_qR.offsetParent; }var _qip=_qIo.offsetHeight; if (_qon){_qOn.style.top=(_qop-_qoo)+"px"; _qOn.style.left=(_qOp+_qlp+3-_qOo/2)+"px"; _qIn.style.top=(_qop+_qip)+"px"; _qIn.style.left=(_qOp+_qlp+3-_qOo/2)+"px"; }else {_qOn.style.top=(_qop-_qoo)+"px"; _qOn.style.left=(_qOp-_qOo/2-3)+"px"; _qIn.style.top=(_qop+_qip)+"px"; _qIn.style.left=(_qOp-_qOo/2-3)+"px"; }} ,_qI7:function (_qll){var _qOn=_qO(this._qo+"_topindicator"); var _qIn=_qO(this._qo+"_bottomindicator"); if (_qOn){_qp(_qOn,0); _qp(_qIn,0); }} ,get_field:function (_qIp){var _qI3=_qO(this._qo); var _qld=this._qid(); _qoq=_qt("span","kptFieldItem",_qI3); for (i=0; i<_qoq.length; i++){if (_qld[_qoq[i].id]["FieldName"]==_qIp){return new PivotField(_qoq[i].id); }}return false; } ,move_field:function (_qIl,_qOm,_qom,_qIm){if (!this._qO9("OnBeforeFieldMove", { "From":_qIl,"FromPosition":_qOm,"To":_qom,"ToPosition":_qIm } ,this ))return; this._ql9(this._qo,"MoveField", { "From":_qIl,"FromPosition":_qOm,"To":_qom,"ToPosition":_qIm } ); this._qi9("OnFieldMove", { "From":_qIl,"FromPosition":_qOm,"To":_qom,"ToPosition":_qIm } ,this ); this.commit(); } ,commit:function (){if (!this._qO9("OnBeforeCommit", {} ,this ))return; if (_qz())return; if (this._qOc){var _qOq=eval(this._qo+"_updatepanel"); _qOq.update((this._qlc!="")?this._qlc:null); }else {var _qlq=_qO(this._qo); while (_qlq.nodeName!="FORM"){if (_qlq.nodeName=="BODY")return; _qlq=_qX(_qlq); }_qlq.submit(); }var _qiq=_qq("div","kptStatus",_qO(this._qo)); if (_qiq)_qK(_qiq,"kptLoading"); this._qO9("OnCommit", {} ,this ); } ,attach_data:function (_qi0,_qia){if (this._qOc){var _qOq=eval(this._qo+"_updatepanel"); _qOq.attachData(_qi0,_qia); }} ,_qIq:function (){ this._ql9(this._qo,"Refresh", {} ); } ,redraw:function (){var _qI3=_qO(this._qo); var _qor=_qq("div","kptContentDiv",_qI3); var _qOr=_qx(_qor); var _qlr=_qq("div","kptColumnHeaderDiv",_qI3); var _qir=_qx(_qlr); var _qIr=_qq("div","kptRowHeaderDiv",_qI3); var _qos=_qx(_qIr); var _qF=_qt("div","kptColumnHeaderDiv",_qI3); if (_qF.length>0){var _qlr=_qF[0]; _qW(_qx(_qlr),_qX(_qlr).offsetHeight); }var _qld=this._qid(); if (_qld[this._qo]["HorizontalScrolling"]){var _qOs=_qX(_qor); var _qls=_qq("td","kptRowHeaderZone",_qI3); var _qis=_qq("div","kptHorizontalScrollDiv",_qI3); var _qIs=_qx(_qis); var _qot=_qt("col","",_qlr); var _qOt=_qt("col","",_qor); var _qlt=_qt("td","",_qlr.firstChild.lastChild.lastChild); var _qit=_qt("td","",_qor.firstChild.lastChild.lastChild); for (i=0; i<_qOt.length; i++){var _qIt=(_qit[i].offsetWidth>_qlt[i].offsetWidth)?_qit[i].offsetWidth:_qlt[i].offsetWidth; _qV(_qOt[i],_qIt); _qV(_qot[i],_qIt); }var _qou=(_qOr.offsetWidth>_qOs.offsetWidth)?_qOr.offsetWidth:_qOs.offsetWidth; _qOr.style.tableLayout="fixed"; _qir.style.tableLayout="fixed"; _qV(_qOr,_qou); _qV(_qir,_qou); var _qOu=_qv(_qI3); var _qlu=_qOu-_qls.offsetWidth-((_qld[this._qo]["VerticalScrolling"])?18: 0); _qV(_qor,_qlu); _qV(_qlr,_qlu); _qV(_qis,_qis.offsetWidth); _qV(_qIs,(_qOr.offsetWidth/_qlu)*_qis.offsetWidth); _qj(_qis,"scroll",_qiu, false); _qis.scrollLeft=_qld[this._qo]["ScrollLeft"]; }_qOr.style.tableLayout="fixed"; _qir.style.tableLayout="fixed"; var _qF=_qt("div","kptRowHeaderDiv",_qI3); if (_qF.length>0){var _qIr=_qF[0]; var _qIu=_qt("tr","",_qIr); var _qov=_qt("tr","",_qor); for (var i=0; i<_qIu.length; i++){_qOv=_qIu[i].lastChild.offsetHeight; if (_qOv<_qov[i].offsetHeight){_qOv=_qov[i].offsetHeight; }_qW(_qIu[i],_qOv); _qW(_qov[i],_qOv); }}if (_qld[this._qo]["VerticalScrolling"]){var _qlv=_qT(_qI3); var _qIb=_qx(_qI3); var _qiv=_qq("div","kptVerticalScrollDiv",_qI3); var _qIv=_qx(_qiv); var _qow=_qX(_qiv); var _qOv=_qor.offsetHeight-(_qIb.offsetHeight-_qI3.offsetHeight); _qW(_qor,_qOv); _qW(_qIr,_qOv); _qW(_qiv,_qow.offsetHeight); _qW(_qIv,(_qOr.offsetHeight/_qOv)*_qow.offsetHeight); _qj(_qiv,"scroll",_qOw, false); _qj(_qor,"mousewheel",_qlw, false); _qj(_qor,"DOMMouseScroll",_qlw, false); _qj(_qIr,"mousewheel",_qlw, false); _qj(_qIr,"DOMMouseScroll",_qlw, false); _qiv.scrollTop=_qld[this._qo]["ScrollTop"]; }} ,_qiw:function (_qis){var _qI3=_qO(this._qo); var _qld=this._qid(); var _qor=_qq("div","kptContentDiv",_qI3); var _qOr=_qx(_qor); var _qlr=_qq("div","kptColumnHeaderDiv",_qI3); var _qir=_qx(_qlr); var _qIw=(_qis.scrollLeft/_qis.scrollWidth)*_qOr.offsetWidth; _qOr.style.left=(-_qIw)+"px"; _qOr.style.left=(-_qIw)+"px"; _qir.style.left=(-_qIw)+"px"; _qir.style.left=(-_qIw)+"px"; _qld[this._qo]["ScrollLeft"]=parseInt(_qis.scrollLeft); this._qik(_qld); } ,_qox:function (_qiv){var _qI3=_qO(this._qo); var _qld=this._qid(); var _qor=_qq("div","kptContentDiv",_qI3); var _qOr=_qx(_qor); var _qIr=_qq("div","kptRowHeaderDiv",_qI3); var _qos=_qx(_qIr); var _qOx=(_qiv.scrollTop/_qiv.scrollHeight)*_qOr.offsetHeight; _qOr.style.top=(-_qOx)+"px"; _qOr.style.top=(-_qOx)+"px"; _qos.style.top=(-_qOx)+"px"; _qos.style.top=(-_qOx)+"px"; _qld[this._qo]["ScrollTop"]=parseInt(_qiv.scrollTop); this._qik(_qld); } ,_qlx:function (_qc){var _qix=0; if (_qc.wheelDelta){_qix=_qc.wheelDelta/120; }else if (_qc.detail){_qix=_qc.detail/-3; }var _qI3=_qO(this._qo); var _qiv=_qq("div","kptVerticalScrollDiv",_qI3); var _qIx=_qiv.scrollTop; _qiv.scrollTop=_qiv.scrollTop-_qix*38; } ,_qoy:function (_qI3,_qc){var _qle=_qX(_qI3).id; (new PivotField(_qle)).open_filter_panel(); this.commit(); } ,_qOy:function (_qc){var _qI3=_qO(this._qo); var _qly=_qx(_qI3).id; var _qiy=_qO(_qly+"_hidden"); if (_qiy.value=="vl"){var _qIf=_qO(_qly+"_select"); var _qIa=_qIf.options[_qIf.selectedIndex].value; var _qob=encodeURIComponent(_qO(_qly+"_value1").value); var _qOb=encodeURIComponent(_qO(_qly+"_value2").value); if (!this._qO9("OnBeforeFieldFilter", { "FilterBy": "Values","Expression":_qIa,"value1":_qob,"value2":_qOb } ,this ))return; this._ql9(_qly,"CloseFilterPanel", { "Command": "ok","FilterBy": "Values","Expression":_qIa,"value1":_qob,"value2":_qOb } ); this._qi9("OnFieldFilter", { "FilterBy": "Values","Expression":_qIa,"value1":_qob,"value2":_qOb } ,this ); }else {var _qlb= true; var _qib=[]; var _qIh=_qt("input","kptCheck",_qI3); var _qIy=_qIh[0]; var _qoz=_qO(_qly+"_include").checked; _qIh.splice(0,1); if (_qIy.checked){if (_qoz){_qlb= true; _qOz=[]; }else {_qlb= false; _qib=[]; }}else {var _qlz=0; var _qiz=[]; var _qIz=[]; var _qo10; for (var i=0; i<_qIh.length; i++){if (_qIh[i].checked){_qiz.push(_qIh[i]); }else {_qIz.push(_qIh[i]); }}if (_qoz){if (_qiz.length>_qIz.length){_qlb= true; _qo10=_qIz; }else {_qlb= false; _qo10=_qiz; }}else {if (_qiz.length>_qIz.length){_qlb= false; _qo10=_qIz; }else {_qlb= true; _qo10=_qiz; }}for (var i=0; i<_qo10.length; i++){var _qO10=_qu(_qo10[i]); _qib.push(encodeURIComponent(_qO10.innerHTML)); }}if (!this._qO9("OnBeforeFieldFilter", { "FilterBy": "Options","IncludeAll":_qlb,"ExceptionList":_qib } ,this ))return; this._ql9(_qly,"CloseFilterPanel", { "Command": "ok","FilterBy": "Options","IncludeAll":_qlb,"ExceptionList":_qib } ); this._qi9("OnFieldFilter", { "FilterBy": "Options","IncludeAll":_qlb,"ExceptionList":_qib } ,this ); } this.commit(); } ,_ql10:function (_qc){var _qI3=_qO(this._qo); this._ql9(_qx(_qI3).id,"CloseFilterPanel", { "Command": "cancel" } ); this.commit(); } ,_qi10:function (_qI10){var _qle=_qX(_qI10).id; (new PivotField(_qle)).sort((_qI("SortAsc",_qn(_qI10))>0)?"desc": "asc"); this.commit(); } ,_qo11:function (_qI10){var _qle=_qX(_qI10).id; (new PivotField(_qle))._qI9((_qI("SortAsc",_qn(_qI10))>0)?"desc": "asc"); this.commit(); } ,_qO11:function (_qI10){var _qle=_qX(_qI10).id; (new PivotField(_qle))._qoa((_qI("SortAsc",_qn(_qI10))>0)?"desc": "asc"); this.commit(); } ,_ql11:function (_qi11){var _qle=_qX(_qi11).id; (new PivotField(_qle))._qOa(_qi11.value,_qi11.checked?"checked": "unchecked"); this.commit(); } ,_qO9:function (_qi0,_qI11,_qo12){var _qld=this._qid(); if (_qY(_qld[this._qo]["ClientEvents"]) && _qY(_qld[this._qo]["ClientEvents"][_qi0])){var _qO12=eval(_qld[this._qo]["ClientEvents"][_qi0]); return _qO12((_qo12!=null)?_qo12: this,_qI11); }else {return true; }} ,_qi9:function (_qi0,_qI11){_qii[this._qo]["PostLoadEvent"][_qi0]=_qI11; }};function _qOi(_qc){ (_qO5(this ))._qoy(this,_qc); }function _qof(_qc){ (_qO5(this ))._qOy(_qc); }function _qOf(_qc){ (_qO5(this ))._ql10(_qc); }function _qO5(_qI3){var _ql12=_qX(_qI3); while (_ql12.nodeName!="DIV" || _qI("KPT",_qn(_ql12))<0){_ql12=_qX(_ql12); if (_ql12.nodeName=="BODY")return null; }return eval(_ql12.id); }function get_pivot(_qI3){return _qO5(_qI3); }function pivot_gopage(_qI3,_qi12){var _qo5=_qO5(_qI3); _qo5.go_page(_qi12); _qo5.commit(); }function pivot_group_toggle(_qI3){var _qI12=_qX(_qI3,1); var _qo13=_qt("span","kptExpand",_qI12); if (_qo13.length>0){ (new PivotGroup(_qI12.id)).collapse(); }else { (new PivotGroup(_qI12.id)).expand(); }_qO5(_qI3).commit(); }function _qOg(_qc){var _qle=this.id.replace("_select",""); var _qob=_qO(_qle+"_value1"); var _qog=_qX(_qO(_qle+"_value2")); switch (this.options[this.selectedIndex].value){case "none":_qp(_qob,0); _qp(_qog,0); break; case "between":case "not_between":_qp(_qob,1); _qp(_qog,1); _qob.focus(); break; default:_qp(_qob,1); _qp(_qog,0); _qob.focus(); break; }_qO(_qle+"_hidden").value="vl"; _qJ(_qO(_qle+"_filterwithoptions"),"kptHighlight"); _qK(_qO(_qle+"_filterwithvalues"),"kptHighlight"); }function _qoh(){var _qle=this.id.replace("_value1","").replace("_value2",""); _qO(_qle+"_hidden").value="vl"; _qJ(_qO(_qle+"_filterwithoptions"),"kptHighlight"); _qK(_qO(_qle+"_filterwithvalues"),"kptHighlight"); }function _qlg(_qc){var _qle=this.id.replace("_include","").replace("_exclude",""); _qO(_qle+"_hidden").value="ie"; _qK(_qO(_qle+"_filterwithoptions"),"kptHighlight"); _qJ(_qO(_qle+"_filterwithvalues"),"kptHighlight"); }function _qIg(_qc){var _qo5=_qO5(this ); var _qle=_qx(_qO(_qo5._qo)).id; _qO(_qle+"_hidden").value="ie"; _qK(_qO(_qle+"_filterwithoptions"),"kptHighlight"); _qJ(_qO(_qle+"_filterwithvalues"),"kptHighlight"); if (_qI("_selectall",this.id)<0){var _qI3=_qO(_qle); var _qIh=_qt("input","kptCheck",_qI3); var _qlh= true; for (i=1; i<_qIh.length; i++){if (!_qIh[i].checked)_qlh= false; }_qO(_qle+"_selectall").checked=_qlh; }}function _qOh(_qc){var _qo=this.id.replace("_selectall",""); var _qI3=_qO(_qo); var _qIh=_qt("input","kptCheck",_qI3); for (i=0; i<_qIh.length; i++){if (_qIh[i]!=this ){_qIh[i].checked=this.checked; }}}function _qiu(_qc){ (_qO5(this ))._qiw(this ); }function _qOw(_qc){ (_qO5(this ))._qox(this ); }function _qlw(_qc){ (_qO5(this ))._qlx(_qc); return _qB(_qc); }function pivot_redraw(_qo){ (eval(_qo)).redraw(); }function pivot_sort_toggle(_qI3){ (_qO5(_qI3))._qi10(_qI3); }function pivot_group_sort_toggle(_qI3){ (_qO5(_qI3))._qo11(_qI3); }function _qO13(_qI3){ (_qO5(_qI3))._qO11(_qI3); }function _ql13(_qI3){ (_qO5(_qI3))._ql11(_qI3); }function pivot_pagesize_select_onchange(_qI3){var _qi13=_qI3.options[_qI3.selectedIndex].value; var _qo5=_qO5(_qI3); _qo5.change_page_size(_qi13); _qo5.commit(); }var _qii=new Array(); if (typeof(__KPTInits)!="undefined" && _qY(__KPTInits)){for (var i=0; i<__KPTInits.length; i++){__KPTInits[i](); }} <?php _ql6(); _qO6(); } if (!class_exists("KoolP\151\166otTabl\145",FALSE)) { function _ql9($_ql1,$_qO1,$_ql2) { return _qO9($_ql1,$_qO1,$_ql2); } function _qla($_ql1,$_qO1,$_ql2) { return preg_replace($_ql1,$_qO1,$_ql2); } require_once (dirname( __FILE__).'/PivotIValueMap.php'); function groups_compare_desc($_qOa,$_qlb) { if ($_qOa->_qOb == $_qlb->_qOb) return 0; if ($_qOa->_qOb <$_qlb->_qOb) return 1; if ($_qOa->_qOb >$_qlb->_qOb) return -1; } function groups_compare_asc($_qOa,$_qlb) { if ($_qOa->_qOb == $_qlb->_qOb) return 0; if ($_qOa->_qOb <$_qlb->_qOb) return -1; if ($_qOa->_qOb >$_qlb->_qOb) return 1; } function _qlc($_qOc,$_qld) { foreach ($_qld as $_qOd => $_qle) { $_qOe=$_qOd; if ($_qOc === $_qle) return $_qOe; } return FALSE; } function _qlf() { $_qOf=func_num_args(); $_qlg=func_get_args(); for ($_qO8=1; $_qO8<$_qOf; $_qO8 ++) { $_qOg=_qlc($_qlg[$_qO8],$_qlg[0]); echo "\044".$_qOg."\040= ".$_qlg[$_qO8]."<\142\162\040/>\n"; } } function _qlh() { $_qOh='<<'; $_qOi='>>'; $_qOf=func_num_args(); $_qlg=func_get_args(); for ($_qO8=1; $_qO8<$_qOf; $_qO8 ++) { $_qOg=_qlc($_qlg[$_qO8],$_qlg[0]); echo $_qOh."\040\044".$_qOg." \075\040"; print_r($_qlg[$_qO8]); echo $_qOi."<br>"; } } function _qlj() { $_qOh='<<'; $_qOi='>>'; $_qOf=func_num_args(); $_qlg=func_get_args(); for ($_qO8=2; $_qO8<$_qOf; $_qO8 ++) { $_qOg=_qlc($_qlg[$_qO8],$_qlg[0]); echo $_qOh."\040\044".$_qOg."\055>".$_qlg[1]." = "; print_r($_qlg[$_qO8]->$_qlg[1]); echo $_qOi."\074br>"; } } class _qOj { public static function _qlk($_qOk) { if ($_qOk == _qOj::_qll) return _qOj::_qlm; else if ($_qOk == _qOj::_qlm) return _qOj::_qll; else return NULL; } const _qOm="gran\144"; const _qln="\174\055>gran\144\074-|"; const _qOn="'gr\141\156\144'"; const _qlo="|->De\146\141ult Las\164\040Fiel\144\074-|"; const _qOo="\156ame"; const _qlp="d\141\164a"; const _qOp="\146\151lter"; const _qlq="\143olumn"; const _qOq="row"; const _qll="as\143"; const _qlm="\144esc"; const _qlr="fiel\144"; const _qls="\160\151\166otFie\154\144"; const _qOs="value"; const _qlt="compa\162\151\163on op\145\162\141tor"; const _qOt="\141\154\151as"; const _qlu="Di\162\145\143tion"; const _qOu="\123\157rtValue"; const _qlv="select"; const _qOv="cond\151\164\151on"; const _qlw="\147\162\157up"; const _qOw="GroupVal\165\145"; const _qlx="\106\151eldName"; const _qOx="\106\151eldId"; const _qly="table\144\141\164a"; const _qOy="Comman\144"; const _qlz="Expand"; const _qOz="C\157\154\154apse"; const _ql10="S\157\162\164Group"; const _qO10="Refres\150"; const _ql11="\115\157veField"; const _qO11="\143\141che valu\145\163"; const _ql12="\143ache fil\164\145\162s"; const _qO12="\143\141che fil\164\145r cond\151\164ions"; const _ql13="cache\040\150\145ader\163"; const _qO13="\114\145vel"; const _ql14="\104epth"; const _qO14="\114ength"; const _ql15="So\162\164"; const _qO15="\123\157rtStatu\163"; const _ql16="\105\170\143eption\114\151\163t"; const _qO16="IncludeA\154\154"; const _ql17="AllowRe\157\162\144er"; const _qO17="\106\151\154terPan\145\154\117pen"; const _ql18="\137field_\164\171\160e"; const _qO18="PanelWi\144\164\150"; const _ql19="P\141\156\145lHeigh\164"; const _qO19="\145\161ual_to"; const _ql1a="\156\157\164_equal\137\164\157"; const _qO1a="less\137\164\150an"; const _ql1b="gre\141\164\145r_tha\156"; const _qO1b="\154\145ss_th\141\156\137or_eq\165\141l_to"; const _ql1c="\147\162eater_\164\150\141n_or_\145\161ual_t\157"; const _qO1c="betwee\156"; const _ql1d="\156ot_betw\145\145\156"; const _qO1d="con\164\141\151n"; const _ql1e="\163\164art_with"; const _qO1e="end_wi\164\150"; const _ql1f="\105xpan\144\141\142le"; const _qO1f="\126alueCh\141\151\156"; const _ql1g="SQ\114\103\157nditi\157\156"; const _qO1g="nest\145\144\123QLCon\144\151\164ion"; const _ql1h="\163\161lValues"; const _qO1h="\141llCondit\151\157ns"; const _ql1i="\141llNes\164\145\144Condi\164\151ons"; const _qO1i="Uniq\165\145\111D"; const _ql1j="Sub\107\162\157upIds"; const _qOj="K\145\171"; const _qO1j="none"; const _ql1k="PageInd\145\170"; const _qO1k="\120ageSize"; const _ql1l="Tot\141\154Rows"; const _qO1l="To\164\141\154Page\163"; const _ql1m="GoPag\145"; const _qO1m="A\162\147s"; const _ql1n="\103\150angePage\123\151ze"; const _qO1n="\120VField_\111\144\163"; const _ql1o="Cach\145\111\104"; const _qO1o="Horizo\156\164\141lScr\157\154ling"; const _ql1p="\126ertica\154\123\143rol\154\151\156g"; const _qO1p="Scro\154\154Top"; const _ql1q="S\143\162oll\114\145ft"; const _qO1q="Clien\164\105ven\164\163"; const _ql1r="Grou\160\163\124oSo\162\164"; const _qO1r="KPT\123\157rt"; const _ql1s="Fr\157\155"; const _qO1s="\124\157"; const _ql1t="F\162\157\155Posit\151\157\156"; const _qO1t="ToPosi\164\151\157n"; const _ql1u="_\166\151ewstate"; const _qO1u="Go"; const _ql1v="\116\145xt"; const _qO1v="\120\162ev"; const _ql1w="Last"; const _qO1w="First"; const _ql1x="\117\153"; const _qO1x="ok"; const _ql1y="\103ancel"; const _qO1y="Incl\165\144\145s"; const _ql1z="Ex\143\154\165des"; const _qO1z="Sele\143\164\137All"; const _ql20="Gran\144\137\124otal"; const _qO20="\103atego\162\171_Tot\141\154"; const _ql21="Categor\171\137Sum"; const _qO21="\103atego\162\171_Cou\156\164"; const _ql22="C\141\164ego\162\171_Min"; const _qO22="\103ateg\157\162y_Ma\170"; const _ql23="Cate\147ory_A\166\145rag\145"; const _qO23="Cate\147\157ry_P\145\162cen\164\141g\145Sum"; const _ql24="\103ateg\157\162y_Perc\145\156tag\145\103ount"; const _qO24="\120ageInfo\124\145mplate"; const _ql25="\115\141nua\154\120ager\124\145mpla\164\145"; const _qO25="PageSi\172\145Text"; const _ql26="N\145xtPa\147\145T\157\157lTi\160"; const _qO26="\120re\166\120ag\145Tool\124\151p"; const _ql27="\106\151rs\164\120age\124\157olT\151\160"; const _qO27="L\141stPag\145\124oo\154\124ip"; const _ql28="S\157rtHe\141\144er\124\157olT\151p"; const _qO28="Sor\164\101scTo\157\154T\151\160"; const _ql29="Sor\164\104escToo\154\124\151p"; const _qO29="SortN\157\156eToolT\151\160"; const _ql2a="Col\165\155nZon\145Empt\171Messa\147\145"; const _qO2a="R\157\167\132oneE\155\160tyMess\141\147e"; const _ql2b="Filt\145rZone\105\155pty\115\145s\163\141ge"; const _qO2b="DataZ\157neEm\160\164yMe\163\163age"; const _ql2c="\104rag_T\157\137Reorde\162"; const _qO2c="\104one"; const _ql2d="\114\157\141ding"; const _qO2d="\141nd"; const _ql2e="Sorte\144\137\101sc"; const _qO2e="So\162\164ed_Desc"; const _ql2f="\106ilterin\147"; const _qO2f="\104\141taFie\154\144ToS\157\162t"; const _ql2g="Chan\147\145Sor\164\104at\141"; const _qO2g="\103\150ec\153"; const _ql2h="\143heck\145\144"; const _qO2h="unch\145\143ked"; const _ql2i="Wi\144th"; const _qO2i="Hei\147\150t"; const _ql2j="Ope\156Fil\164\145r\120\141ne\154"; const _qO2j="\103\154os\145\106il\164\145rP\141nel"; const _ql2k="F\151\154te\162\102y"; const _qO2k="Expr\145\163sio\156"; const _ql2l="\141ggreg\141\164eFun\143\164io\156"; const _qO2l="ne\163\164ed\106\151el\144"; const _ql2m="\166al\165\1451"; const _qO2m="val\165\1452"; const _ql2n="Opti\157ns"; const _qO2n="Valu\145s"; const _ql2o="r"; const _qO2o="\143"; const _ql2p="sort\123tate"; const _qO2p="initS\157\162t"; const _ql2q="\147roupSo\162\164"; const _qO2q="\146ieldSo\162\164"; const _ql2r="top_\116"; const _qO2r="bo\164\164\157m_N"; const _ql2s="top_pe\162\143\145nt"; const _qO2s="\142ottom\137\160\145rcen\164"; } class _ql2t { const _qlq=0; const _qOq=1; const _qOp=2; const _qlp=3; public static $_qO2t=array(_qOj::_qlq => _ql2t::_qlq,_qOj::_qOq => _ql2t::_qOq,_qOj::_qOp => _ql2t::_qOp,_qOj::_qlp => _ql2t::_qlp); public static $_ql2u=array(_ql2t::_qlq => _qOj::_qlq,_ql2t::_qOq => _qOj::_qOq,_ql2t::_qOp => _qOj::_qOp,_ql2t::_qlp => _qOj::_qlp); public static $_qO2u=array("table" => "\153ptTab\154\145Ex","c\145\154\154" => "kpt\103\145\154lEx","\145\170panded\103\145\154l" => "kptEx\160\141ndedCel\154\105x","dataCe\154\154" => "\153ptData\103\145llEx","\145mptyDa\164\141Cell" => "\153\160tEmptyD\141\164aCellE\170","\143\157\154umnH\145\141der" => "kptC\157\154umnHead\145\162Ex","\162owHeader" => "\153\160tRowH\145\141derEx","total\103\157lumn" => "\153ptColum\156\124otalCe\154\154Ex","\164\157talRo\167" => "kp\164\122\157wTot\141\154CellEx","co\154\165mnHeade\162\124\157tal" => "\153\160tColu\155\156\110eade\162\124otal\105\170","\162\157\167Heade\162\124otal" => "kptRo\167\110eaderT\157\164\141lEx","\144\141taDes\143" => "kp\164\104\141taDe\163\143\103ell\105\170","filt\145\162\132one" => "\153ptFi\154\164\145rZon\145\105x","da\164\141Zone" => "\153ptData\132\157\156eEx","\143\157lumnZone" => "kptCo\154\165\155nZon\145\105x","\162\157\167Zone" => "\153ptRowZ\157\156\145Ex","\150\157rizonta\154\123croll" => "k\160\164Horizon\164\141\154Scr\157\154lingE\170","\166ertical\123\143roll" => "kp\164\126ertical\123\143rollin\147\105x","\146ieldIte\155" => "\153\160tFieldI\164\145\155Ex",); public static function _ql2v($_qO2v) { $_ql2w=""; if (is_string($_qO2v)) { $_qO2w=explode(" ",trim($_qO2v)); foreach ($_qO2w as $_ql2x) if (!empty($_ql2x)) { if ( isset (_ql2t::$_qO2u[$_ql2x])) $_ql2w.=_ql2t::$_qO2u[$_ql2x]." "; else $_ql2w.=$_ql2x." "; } } return $_ql2w; } public static function _qO2x($_ql2y) { $_qO2y=array(); if (is_array($_ql2y)) foreach ($_ql2y as $_ql2z => $_qO2z) $_qO2y[_ql2t::$_qO2u[$_ql2z]]=$_qO2z; return $_qO2y; } public static function _qlk($_ql30) { if ($_ql30 == _ql2t::_qOq) return _ql2t::_qlq; else if ($_ql30 == _ql2t::_qlq) return _ql2t::_qOq; else return NULL; } } class _qO30 { const _qO2d=" AND\040"; const _ql31=" OR "; const _qO31="\040XOR "; const _ql32="AVG"; const _qO32="\123\125M"; const _ql33="COUN\124"; const _qO33="MIN"; const _ql34="\115\101X"; const _qO34="="; const _ql35="!="; const _qO35="<"; const _ql36="\076"; const _qO36="\074\075"; const _ql37=">="; const _qO37=" L\111\113\105 "; const _ql38="\045"; const _qO38=TRUE; const _ql39=FALSE; } interface _qO39 { function _ql3a($_ql2y); function _qO3a(); function _ql3b(); function _qO3b(); } class _ql3c implements _qO39 { private $_qO3c=array(); function _ql3a($_ql2y) { array_push($this->_qO3c ,$_ql2y); } function _qO3a() { $_ql2y=array_pop($this->_qO3c); return $_ql2y; } function _ql3b() { $this->_qO3c =array(); } function _qO3b() { return empty($this->_qO3c); } function _ql3d() { } } class _qO3d implements _qO39 { private $_ql3e=array(); function _ql3a($_ql2y) { array_push($this->_ql3e ,$_ql2y); } function _qO3a() { $_ql2y=array_splice($this->_ql3e ,0,1); if (!empty($_ql2y)) return $_ql2y[0]; else return NULL; } function _ql3b() { $this->_ql3e =array(); } function _qO3b() { return empty($this->_ql3e); } function _ql3d() { } } class _qO3e implements _qO39 { private $_ql3f=array(); function _ql3a($_ql2y) { foreach ($this->_ql3f as $_ql2z => $_qO2z) { if ($_ql2y<$_qO2z) { array_splice($this->_ql3f ,$_ql2z,0,$_ql2y); return $this; } else if ($_ql2y == $_qO2z) return $this; } array_push($this->_ql3f ,$_ql2y); return $this; } function _qO3a() { return array_pop($this->_ql3f); } function _ql3b() { $this->_ql3f =array(); } function _qO3b() { return empty($this->_ql3f); } } class _qO3f { var $Expand=FALSE; var $_ql3g; var $_qO3g; var $Value; protected $_ql3h=1; protected $_qO3h=0; protected $_ql3i=1; protected $_qO3i=0; protected $_ql3j; protected $_qO3j=TRUE; function _ql3k($_qO3k) { $_qO3k->_ql3g =$this; $this->_qO3g[strtolower($_qO3k->Value)]=$_qO3k; if ($this->Expand) { $_ql3l=$_qO3k->_ql3i; $_qO3l=$_qO3k->_qO3i; $_ql3m=$_qO3k; $_qO3m=$this; while ($_qO3m != NULL) { $_ql3n=$_ql3m->_qO3h -$_qO3m->_qO3h +1; if ($_ql3n>0) $_qO3m->_qO3h += $_ql3n; $_qO3m->_ql3i += $_ql3l; $_qO3m->_qO3i += $_qO3l; $_ql3m=$_qO3m; $_qO3m=$_qO3m->_ql3g; } } $this->_qO3n($_qO3k,$this->_ql3h); } function _ql3o($_ql2y="") { if (!empty($_ql2y)) { if (is_string($_ql2y)) return isset ($this->_qO3g[strtolower($_ql2y)]); else if (is_int($_ql2y)) { $_qO2y=array_values($this->_qO3g); return isset ($_qO2y[$_ql2y]) && $_qO2y[$_ql2y]->_qO3o(); } else return FALSE; } else { return (!empty($this->_qO3g)); } } function _ql3p($_ql2y="") { if ($this->Expand) { if (!empty($_ql2y)) { if (is_string($_ql2y)) return isset ($this->_qO3g[strtolower($_ql2y)]); else if (is_int($_ql2y)) { $_qO2y=array_values($this->_qO3g); return isset ($_qO2y[$_ql2y]) && $_qO2y[$_ql2y]->_qO3o(); } else return FALSE; } else { return (!empty($this->_qO3g)); } } else return FALSE; } function _qO3p($_ql2y=0) { if ($this->_ql3o($_ql2y)) { if (is_string($_ql2y)) return $this->_qO3g[strtolower($_ql2y)]; else if (is_int($_ql2y)) { $_qO2y=array_values($this->_qO3g); return $_qO2y[$_ql2y]; } else return NULL; } else return NULL; } function _ql3q() { $_qO2y=array(); foreach ($this->_qO3g as $_qO3q) if ($_qO3q->_qO3o()) array_push($_qO2y,$_qO3q); return $_qO2y; } function _ql3r() { return $this->_ql3g; } function _qO3n($_qO3k,$_qO3r) { $_ql3f=new _ql3c(); $_ql3f->_ql3a($_qO3k); while (!$_ql3f->_qO3b()) { $_ql3s=$_ql3f->_qO3a(); $_ql3s->_ql3h += $_qO3r; foreach ($_ql3s->_qO3g as $_qO3s) $_ql3f->_ql3a($_qO3s); } } function _ql3t($_qle) { $this->_ql3h =$_qle; return $this; } function _qO3t() { return $this->_ql3h -3; } function _ql3u() { return $this->_ql3h; } function _qO3u($_qle) { $this->_qO3h =$_qle; return $this; } function _ql3v() { return $this->_qO3h; } function _qO3v($_qle) { $this->_ql3i =$_qle; return $this; } function _ql3w($_qle) { $this->_ql3i += $_qle; return $this; } function _qO3w() { return $this->_ql3i; } function _ql3x() { return $this->_qO3i; } function _qO3x() { return $this->_ql3j; } function _ql3y($_ql2y) { $this->_ql3j =$_ql2y; return $this; } function _qO3y($_qle=TRUE) { $this->_qO3j =$_qle; return $this; } function _qO3o() { return $this->_qO3j; } function _ql3z( &$_qO3z,&$_ql40,&$_qO40,&$_ql41,&$_qO41) { $_qO3z=$this->_qO3t(); $_ql40=$this->_ql3v(); $_qO40=$this->_qO3w(); $_ql41=$this->_ql3x(); $_qO41=$this->_qO3x(); } } class _ql42 { private $_qO42=array(); private function __construct() { } public static function _ql43() { $_qO43=new _ql42(); return $_qO43; } function _ql44($_ql2y) { if (is_array($_ql2y)) { foreach ($_ql2y as $_qO44 => $_ql45) if (!empty($_ql45)) { if (! isset ($this->_qO42[$_qO44])) $this->_qO42[$_qO44]=""; if (!strpos($this->_qO42[$_qO44],$_ql45)) $this->_qO42[$_qO44].=$_ql45.";"; } } return $this; } function _qO45() { $_ql46=""; foreach ($this->_qO42 as $_qO44 => $_ql45) { $_ql46.=".".$_qO44."\n\040\173 ".$_ql45."\040\175 \n"; } return '<style type="text/css">'.$_ql46."\074/style>"; } } class _qO46 { private $_ql47; private $_qO2z; private function __construct() { } public static function _ql43($_qOg=NULL,$_qle=NULL) { $_qO47=new _qO46(); if ( isset ($_qOg)) $_qO47->_ql47 =$_qOg; if ( isset ($_qle)) $_qO47->_qO2z =$_qle; return $_qO47; } function _ql48($_qO48='"') { if ( isset ($this->_ql47) && isset ($this->_qO2z)) return $this->_ql47.'='.$_qO48.$this->_qO2z.$_qO48; else return ""; } function _ql49() { if ( isset ($this->_ql47)) return $this->_ql47; else return ""; } function _qO49() { if ( isset ($this->_qO2z)) return $this->_qO2z; else return ""; } } class _ql4a { protected $_qO4a="\074\173\164\141g\175\040\173\160\162op\145\162tie\163\175>\173\143on\164\145nt\175\074/\173\164ag}\076"; protected $_ql4b; protected $_qO4b; protected $_ql4c=array(); protected $_qO4c=array(); protected $_ql4d; function __construct() { $this->_qO4b =_ql42::_ql43(); } public static function _ql43($_ql2y) { $_ql3s=new _ql4a(); $_ql3s->_qO4d($_ql2y); return $_ql3s; } function _ql4e($_ql2y) { if (is_array($_ql2y)) $this->_qO4b->_ql44($_ql2y); return $this; } function _qO4e() { return $this->_qO4b->_qO45(); } function _qO4d($_ql2y) { $this->_qO4a =_qO0("\173\164\141g}",$_ql2y,$this->_qO4a); $this->_ql4d =$_ql2y; return $this; } function _ql4f() { return $this->_ql4d; } function _qO4f($_ql2y) { $_qO47=_qO46::_ql43("\143olspan",$_ql2y); $this->_ql4c["cs"]=$_qO47; return $this; } function _ql4g() { if ( isset ($this->_ql4c["\143s"])) return $this->_ql4c["\143s"]->_qO49(); else return 1; } function _qO4g($_ql2y) { $_qO47=_qO46::_ql43("rowspan",$_ql2y); $this->_ql4c["\162\163"]=$_qO47; return $this; } function _ql4h() { if ( isset ($this->_ql4c["\162s"])) return $this->_ql4c["rs"]->_qO49(); else return 1; } function _qO4h($_ql2y) { $_qO47=_qO46::_ql43("\141lign",$_ql2y); $this->_ql4c["\141l"]=$_qO47; return $this; } function _ql2i($_ql2y) { $_qO47=_qO46::_ql43("wid\164\150",$_ql2y); $this->_ql4c["\167"]=$_qO47; return $this; } function _ql44($_ql2y) { $_qO47=_qO46::_ql43("s\164\171\154e",$_ql2y); $this->_ql4c["\163\164"]=$_qO47; return $this; } function _ql4i() { $_ql2x=""; $_qOf=func_num_args(); $_qlg=func_get_args(); for ($_qO8=0; $_qO8<$_qOf; $_qO8 ++) $_ql2x.=$_qlg[$_qO8]." "; $_qO47=_qO46::_ql43("\143\154ass",$_ql2x); $this->_ql4c["cl"]=$_qO47; return $this; } function _qO4i($_ql2y) { $_qO47=_qO46::_ql43("\151d",$_ql2y); $this->_ql4c["\151d"]=$_qO47; return $this; } function _ql4j($_ql2y) { $this->_ql4b =$_ql2y; return $this; } function _qO4j($_ql2w,$_qO47) { $_qO2w=explode(" ",trim($_ql2w)); foreach ($_qO2w as $_ql2x) { if ( isset ($_qO47[$_ql2x])) { foreach ($_qO47[$_ql2x] as $_ql47 => $_qO2z) { $_ql4k=_qO46::_ql43($_ql47,$_qO2z); array_push($this->_ql4c ,$_ql4k); } } } return $this; } function _qO4k($_ql2y) { if ($_ql2y instanceof _qO46) array_push($this->_ql4c ,$_ql2y); else if (is_array($_ql2y)) { foreach ($_ql2y as $_ql47 => $_qO2z) { $_qO47=_qO46::_ql43($_ql47,$_qO2z); array_push($this->_ql4c ,$_qO47); } } return $this; } function _ql4l($_ql2y) { $this->_ql4c =$_ql2y; return $this; } function _ql3z() { return $this->_ql4c; } function _qO4l($_qO48='"') { $_ql46=""; foreach ($this->_ql4c as $_qO47) if ( isset ($_qO47)) $_ql46.=$_qO47->_ql48($_qO48)." "; return $_ql46; } function _ql3k($_ql2y,$_ql4m=-1) { return $this->_qO4m(array($_ql2y),$_ql4m); } function _qO4m($_ql2y,$_ql4m=-1) { $_ql41=count($this->_qO4c); if (($_ql4m<0) || ($_ql4m>$_ql41)) $_ql4m=$_ql41; array_splice($this->_qO4c ,$_ql4m,0,array($_ql2y)); return $this; } function _ql4n($_ql2y,$_ql4m) { return $this->_qO4n(array($_ql2y),$_ql4m); } function _qO4n($_ql2y,$_ql4m) { if ($_ql4m>-1) $this->_qO4c[$_ql4m]=$_ql2y; return $this; } function _ql4o() { ksort($this->_qO4c); } function _qO4o() { $_qO2y=array(); foreach ($this->_qO4c as $_ql4p) { foreach ($_ql4p as $_ql3m) { if ( isset ($_ql3m) && $_ql3m->_qO4p() != "") array_push($_qO2y,$_ql3m); } } return $_qO2y; } function _ql4q() { $_qO2y=array(); foreach ($this->_qO4c as $_ql4p) { foreach ($_ql4p as $_ql3m) { if ($_ql3m->_ql4f() === 'tr') { if ( isset ($_ql3m) && $_ql3m->_qO4p() != "") array_push($_qO2y,$_ql3m); } else { $_qO4q=$_ql3m->_ql4q(); foreach ($_qO4q as $_ql4r) if ( isset ($_ql4r) && $_ql4r->_qO4p() != "") array_push($_qO2y,$_ql4r); } } } return $_qO2y; } function _qO4p() { $_ql46=$this->_ql4b; foreach ($this->_qO4c as $_ql4p) foreach ($_ql4p as $_ql3m) if ( isset ($_ql3m)) $_ql46.=$_ql3m->_qO4r(); return $_ql46; } function _qO4r() { $_ql4s=$this->_qO4p(); if ( isset ($_ql4s) && $_ql4s !== '') { $_ql46=$this->_qO4a; $_ql46=_qO0("\173\160roper\164\151es\175",$this->_qO4l(),$_ql46); $_ql46=_qO0("\173\143onten\164}",$_ql4s,$_ql46); return $_ql46; } else return ""; } function _qO4s($_ql4t=array(),$_qO4t=TRUE) { $_ql46=$this->_ql4u($_ql4t,$this->_ql4b ,$_qO4t); foreach ($this->_qO4c as $_ql4p) foreach ($_ql4p as $_ql3m) if ( isset ($_ql3m)) $_ql46.=$_ql3m->_qO4s($_ql4t,$_qO4t); return $_ql46; } function _qO4u($_ql4t,$_qO4t=TRUE) { $_ql46=$this->_ql4u($_ql4t,$this->_ql4b ,$_qO4t); foreach ($this->_qO4c as $_ql4p) foreach ($_ql4p as $_ql3m) if ( isset ($_ql3m)) $_ql46.=$_ql3m->_ql4v($_ql4t,$_qO4t); return $_ql46; } function _ql4v($_ql4t,$_qO4t=TRUE,$_qO48='"') { $_ql4s=$this->_qO4u($_ql4t,$_qO4t); if ( isset ($_ql4s) && $_ql4s !== '') { $_ql46=$this->_qO4a; $_ql46=_qO0("\173p\162\157\160erti\145\163}",$this->_qO4l($_qO48),$_ql46); $_ql46=_qO0("\173cont\145\156\164}",$_ql4s,$_ql46); return $_ql46; } else return ""; } function _ql4u($_ql4t,$_qO2v,$_qO4t=TRUE) { foreach ($_ql4t as $_qOd => $_qO4v) { if ($_qO4t) $_qO2v=_qO0($_qOd,$_qO4v,$_qO2v); else $_qO2v=_ql9($_qOd,$_qO4v,$_qO2v); } return $_qO2v; } } class _ql4w extends _ql4a { } class _qO4w extends _ql4a { } class _ql4x extends _ql4a { function _qO4x() { $_ql4y=_qO4y::_ql4z()->_ql4j("\142lank"); $_qO4q=$this->_ql4q(); $_qO2y=array(); $_qO4z=0; foreach ($_qO4q as $_ql50 => $_ql4r) { $_qO50=$_ql4r->_qO4o(); $_qO2y[$_ql50]=$_qO50; $_ql51=1; foreach ($_qO50 as $_qO51 => $_ql52) { $_qO52=$_ql52->_ql4g(); for ($_ql53=1; $_ql53<$_qO52; $_ql53 ++) array_splice($_qO2y[$_ql50],$_qO51+$_ql51,0,array($_ql4y)); $_ql51 += $_qO52-1; } $_qO53=count($_qO2y[$_ql50]); if ($_qO53>$_qO4z) $_qO4z=$_qO53; } $_ql54=count($_qO2y); $_ql4m=0; while ($_ql4m<$_ql54*$_qO4z) { $_ql50=$_ql4m%$_ql54; $_qO51= (int) $_ql4m/$_ql54; if ( isset ($_qO2y[$_ql50][$_qO51])) { $_ql52=$_qO2y[$_ql50][$_qO51]; $_qO52=$_ql52->_ql4g(); $_qO54=$_ql52->_ql4h(); for ($_ql55=1; $_ql55<$_qO54; $_ql55 ++) { for ($_ql53=0; $_ql53<$_qO52; $_ql53 ++) array_splice($_qO2y[$_ql50+$_ql55],$_qO51,0,array($_ql4y)); $_qO53=count($_qO2y[$_ql50+$_ql55]); if ($_qO53>$_qO4z) $_qO4z=$_qO53; } } $_ql4m ++; } return $_qO2y; } } class _qO4y { public static function _ql4z() { $_ql3s=new _ql4w(); return $_ql3s->_qO4d("t\144"); } public static function _qO55() { $_ql3s=new _qO4w(); return $_ql3s->_qO4d("\164r"); } public static function _ql56() { $_ql3s=new _ql4x(); return $_ql3s->_qO4d("\164\141ble"); } public static function _qO56() { $_ql3s=_ql4a::_ql43("\144i\166"); return $_ql3s; } public static function _ql57() { $_ql3s=_ql4a::_ql43("s\160an"); return $_ql3s; } public static function _qO57($_ql58) { $_ql3s=_ql4a::_ql43($_ql58); return $_ql3s; } } class _ql1g { protected $_qO58; private function __construct() { $this->_qO58 =""; } public static function _ql59($_qO59="") { $_ql5a=new _ql1g(); if ($_qO59 instanceof _ql1g) $_ql5a->_qO58 =$_qO59->_qO5a(); else if (is_string($_qO59)) $_ql5a->_qO58 =$_qO59; return $_ql5a; } function _qO2k($_ql5b) { if (is_string($_ql5b)) $this->_qO58 =$_ql5b; return $this; } function _qO5b() { $this->_qO58 ="(".$this->_qO58."\051"; return $this; } function _ql5c($_qO59,$_qO5c=_qO30::_qO2d,$_ql5d=_qO30::_qO38) { $_ql5b=$this->_qO58; if ($_qO59 instanceof _ql1g) $_qO5d=$_qO59->_qO5a(); else if (is_string($_qO59)) $_qO5d=$_qO59; else return NULL; if ($_qO5d != "") { if ($this->_qO58 != "") { if ($_ql5d == _qO30::_qO38) $_ql5b=$_ql5b.$_qO5c."(".$_qO5d.")"; else if ($_ql5d == _qO30::_ql39) $_ql5b=$_ql5b.$_qO5c.$_qO5d; } else { if ($_ql5d == _qO30::_qO38) $_ql5b="(".$_qO5d."\051"; else if ($_ql5d == _qO30::_ql39) $_ql5b=$_qO5d; } } $this->_qO58 =$_ql5b; return $this; } function _qO5a() { return $this->_qO58; } } class _pivotdatasource { public $_ql5e; public $Link; protected $_qO5e; protected $_ql5f; protected $_qO5f; protected $_ql5g; protected $_qO5g; protected $_ql5h; protected $_qO5h; protected $_ql5i; protected $_qO5i=0; function __construct($_ql5j) { $this->Link =$_ql5j; $this->_qO5h =0; $this->_ql5f =FALSE; $this->_qO5i =0; } function setquerysize($_ql2y) { if (is_int($_ql2y)) $this->_qO5i =$_ql2y; return $this; } function getquerysize() { return $this->_qO5i; } function select($_qO5e) { if (is_string($_qO5e)) { $this->_qO5e =$_qO5e; $_qO5j=explode(",",$_qO5e); if (is_array($_qO5j)) foreach ($_qO5j as $_ql5k) if (!empty($_ql5k)) { $_ql55=strripos($_ql5k,' as '); if ($_ql55>0) { $this->_ql5h[$this->_qO5h ]["e\170press\151\157n"]=trim(substr($_ql5k,0,$_ql55)); $this->_ql5h[$this->_qO5h ]["\141lias"]=trim(substr($_ql5k,$_ql55+4)); } else { $this->_ql5h[$this->_qO5h ]["e\170\160res\163\151on"]=trim($_ql5k); $this->_ql5h[$this->_qO5h ]["\141li\141\163"]=trim($_ql5k); } $this->_qO5h ++; } } else if (is_array($_qO5e)) { foreach ($_qO5e as $_ql5k) if (!empty($_ql5k)) { $_ql55=strripos($_ql5k,' as '); if ($_ql55>0) { $this->_ql5h[$this->_qO5h ]["\145xp\162\145ss\151\157n"]=trim(substr($_ql5k,0,$_ql55)); $this->_ql5h[$this->_qO5h ]["alia\163"]=trim(substr($_ql5k,$_ql55+4)); } else { $this->_ql5h[$this->_qO5h ]["ex\160\162ess\151\157n"]=trim($_ql5k); $this->_ql5h[$this->_qO5h ]["a\154\151\141s"]=trim($_ql5k); } $this->_qO5h ++; } } return $this; } function _qO5k() { return $this->_ql5h; } function _ql5l($_ql2y) { $this->_ql5f =$_ql2y; return $this; } function selectcommand($_qO2v) { $this->_ql5i =$_qO2v; return $this; } function from($_qO2v) { $this->_qO5f =$_qO2v; return $this; } function join($_qO5l) { $this->_qO5f ="\040\050".$this->_qO5f." JOIN ".$_qO5l; return $this; } function fulljoin($_qO5l) { $this->_qO5f ="\040\050".$this->_qO5f."\040FULL J\117\111\116 ".$_qO5l; return $this; } function leftjoin($_qO5l) { $this->_qO5f =" \050".$this->_qO5f."\040\114EFT JOI\116\040".$_qO5l; return $this; } function rightjoin($_qO5l) { $this->_qO5f =" (".$this->_qO5f."\040\122\111GHT J\117\111\116 ".$_qO5l; return $this; } function innerjoin($_qO5l) { $this->_qO5f ="\040(".$this->_qO5f."\040\111NNER J\117\111\116 ".$_qO5l; return $this; } function on($_ql5a) { $this->_qO5f .=" ON\040".$_ql5a."\051 "; return $this; } function where($_qO2v) { $this->_ql5g =$_qO2v; return $this; } function groupby($_qO5g) { $this->_qO5g =$_qO5g; return $this; } function _ql5m($_qO5j,$_qO5m,$_ql5n) { $_qO5n=_qOj::_qlr; $_ql5o=_qOj::_qO1h; if (!empty($this->_ql5i)) { $_qO5n=_qOj::_qO2l; $_ql5o=_qOj::_ql1i; } $_qO5e=""; if (!empty($_qO5j)) { foreach ($_qO5j as $_ql5k) { $_ql46=trim($_ql5k[$_qO5n]); if ( isset ($_ql5k[_qOj::_ql2l])) $_ql46=$_ql5k[_qOj::_ql2l]."\050".$_ql46."\051"; $_qO5e.=$_ql46."\040AS ".$this->_qO5o($_ql5k[_qOj::_qOt])."\054 "; } $_qO5e=trim($_qO5e,"\054\040"); } $_ql5f=($this->_ql5f) ? "D\111\123TINCT ": ""; if ($_qO5e != "") $_qO5e="\123ELECT ".$_ql5f.$_qO5e; $_ql5g=""; if ( isset ($_qO5m)) $_ql5g=trim($_qO5m[$_ql5o]->_qO5a()); if (empty($this->_ql5i)) if (!empty($this->_ql5g)) { if ($_ql5g != "") $_ql5g.="\040AND ".$this->_ql5g; else $_ql5g=$this->_ql5g; } if ($_ql5g != "") $_ql5g="\040\127HERE ".$_ql5g; $_qO3k=""; if (!empty($_ql5n)) { foreach ($_ql5n as $_ql5p) { $_qO3k.=$_ql5p[$_qO5n]."\054 "; } $_qO3k=trim($_qO3k,"\054\040"); } if (empty($this->_ql5i)) if (!empty($this->_qO5g)) { if ($_qO3k != "") $_qO3k.="\040\054 ".$this->_qO5g; else $_qO3k=$this->_qO5g; } if ($_qO3k != "") $_qO3k=" \107\122OUP BY ".$_qO3k; $_qO5f=" FROM "; if (empty($this->_ql5i)) $_qO5f.=$this->_qO5f; else $_qO5f.="\050".$this->_ql5i."\051\040tmp "; $_qO5p=$_qO5e.$_qO5f.$_ql5g.$_qO3k; return $_qO5p; } function _ql5q($_qO2v) { return _qO0("\047","''",$_qO2v); } function _qO5q($_qO2v) { $_ql5r=$this->_ql5q($_qO2v); $_ql5r=_qO0(htmlentities("&"),"&",$_ql5r); return $_ql5r; } function _qO5r($_qO2v) { return "\047".$_qO2v."'"; } function _qO5o($_qO2v) { return "\042".$_qO2v."\042"; } function _ql5s($_qO2v) { switch (strtolower($_qO2v)) { case "y\145\141r": return "year"; case "qu\141\162\164er": return "quarter"; case "m\157\156\164h": return "month"; case "\144ay": return ""; default : return "\145rror"; } } } class pdopivotdatasource extends _pivotdatasource { function _queryall($_qO5p) { $_qO2y=array(); $_qO5s=$this->Link->prepare($_qO5p); $_qO5s->execute(); while ($_ql4r=$_qO5s->fetch(pdo::FETCH_ASSOC)) { array_push($_qO2y,$_ql4r); } return $_qO2y; } function _querylimit($_qO5p,$_ql51,$_qO5i) { $_qO5p.="\040LIMIT ".$_ql51."\054".$_qO5i; $_qO2y=array(); $_qO5s=$this->Link->prepare($_qO5p); $_qO5s->execute(); while ($_ql4r=$_qO5s->fetch(pdo::FETCH_ASSOC)) { array_push($_qO2y,$_ql4r); } return $_qO2y; } } class postgresqlpivotdatasource extends _pivotdatasource { function _queryall($_qO5p) { $_qO2y=array(); $_ql5t=pg_query($this->Link ,$_qO5p); while ($_ql4r=pg_fetch_assoc($_ql5t)) { array_push($_qO2y,$_ql4r); } return $_qO2y; } function _querylimit($_qO5p,$_ql51,$_qO5i) { $_qO5p.= " LI\115\111T $_qO5i\040OFFSET $_ql51"; $_qO2y=array(); $_ql5t=pg_query($this->Link ,$_qO5p); while ($_ql4r=pg_fetch_assoc($_ql5t)) { array_push($_qO2y,$_ql4r); } return $_qO2y; } } class mysqlipivotdatasource extends _pivotdatasource { function _queryall($_qO5p) { $_qO2y=array(); $_ql5t=mysqli_query($this->Link ,$_qO5p); $_qO2y=mysqli_fetch_all($_ql5t,MYSQLI_ASSOC); return $_qO2y; } function _querylimit($_qO5p,$_ql51,$_qO5i) { $_qO5p.="\040LIM\111\124 ".$_ql51.",".$_qO5i; $_qO2y=array(); $_ql5t=mysqli_query($this->Link ,$_qO5p); $_qO2y=mysqli_fetch_all($_ql5t,MYSQLI_ASSOC); return $_qO2y; } } class mysqlpivotdatasource extends _pivotdatasource { function _queryall($_qO5p) { $_qO2y=array(); $_ql5t=mysql_query($_qO5p,$this->Link); while ($_ql4r=mysql_fetch_assoc($_ql5t)) { array_push($_qO2y,$_ql4r); } return $_qO2y; } function _querylimit($_qO5p,$_ql51,$_qO5i) { $_qO5p.="\040\114\111MIT\040".$_ql51."\054".$_qO5i; $_qO2y=array(); $_ql5t=mysql_query($_qO5p,$this->Link); while ($_ql4r=mysql_fetch_assoc($_ql5t)) { array_push($_qO2y,$_ql4r); } return $_qO2y; } } class firebirdpivotdatasource extends _pivotdatasource { function _queryall($_qO5p) { $_qO2y=array(); $_ql5t=ibase_query($this->Link ,$_qO5p); while ($_ql4r=ibase_fetch_assoc($_ql5t)) { array_push($_qO2y,$_ql4r); } return $_qO2y; } function _querylimit($_qO5p,$_ql51,$_qO5i) { $_qO5p.="\040ROWS ".($_ql51+1)."\040\124O ".($_ql51+1+$_qO5i); $_qO2y=array(); $_ql5t=ibase_query($_qO5p,$this->Link); while ($_ql4r=ibase_fetch_assoc($_ql5t)) { array_push($_qO2y,$_ql4r); } return $_qO2y; } } class odbcpivotdatasource extends _pivotdatasource { function _queryall($_qO5p) { $_qO2y=array(); $_ql5t=odbc_exec($this->Link ,$_qO5p); while ($_ql4r=odbc_fetch_array($_ql5t)) { array_push($_qO2y,$_ql4r); } return $_qO2y; } } class mssqlpivotdatasource extends _pivotdatasource { function _queryall($_qO5p) { $_qO2y=array(); $_ql5t=mssql_query($_qO5p,$this->Link); while ($_ql4r=mssql_fetch_array($_ql5t)) { array_push($_qO2y,$_ql4r); } return $_qO2y; } function _querylimit($_qO5p,$_ql51,$_qO5i) { $_qO5t=strpos($_qO5p,"\123ELECT\040"); $_ql5u=strpos($_qO5p," \101\123\040"); $_ql5k=substr($_qO5p,$_qO5t+7,$_ql5u-$_qO5t-7); $_qO5p=substr_replace($_qO5p,"\122OW_NU\115\102ER() O\126\105\122 (O\122\104\105R BY\040$_ql5k) AS\040\122\157wNum\142\145\162, " ,$_qO5t+7,0); $_qO5p= "SEL\105\103\124 * FR\117\115\040($_qO5p\051\040tmp2 WHE\122\105\040RowN\165\155\142er B\105\124WEEN $_ql51\040\101ND $_qO5i "; $_qO2y=array(); $_ql5t=mssql_query($_qO5p,$this->Link); while ($_ql4r=mssql_fetch_assoc($_ql5t)) { array_push($_qO2y,$_ql4r); } return $_qO2y; } } class sqlsrvpivotdatasource extends _pivotdatasource { function _queryall($_qO5p) { $_qO2y=array(); $_ql5t=sqlsrv_query($this->Link ,$_qO5p); while ($_ql4r=sqlsrv_fetch_array($_ql5t)) { array_push($_qO2y,$_ql4r); } return $_qO2y; } function _querylimit($_qO5p,$_ql51,$_qO5i) { $_qO5t=strpos($_qO5p,"\123ELECT "); $_ql5u=strpos($_qO5p,"\040AS "); $_ql5k=substr($_qO5p,$_qO5t+7,$_ql5u-$_qO5t-7); $_qO5p=substr_replace($_qO5p,"ROW_NUM\102\105\122() O\126\105R (ORD\105\122\040BY $_ql5k) AS \122\157\167Numbe\162\054 " ,$_qO5t+7,0); $_qO5p= "\123ELECT \052\040FROM ($_qO5p)\040\164\155p2 WH\105\122\105 Row\116\165mber B\105\124WEEN $_ql51\040AND $_qO5i\040"; $_qO2y=array(); $_ql5t=sqlsrv_query($this->Link ,$_qO5p); while ($_ql4r=sqlsrv_fetch_array($_ql5t)) { array_push($_qO2y,$_ql4r); } return $_qO2y; } } class oraclepivotdatasource extends _pivotdatasource { function _queryall($_qO5p) { $_qO2y=array(); $_qO5s=oci_parse($this->Link ,$_qO5p); oci_execute($_qO5s); while ($_ql4r=oci_fetch_array($_qO5s)) { array_push($_qO2y,$_ql4r); } return $_qO2y; } function _querylimit($_qO5p,$_ql51,$_qO5i) { $_qO5t=strpos($_qO5p,"SEL\105\103\124 "); $_ql5u=strpos($_qO5p," AS "); $_ql5k=substr($_qO5p,$_qO5t+7,$_ql5u-$_qO5t-7); $_qO5p=substr_replace($_qO5p,"ROW_NUM\102\105\122() OV\105\122 (ORDE\122\040\102Y $_ql5k) AS\040\122\157wNumb\145\162\054 " ,$_qO5t+7,0); $_qO5p= "SELE\103\124\040* FR\117\115\040($_qO5p)\040\164\155p2 WH\105\122\105 RowN\165\155ber BE\124\127EEN $_ql51\040\101ND ".($_ql51+$_qO5i); $_qO2y=array(); $_qO5s=oci_parse($this->Link ,$_qO5p); oci_execute($_qO5s); while ($_ql4r=oci_fetch_array($_qO5s)) { array_push($_qO2y,$_ql4r); } return $_qO2y; } } class _qO5u { public $_ql5v; public $_qO5v; public $_ql5w=FALSE; public $_qO5w=FALSE; function _ql5x($_qO5x) { $this->_ql5v =$_qO5x; $this->_qO5w =$_qO5x->KeepViewStateInSession; $_ql5y=( isset ($_POST[$this->_ql5v->_qO5y._qOj::_ql1u])) ? $_POST[$this->_ql5v->_qO5y._qOj::_ql1u]: ""; if ($this->_qO5w && $_ql5y == "") { $_ql5y=( isset ($_SESSION[$this->_ql5v->_qO5y._qOj::_ql1u])) ? $_SESSION[$this->_ql5v->_qO5y._qOj::_ql1u]: ""; } $_ql5z=array('pivotId' => $_qO5x->id ,'viewstate' => &$_ql5y); $_qO5x->EventHandler->onreadingviewstate($this,$_ql5z); if ($_ql5y != "" && $this->_ql5w) { $_ql5y=base64_decode($_ql5y); } $_ql5y=_qO0("\134","",$_ql5y); $this->_qO5v =json_decode($_ql5y,TRUE); } function _ql3b() { $this->_qO5v =array(); } function _qO5z() { $_qO5x=$this->_ql5v; $_ql60=json_encode($this->_qO5v); if ($this->_ql5w) { $_ql60=base64_encode($_ql60); } if ($this->_qO5w) { $_SESSION[$this->_ql5v->_qO5y._qOj::_ql1u]=$_ql60; } $_qO60="\074inp\165\164\040id=\047\173id}' \156\141me='\173\151\144}' t\171\160e='h\151\144den' \166\141\154ue='\173\166\141lue}\047\040auto\143\157mplete\075\047off' \057\076"; $_ql61=_qO0("\173\151d}",$this->_ql5v->_qO5y._qOj::_ql1u,$_qO60); $_ql61=_qO0("\173\166\141lue}",$_ql60,$_ql61); return $_ql61; } } class _qO61 { var $_ql62; var $_qO62; function __construct() { $this->_ql62 =array(_qOj::_qO1u => "Go",_qOj::_ql1v => "\116e\170\164",_qOj::_qO1v => "\116ext",_qOj::_ql1w => "Last",_qOj::_qO1w => "\106\151rst",_qOj::_qO1j => "[No Fil\164\145\162]",_qOj::_qO19 => " is\040\145qual to",_qOj::_ql1a => " is NOT \145\161\165al t\157",_qOj::_qO1a => "is les\163\040\164han",_qOj::_ql1b => "\040\151\163 grea\164\145\162 th\141\156",_qOj::_qO1b => "\040is le\163\163\040than\040\157\162 equ\141\154 to",_qOj::_ql1c => " \151\163 gr\145\141ter\040\164han\040\157r eq\165\141l to",_qOj::_qO1c => "\040\151s betw\145\145\156",_qOj::_ql1d => "\040\151s NOT be\164\167\145en",_qOj::_qO1d => " con\164\141\151ns",_qOj::_ql1e => " star\164\163\040with",_qOj::_qO1e => " ends\040\167ith",_qOj::_ql2r => "\040\164op N",_qOj::_qO2r => " bo\164\164\157m N",_qOj::_ql2s => "\040top pe\162\143\145nt",_qOj::_qO2s => " bottom \160\145\162cent",_qOj::_ql1x => "Ok",_qOj::_ql1y => "Ca\156\143\145l",_qOj::_qO1y => "\111nclude\163",_qOj::_ql1z => "\105xclud\145\163",_qOj::_qO1z => "(Select\040\101\154l)",_qOj::_ql20 => "\107rand To\164\141\154",_qOj::_qO20 => "\173categor\171\175\040Tota\154",_qOj::_ql21 => "\123\165m of \173\143\141tegor\171\175",_qOj::_qO21 => "Co\165\156t of \173\143ateg\157\162y}",_qOj::_ql22 => "\173\143atego\162\171} Min",_qOj::_qO22 => "\173\143ateg\157\162y} Max",_qOj::_ql23 => "Averag\145\040of \173\143\141tegor\171\175",_qOj::_qO23 => "P\145\162centage\040\157f sum \157\146 \173c\141\164egory\175",_qOj::_ql24 => "Per\143\145ntage o\146\040count\040\157f \173\143\141tegor\171\175",); $this->_qO62 =array(_qOj::_qO24 => "Pag\145\040<stron\147\076\173Pa\147\145Index\175\074/str\157\156\147>\040\151n <\163\164rong>\173\124otalPa\147\145s}</s\164\162ong>\054\040item\163\040<stro\156\147>\173F\151\162stInd\145\170InPag\145\175</str\157\156g> to\040\074stro\156\147>\173La\163\164Ind\145\170InPa\147\145}</st\162\157ng> o\146\040<str\157\156g>\173\124\157ta\154\122ow\163\175</\163\164ro\156g>.",_qOj::_ql25 => "Cha\156\147e page:\040\173TextBo\170\175 (of \173\124\157tal\120\141ge} \160\141\147es) \173\107\157Page\102\165\164ton}",_qOj::_qO25 => "Page Si\172\145\072",_qOj::_ql26 => "Next Pa\147\145",_qOj::_qO26 => "Previ\157\165\163 Page",_qOj::_ql27 => "Fi\162\163t Pag\145",_qOj::_qO27 => "La\163t Pa\147\145",_qOj::_ql28 => "Cli\143\153 he\162\145 t\157\040so\162\164",_qOj::_qO28 => "\123ort \101\163c",_qOj::_ql29 => "\123ort De\163\143",_qOj::_qO29 => "N\157\040sort",_qOj::_ql2a => "[Co\154\165mn Fie\154\144s]",_qOj::_qO2a => "\133Row F\151\145lds]",_qOj::_ql2b => "Dr\141\147 the\040fil\164\145r \146ie\154\144 he\162\145.",_qOj::_qO2b => "[\104ata\040\106i\145\154ds]",_qOj::_ql2c => "D\162a\147\040to\040ord\145\162",_qOj::_qO2c => _qOj::_qO2c,_qOj::_ql2d => "\114o\141\144ing\056.",_qOj::_qO2d => _qOj::_qO2d,_qOj::_ql2e => "\123orte\144\040asc",_qOj::_qO2e => "\123orte\144\040de\163\143",_qOj::_ql2f => "\106\151tlering",); } function load($_ql63) { $_qO63=new domdocument(); $_qO63->load($_ql63); $_ql64=$_qO63->getelementsbytagname("\143omman\144\163"); if ($_ql64->length >0) { foreach ($_ql64->item(0)->attributes as $_qO64) { $this->_ql62[$_qO64->name ]=$_qO64->value; } } $_ql64=$_qO63->getelementsbytagname("mes\163\141ges"); if ($_ql64->length >0) { foreach ($_ql64->item(0)->attributes as $_qO64) { $this->_qO62[$_qO64->name ]=$_qO64->value; } } } } class _ql65 { var $_qO65; var $_ql66; var $_qO5y; function __construct($_qO66,$_ql67) { $this->_qO65 =($_qO66 != NULL) ? $_qO66: sys_get_temp_dir(); $this->_ql66 =($_ql67 != NULL) ? $_ql67: 5*074; } function _qO67($_qOd,$_ql68) { $_ql5y=json_encode($_ql68); file_put_contents($this->_qO65."/".$this->_qO5y.$_qOd."\056kpt",$_ql5y); return TRUE; } function _qO68($_qOd) { $_ql69=$this->_qO65."\057".$this->_qO5y.$_qOd.".kpt"; if (is_file($_ql69) && (time()-filemtime($_ql69)<$this->_ql66)) { $_ql5y=file_get_contents($this->_qO65."\057".$this->_qO5y.$_qOd.".\153\160t"); return json_decode($_ql5y,TRUE); } return NULL; } } class _qls { var $_qO69=FALSE; var $_ql5v; var $_ql6a; var $_qO6a; var $_ql6b=array(); var $_qO6b; var $_ql6c; var $_qO5y; var $_qO6c=FALSE; var $_ql6d=0; var $_qO6d=0; var $SqlOperator=_qO30::_qO32; var $_ql6e; public $_qO6e; public $_ql6f; public $_qOd; public $_qO5e; private $_qO6f; var $FieldName; var $Text; var $Sort; var $Expand; var $Filters; var $IncludeAll=TRUE; var $ExceptionList; var $AllowReorder; var $AllowSorting; var $AllowFiltering; var $Tooltip; var $HeaderTextWrap=TRUE; var $RelevantField; function __construct($_ql6g) { $this->FieldName =$_ql6g; $this->_qO6g($_ql6g); $this->ExceptionList =array(); if ($this->_qO5e === NULL) $this->_qO5e =array(); $this->Filters =array(); } public static function _ql43($_ql6h,$_qO6h) { switch ($_qO6h) { case "\163um": return new pivotsumfield($_ql6h); case "\141verage": return new pivotaveragefield($_ql6h); case "\160erce\156\164ag\145\040sum": return new pivotpercentagesumfield($_ql6h); case "\160\145rcent\141\147e cou\156\164": return new pivotpercentagecountfield($_ql6h); case "min": return new pivotminfield($_ql6h); case "\155ax": return new pivotmaxfield($_ql6h); case "cou\156\164": return new pivotcountfield($_ql6h); case "\160\151vot": default : return new pivotfield($_ql6h); } } function _qO6g($_qO2v) { $this->_ql6e =$_qO2v; return $this; } function setvaluemap($_qO6f) { $this->_qO6f =$_qO6f; return $this; } function getvaluemap() { return $this->_qO6f; } function _ql6i($_qle) { if ( isset ($this->_qO6f)) $_qle=$this->_qO6f->map($_qle); if (is_array($_qle)) $_qle=$_qle[$this->FieldName ]; return $_qle; } function _ql3z( &$_ql6h,&$_qO6i,&$_ql6j,&$_qO6j,&$_ql6k) { $_ql6h=$this->FieldName; $_qO6i=$this->_qO5y; $_ql6j=$this->_ql6e; $_qO6j=$this->_qO6e; $_ql6k=$this->SqlOperator; } function _ql5x($_qO5x,$_qO2t) { $this->_ql5v =$_qO5x; $this->_ql6a =$_qO5x->_ql6a; $this->_qO5y =$this->_ql5v->_qO5y."\137".md5( "$_qO2t"); $this->_qO6e ='f'.$_qO2t; if ($this->Text === NULL) $this->Text =$this->FieldName; $this->_qO6b =array(); if ($this->Expand === NULL) $this->Expand =FALSE; if ($this->_ql6b === NULL) $this->_ql6b =array(); if ($this->AllowReorder === NULL) $this->AllowReorder =$this->_ql5v->AllowReorder; if ($this->AllowSorting === NULL) $this->AllowSorting =$this->_ql5v->AllowSorting; if ($this->AllowFiltering === NULL) $this->AllowFiltering =$this->_ql5v->AllowFiltering; if ($this->Sort === NULL && $this->AllowSorting) $this->Sort =_qOj::_qll; } function _qO6k() { if ( isset ($this->_ql6a->_qO5v[$this->_qO5y ])) { $_ql6l=$this->_ql6a->_qO5v[$this->_qO5y ]; $this->Sort =$_ql6l[_qOj::_ql15]; $_qO6l=$_ql6l[_qOj::_qOp]; $this->IncludeAll =$_ql6l[_qOj::_qO16]; $_ql6m=$_ql6l[_qOj::_ql16]; $this->_qO6c =$_ql6l[_qOj::_qO17]; $this->_ql6f =$_ql6l[_qOj::_ql18]; for ($_qO8=0; $_qO8<count($_qO6l); $_qO8 ++) { $_qO6l[$_qO8][1]=urldecode($_qO6l[$_qO8][1]); if ( isset ($_qO6l[$_qO8][2])) $_qO6l[$_qO8][2]=urldecode($_qO6l[$_qO8][2]); } $this->Filters =$_qO6l; for ($_qO8=0; $_qO8<count($_ql6m); $_qO8 ++) $_ql6m[$_qO8]=(urldecode($_ql6m[$_qO8])); $this->ExceptionList =$_ql6m; if ($this->_qO6c) { $this->_ql6d =$_ql6l[_qOj::_qO18]; $this->_qO6d =$_ql6l[_qOj::_ql19]; } } } function _qO6m($_ql6n) { $_qO6n=$this->_ql5v; $_ql6o=$_qO6n->DataSource; if ( isset ($_ql6n->_ql62[$this->_qO5y ])) { $_qO51=$_ql6n->_ql62[$this->_qO5y ]; $_qO6o=$_qO51[_qOj::_qOy]; $_ql6p=$_qO51[_qOj::_qO1m]; switch ($_qO6o) { case _qOj::_ql15: if ($_qO6n->EventHandler->onbeforefieldsort($this,array()) == TRUE) { $this->Sort =$_ql6p[_qOj::_ql15]; $_qO6n->EventHandler->onfieldsort($this,array()); $_qO6p=$this->_ql6f; $_qO6n->_ql6q[_ql2t::_qlk($_qO6p)]=NULL; $_qO6n->_qO6q =$_qO6p; $_qO6n->setsortstate(_qOj::_qO2q); } break; case _qOj::_ql2j: if ($_qO6n->EventHandler->onbeforefilterpanelopen($this,array()) == TRUE) { $this->_qO6c =TRUE; $this->_ql6d =$_ql6p[_qOj::_ql2i]; $this->_qO6d =$_ql6p[_qOj::_qO2i]; if (empty($this->_qO6b)) $this->_ql6r(); $_qO6n->EventHandler->onfilterpanelopen($this,array()); } break; case _qOj::_qO2j: $this->_qO6c =FALSE; switch ($_ql6p[_qOj::_qOy]) { case _qOj::_qO1x: if ($_qO6n->EventHandler->onbeforefieldfilter($this,array()) == TRUE) { if ($_ql6p[_qOj::_ql2k] == _qOj::_qO2n) { $this->Filters =array(); $this->IncludeAll =TRUE; $this->ExceptionList =array(); $this->addfilter(array($_ql6p[_qOj::_qO2k],$_ql6o->_qO5q(urldecode($_ql6p[_qOj::_ql2m])),$_ql6o->_qO5q(urldecode($_ql6p[_qOj::_qO2m])))); } else if ($_ql6p[_qOj::_ql2k] == _qOj::_ql2n) { $this->Filters =array(); $this->IncludeAll =$_ql6p[_qOj::_qO16]; $this->ExceptionList =($_ql6p[_qOj::_ql16] != NULL) ? $_ql6p[_qOj::_ql16]: array(); for ($_qO8=0; $_qO8<count($this->ExceptionList); $_qO8 ++) $this->ExceptionList[$_qO8]=$_ql6o->_qO5q(urldecode($this->ExceptionList[$_qO8])); } $_qO6n->_qO6r =TRUE; $_qO6n->EventHandler->onfieldfilter($this,array()); } break; case _qOj::_ql1y: break; } break; case _qOj::_qOz: if ($_qO6n->EventHandler->onbeforefieldcollapse($this,array()) == TRUE) { $this->Expand =FALSE; $_qO6n->EventHandler->onfieldcollapse($this,array()); } break; case _qOj::_qlz: if ($_qO6n->EventHandler->onbeforefieldexpand($this,array()) == TRUE) { $this->Expand =TRUE; $_qO6n->EventHandler->onfieldexpand($this,array()); } break; } } foreach ($this->ExceptionList as $_ql6s) $this->_ql6c[$_ql6s]=1; if ($this->AllowFiltering && $this->_qO6c) $_qO6n->_qO6s =$this; } function _ql6t() { $_ql6m=$this->ExceptionList; for ($_qO8=0; $_qO8<count($_ql6m); $_qO8 ++) $_ql6m[$_qO8]=urlencode($_ql6m[$_qO8]); $_qO6l=$this->Filters; for ($_qO8=0; $_qO8<count($_qO6l); $_qO8 ++) { $_qO6l[$_qO8][1]=urlencode($_qO6l[$_qO8][1]); if ( isset ($_qO6l[$_qO8][2])) $_qO6l[$_qO8][2]=urlencode($_qO6l[$_qO8][2]); } $this->_ql6a->_qO5v[$this->_qO5y ]=array(_qOj::_qlx => urlencode($this->FieldName),_qOj::_ql15 => $this->Sort ,_qOj::_ql16 => $_ql6m,_qOj::_qO16 => $this->IncludeAll ,_qOj::_qOp => $_qO6l,_qOj::_ql17 => $this->AllowReorder ,_qOj::_qO17 => $this->_qO6c ,_qOj::_ql18 => $this->_ql6f ,); if ($this->_qO6c) { $this->_ql6a->_qO5v[$this->_qO5y ]=array_merge($this->_ql6a->_qO5v[$this->_qO5y ],array(_qOj::_qO18 => $this->_ql6d ,_qOj::_ql19 => $this->_qO6d ,)); } } function addfilter($_qO6t) { array_push($this->Filters ,$_qO6t); } function addexception($_qle) { array_push($this->ExceptionList ,$_qle); } function _ql6u() { $_qO6u=(!empty($this->Filters) || !empty($this->ExceptionList)); if (empty($this->ExceptionList) && $this->IncludeAll == FALSE) $_qO6u=TRUE; return $_qO6u; } function _ql6v($_qle) { $this->_qO6b[$_qle]=1; } function _ql6r() { $_qO6n=$this->_ql5v; $_ql6o=$_qO6n->DataSource; $this->_ql3z($_ql6h,$_qO6i,$_ql6j,$_qO6j,$_ql6k); $_qO5p=$_ql6o->_ql5l(TRUE)->_ql5m(array(array(_qOj::_qlr => $_ql6j,_qOj::_qO2l => $_ql6h,_qOj::_qOt => $_qO6j)),NULL,NULL); $_qO4q=$_ql6o->_queryall($_qO5p); foreach ($_qO4q as $_ql4r) { $_qle=$this->_ql6i($_ql4r[$_qO6j]); $this->_ql6v($_qle); } ksort($this->_qO6b); } function _qO6v($_ql6w) { foreach ($_ql6w as $_qO6w) $this->_ql6v($_qO6w); return $this; } function _ql6x() { $_ql6w=array(); foreach (array_keys($this->_qO6b) as $_qO6w) array_push($_ql6w,$_qO6w); return $_ql6w; } function _qO6x($_qle) { if ($this->IncludeAll && in_array(($_qle),$this->ExceptionList)) return FALSE; if ($this->IncludeAll == FALSE && !in_array(($_qle),$this->ExceptionList)) return FALSE; foreach ($this->Filters as $_qO6t) { switch ($_qO6t[0]) { case _qOj::_qO19: if (!($_qle == $_qO6t[1])) return FALSE; break; case _qOj::_ql1a: if (!($_qle != $_qO6t[1])) return FALSE; break; case _qOj::_qO1a: if (!($_qle<$_qO6t[1])) return FALSE; break; case _qOj::_ql1b: if (!($_qle>$_qO6t[1])) return FALSE; break; case _qOj::_qO1b: if (!($_qle<=$_qO6t[1])) return FALSE; break; case _qOj::_ql1c: if (!($_qle>=$_qO6t[1])) return FALSE; break; case _qOj::_qO1c: if (!(($_qle>$_qO6t[1]) && ($_qle<$_qO6t[2]))) return FALSE; break; case _qOj::_ql1d: if (!(($_qle<$_qO6t[1]) || ($_qle>$_qO6t[2]))) return FALSE; break; case _qOj::_qO1d: if (strpos(strtolower($_qle),strtolower($_qO6t[1])) === FALSE) return FALSE; break; case _qOj::_ql1e: if (strpos(strtolower($_qle),strtolower($_qO6t[1])) !== 0) return FALSE; break; case _qOj::_qO1e: if (strpos(strrev(strtolower($_qle)),strrev(strtolower($_qO6t[1]))) !== 0) return FALSE; break; } } return TRUE; } function _ql6y() { foreach ($this->_ql6b as $_qO6y) { foreach ($this->Filters as $_qO6t) { $_qO6y->_ql6z($_qO6t[0],$_qO6t[1]); } } return TRUE; } function _qO6z() { $_ql70=$this->_ql5v->CssClasses; $_qO70="<\144\151v id='\173\151\144}' c\154\141ss='k\160\164\106ilt\145\162Pane\154\040\173cs\163\175\047 sty\154\145='widt\150\072\173wi\144\164\150}px;\150\145\151ght:\173\150eight}\160\170\073'>\173\146\165nctio\156\137\160anel\175\074div cl\141\163s='kpt\123\143rollP\141\156el' s\164\171\154e='h\145\151\147ht:\062\0600px;o\166\145\162flow\055\171:scro\154\154;over\146\154\157w-x:\141\165to;'>\173\166\141lue\146\151\154ter}\074\144iv></\144\151v><di\166\040 id='\173\151d}_fi\154\164\145rwi\164\150\157ptio\156\163' cl\141\163s='k\160\164\106ilt\145\162\127ith\117\160tions\047\076\173in\143\154ude_e\170\143lude}\173\154ist}<\057\144iv><\057\144iv>\173\150\151dden\175\074/div>"; $_qO70=_qO0('{css}',isset ($_ql70['filter panel']) ? $_ql70['filter panel']: '',$_qO70); $_ql71="\074\144iv clas\163\075'kptFun\143\164ionPa\156\145\154'>\173\157\153}\173\143\141ncel}<\057\144iv>"; $_qO71="\074\151nput id=\047\173id}' t\171\160e='but\164\157n' va\154\165e='\173\164\145xt}' \143\154ass='k\160\164\173type\175\102utton\047\040/>"; $_ql72="<di\166\040\151d='\173\151\144}_fil\164\145\162with\166\141\154ues\047\040clas\163\075'kptF\151\154\164erWi\164\150\126alue\163\047>\173fi\145\154\144}<se\154\145\143t id\075\047\173id}\137\163\145lect\047\040name=\047\173id}_se\154\145ct'>\173\157\160tions\175\074/sel\145\143\164><in\160\165t id='\173\151d}_va\154\165\1451' n\141\155e='\173\151\144\175_val\165\1451' va\154\165\145='\173\166\141lue1}\047\040style\075\047disp\154\141\171:no\156\145\047 />\074\163pan s\164\171\154e='\144\151\163pla\171\072\156on\145\047> \173\141\156d} <i\156\160\165t i\144\075'\173id\175\137valu\145\062' nam\145\075'\173i\144\175\137val\165\1452' va\154\165e='\173\166\141lue2\175\047 /></\163\160an><\057\144iv>"; $_qO72="<optio\156\040\166alue\075\047\173val\165\145\175' \173\163\145lect\145\144}>\173\164\145xt}</o\160\164\151on>"; $_ql73="<\144\151\166 clas\163\075'kptIn\143\154udeExc\154\165de'>\173\151\156clud\145\175\173exc\154\165\144e}</\144\151\166>"; $_qO73="<\163\160\141n cla\163\163\075'kp\164\111\156ExOp\164\151on'><\151\156put i\144\075'\173id\175\047 class\075\047kptRa\144\151\157' t\171\160\145='ra\144\151o' nam\145\075'\173na\155\145\175' \173\143\150ecked\175\040value=\047\173value\175\047/><lab\145\154 cla\163\163='kpt\114\141\142el' \146\157r='\173\151\144}'>\173\164\145\170t}<\057\154\141bel\076\074/span\076"; $_ql74="<div c\154\141\163s='kp\164\114ist'>\173\151\164ems}<\057\144iv>"; $_qO74="<div cla\163\163\075'kptL\151\163\164Opti\157\156\047><i\156\160ut id\075\047\173id\175\047\040cla\163\163\075'kpt\103\150\145ck'\040\164ype='c\150\145\143kbox\047\040\173che\143\153ed} />\074\154abel c\154\141ss='kp\164\114abel' \146\157r='\173\151\144\175'>\173\164\145xt}<\057\154abel><\057\144iv>"; $_ql75="\074input ty\160\145\075'hid\144\145n' id=\047\173id}_h\151\144\144en'\040\156ame='\173\151d}_hid\144\145\156' va\154\165\145='\173\166\141lue}'\040\057>"; $_qO75=FALSE; if (! isset ($_POST[$this->_qO5y."\137\150idden"])) { $_POST[$this->_qO5y."\137includ\145\137exclu\144e"]=_qOj::_qO1y; if (count($this->Filters)>0) { $_POST[$this->_qO5y."\137\163elect"]=$this->Filters[0][0]; $_POST[$this->_qO5y."\137\166\141lue1"]=$this->Filters[0][1]; if ( isset ($this->Filters[0][2])) $_POST[$this->_qO5y."_v\141\154\165e2"]=$this->Filters[0][2]; $_POST[$this->_qO5y."\137hidde\156"]="vl"; } else { $_POST[$this->_qO5y."_hi\144\144\145n"]="ie"; } $_qO75=TRUE; } $_ql76=_qO0("\173id}",$this->_qO5y."_ca\156\143\145l",$_qO71); $_ql76=_qO0("\173t\145\170\164}",$this->_ql5v->Localization->_ql62[_qOj::_ql1y],$_ql76); $_ql76=_qO0("\173type}",_qOj::_ql1y,$_ql76); $_qO76=_qO0("\173\151\144}",$this->_qO5y."_o\153",$_qO71); $_qO76=_qO0("\173text}",$this->_ql5v->Localization->_ql62[_qOj::_ql1x],$_qO76); $_qO76=_qO0("\173type}",_qOj::_ql1x,$_qO76); $_ql77=_qO0("\173ok}",$_qO76,$_ql71); $_ql77=_qO0("\173c\141\156\143el}",$_ql76,$_ql77); $_qO77=_qO0("\173\151d}",$this->_qO5y ,$_ql72); $_qO77=_qO0("\173value\061\175",isset ($_POST[$this->_qO5y."\137\166alue1"]) ? $_POST[$this->_qO5y."_v\141\154\165e1"]: "",$_qO77); $_qO77=_qO0("\173\166alue2}",isset ($_POST[$this->_qO5y."\137value2"]) ? $_POST[$this->_qO5y."\137\166alue2"]: "",$_qO77); $_ql78=array(_qOj::_qO1j,_qOj::_qO19,_qOj::_ql1a,_qOj::_qO1a,_qOj::_ql1b,_qOj::_qO1b,_qOj::_ql1c,_qOj::_qO1c,_qOj::_ql1d,_qOj::_qO1d,_qOj::_ql1e,_qOj::_qO1e,); $_qO78=array(_qOj::_ql2r,_qOj::_qO2r,_qOj::_ql2s,_qOj::_qO2s); $_ql79=""; foreach ($_ql78 as $_qle) { $_qO79=_qO0("\173\166alue}",$_qle,$_qO72); $_qO79=_qO0("\173\164ext}",$this->_ql5v->Localization->_ql62[$_qle],$_qO79); $_qO79=_qO0("\173\163elected}",( isset ($_POST[$this->_qO5y."\137sele\143\164"]) && $_POST[$this->_qO5y."\137\163elect"] == $_qle) ? "se\154\145cted='s\145\154ected\047": "",$_qO79); $_ql79.=$_qO79; } if (count($this->_ql6b)>0) foreach ($_qO78 as $_qle) { $_qO79=_qO0("\173\166\141lue}",$_qle,$_qO72); $_qO79=_qO0("\173\164ext}",$this->_ql5v->Localization->_ql62[$_qle],$_qO79); $_qO79=_qO0("\173\163\145lected\175",( isset ($_POST[$this->_qO5y."\137\163elect"]) && $_POST[$this->_qO5y."_sele\143\164"] == $_qle) ? "s\145\154ected='\163\145lected\047": "",$_qO79); $_ql79.=$_qO79; } $_qO77=_qO0("\173\157\160tions}",$_ql79,$_qO77); $_qO77=_qO0("\173field\175",$this->Text ,$_qO77); $_qO77=_qO0("\173\141nd}",$this->_ql5v->Localization->_qO62[_qOj::_qO2d],$_qO77); $_ql7a=_qO0("\173\151d}",$this->_qO5y."\137inclu\144\145",$_qO73); $_ql7a=_qO0("\173\156ame}",$this->_qO5y."\137in\143\154\165d\145\137exclu\144\145",$_ql7a); $_ql7a=_qO0("\173text}",$this->_ql5v->Localization->_ql62[_qOj::_qO1y],$_ql7a); $_ql7a=_qO0("\173value}",_qOj::_qO1y,$_ql7a); $_ql7a=_qO0("\173\143hecked\175",( isset ($_POST[$this->_qO5y."\137include\137\145xclude"]) && $_POST[$this->_qO5y."\137include\137\145xclude"] == _qOj::_qO1y) ? "\143hecke\144\075'check\145\144'": "",$_ql7a); $_qO7a=_qO0("\173\151\144\175",$this->_qO5y."\137ex\143\154ude",$_qO73); $_qO7a=_qO0("\173\156\141me}",$this->_qO5y."_i\156\143lude_e\170\143lude",$_qO7a); $_qO7a=_qO0("\173te\170\164}",$this->_ql5v->Localization->_ql62[_qOj::_ql1z],$_qO7a); $_qO7a=_qO0("\173v\141\154ue}",_qOj::_ql1z,$_qO7a); $_qO7a=_qO0("\173\143\150ecked\175",( isset ($_POST[$this->_qO5y."_includ\145\137exclu\144\145"]) && $_POST[$this->_qO5y."\137\151nclu\144\145_exc\154\165de"] == _qOj::_ql1z) ? "\143hecked=\047\143heck\145\144'": "",$_qO7a); $_ql7b=_qO0("\173\151\156clude\175",$_ql7a,$_ql73); $_ql7b=_qO0("\173\145xclud\145\175",$_qO7a,$_ql7b); $_ql6w=""; $_qO7b=_qO0("\173id}",$this->_qO5y."\137select\141\154\154",$_qO74); $_qO7b=_qO0("\173\164\145xt}",$this->_ql5v->Localization->_ql62[_qOj::_qO1z],$_qO7b); $_qO7b=_qO0("\173\143hecked\175","",$_qO7b); $_ql6w.=$_qO7b; $_qO8=0; foreach ($this->_qO6b as $_ql2z => $_qO2z) { $_qO6w=_qO0("\173id}",$this->_qO5y."_".$_qO8,$_qO74); $_qO6w=_qO0("\173t\145\170t}",$_ql2z,$_qO6w); if (!$_qO75) { $_qO6w=_qO0("\173\143\150ecke\144\175",isset ($_POST[$this->_qO5y."\137".$_qO8]) ? "\143heck\145\144='c\150\145cke\144\047": "",$_qO6w); } else { $_qO6w=_qO0("\173\143heck\145\144}",$this->_qO6x($_ql2z) ? "\143hecke\144\075'\143heck\145d'": "",$_qO6w); } $_qO8 ++; $_ql6w.=$_qO6w; } $_ql7c=_qO0("\173\151tems}",$_ql6w,$_ql74); $_qO7c=_qO0("\173id}",$this->_qO5y ,$_ql75); $_qO7c=_qO0("\173va\154\165e}",$_POST[$this->_qO5y."\137hi\144\144en"],$_qO7c); $_ql8=_qO0("\173\151d}",$this->_qO5y ,$_qO70); $_ql8=_qO0("\173\167id\164\150}",$this->_ql6d ,$_ql8); $_ql8=_qO0("\173\150eight\175",$this->_qO6d ,$_ql8); $_ql8=_qO0("\173\146\165ncti\157\156_pane\154\175",$_ql77,$_ql8); $_ql8=_qO0("\173includ\145\137exclud\145\175",$_ql7b,$_ql8); $_ql8=_qO0("\173\166aluefi\154\164er}",$_qO77,$_ql8); $_ql8=_qO0("\173\154ist}",$_ql7c,$_ql8); $_ql8=_qO0("\173\150\151dden}",$_qO7c,$_ql8); return $_ql8; } function _ql7d($_ql5k=NULL) { $_qO74="<sp\141\156 id='\173\151\144}' c\154\141ss='\153\160tFiel\144\111tem\173\144rag\141\142le} \173\143\163s}' \164\151tle='\173\164oolt\151\160}'>\173\164\145xt}\173\163\157rt}\173\146\151lter\175\074/spa\156\076"; $_qO7d="\074span cl\141\163s='kpt\104\145sc'>\173\164\145xt}\074\057span\076"; $_ql7e="\074span \143\154ass='k\160\164Filte\162\102utton\047\040titl\145\075'\173\164\157oltip\175\047></sp\141\156>"; $_qO7e="<spa\156\040class=\047\153ptSor\164\102utto\156\040kptSo\162\164\173d\151\162ecti\157\156}\173s\164\141tus}'\040\164itle=\047\173too\154\164ip}' \157\156click\075\047pivo\164\137sort_\164\157ggle(\164\150is)'>\074\057span\076"; $_qO6w=_qO0("\173\151d}",$this->_qO5y ,$_qO74); $_qO6w=_qO0("\173\144\162aga\142\154e}",$this->AllowReorder ? "\040kp\164\104ra\147\141ble": "",$_qO6w); $_ql70=$this->_ql5v->CssClasses; $_qO6w=_qO0("\173\143ss}",isset ($_ql70['field']) ? $_ql70['field']: "",$_qO6w); $_qO6w=_qO0("\173tool\164\151p}",($this->Tooltip != NULL) ? $this->Tooltip : (($this->AllowReorder) ? $this->_ql5v->Localization->_qO62[_qOj::_ql2c]: ""),$_qO6w); $_qO6w=_qO0("\173\164\145xt}",$this->Text ,$_qO6w); if ($_ql5k === _ql2t::_qlp) { $_qO6w=_qO0("\173so\162\164}","",$_qO6w); } { switch (strtolower($this->Sort)) { case _qOj::_qll: $_ql7f=_qO0("\173\144irect\151\157n\175","\101\163c",$_qO7e); $_ql7f=_qO0("\173\164oolt\151\160}",$this->_ql5v->Localization->_qO62[_qOj::_ql2e],$_ql7f); break; case _qOj::_qlm: $_ql7f=_qO0("\173direct\151\157\156}","Desc",$_qO7e); $_ql7f=_qO0("\173to\157\154\164ip}",$this->_ql5v->Localization->_qO62[_qOj::_qO2e],$_ql7f); break; case _qOj::_qO1j: default : $_ql7f=""; break; } $_qO7f=($this->_qO69) ? "On": "Off"; $_ql7f=_qO0("\173statu\163\175",$_qO7f,$_ql7f); $_qO6w=_qO0("\173\163\157rt}",$this->AllowSorting ? $_ql7f: "",$_qO6w); $_qO6t=_qO0("\173\164\157oltip}",$this->_ql5v->Localization->_qO62[_qOj::_ql2f],$_ql7e); $_qO6w=_qO0("\173\146\151lter}",$this->AllowFiltering ? $_qO6t: "",$_qO6w); } return $_qO6w; } function renderheader($_qle) { return $_qle; } function renderheadertotal($_qle) { return _qO0("\173category\175",$_qle,$this->_ql5v->Localization->_ql62[_qOj::_qO20]); } function _ql7g($_qle,$_ql46) { return _qO0("\173\143\141\164egory\175",$_qle,$this->_ql5v->Localization->_ql62[_qOj::_qO20]).$_ql46; } function dataprocess($_qle) { return $_qle; } function _qO7g($_ql78) { return $_ql78; } function dataaggregate($_qle,$_ql7h) { return (($_ql7h === NULL) ? 0: $_ql7h)+$_qle; } function displayformat($_qle) { return $_qle; } } class pivotfield extends _qls { var $_qO7h; var $_ql7i; var $NoMatchValue; var $ConvertToPercent=FALSE; function __construct($_ql6g) { parent:: __construct($_ql6g); $this->_qO7h =array(); $this->_ql7i =array(); } function _qO7g($_ql78) { if ($this->ConvertToPercent) { $_qO7i=$this->_ql5v->_ql7j[_ql2t::_qlq]->_qO7j(0); $_ql7k=$this->_ql5v->_ql7j[_ql2t::_qOq]->_qO7j(0); $this->_ql5v->_qO7k($_qO7i,$_ql7k,$_ql7l,$_qO7l,$_qOd); $_ql7m=$this->_qO6e; $_qO7m=$_ql78[$_ql7l][$_qO7l][$_qOd][$_ql7m]; foreach ($_ql78 as $_ql7n => $_qO7n) foreach ($_qO7n as $_ql7o => $_qO7o) foreach ($_qO7o as $_ql2z => $_ql7p) { $_ql78[$_ql7n][$_ql7o][$_ql2z][$_ql7m]=$_qO7m != 0 ? $_ql78[$_ql7n][$_ql7o][$_ql2z][$_ql7m]*0144/$_qO7m: 0; } } return $_ql78; } } class pivotdatefield extends pivotfield { private static $_qO7p=array("\171\145ar","\161\165arter","\155onth","day"); private $_ql7q=array("\171\145\141r" => FALSE,"\161uarte\162" => FALSE,"m\157\156th" => FALSE,"\144ay" => TRUE); public function setdatefields($_ql2y) { if (is_array($_ql2y)) { foreach ($_ql2y as $_ql2z => $_qO2z) if (in_array(strtolower($_ql2z),_qO7q::$_qO7p)) $this->_ql7q[strtolower($_ql2z)]=$_qO2z; } return $this; } public function getdatefields() { return $this->_ql7q; } } class pivotstringfield extends pivotfield { var $SqlOperator=""; function renderheadertotal($_qle) { return $this->Text; } } class pivotsumfield extends pivotfield { var $ValueForNull=0; var $DecimalNumber=0; var $DecimalPoint="."; var $ThousandSeperate="\054"; var $FormatString="\173n}"; function renderheadertotal($_qle) { $_ql46=_qO0("\173\143\141te\147\157r\171}",$_qle,$this->_ql5v->Localization->_ql62[_qOj::_ql21]); return $_ql46; } function dataprocess($_qle) { $_qle=parent::dataprocess($_qle); if ($_qle == NULL) return $this->ValueForNull; else return $_qle; } function displayformat($_qle) { $_ql7r= (double) $_qle; return _qO0("\173\156}",number_format($_ql7r,$this->DecimalNumber ,$this->DecimalPoint ,$this->ThousandSeperate),$this->FormatString); } } class pivotaveragefield extends pivotsumfield { var $DecimalNumber=2; var $DecimalPoint="."; var $ThousandSeperate="\054"; var $SqlOperator=_qO30::_ql32; function renderheadertotal($_qle) { return _qO0("\173catego\162\171}",$_qle,$this->_ql5v->Localization->_ql62[_qOj::_ql23]); } } class pivotpercentagesumfield extends pivotsumfield { var $DecimalNumber=2; var $FormatString="\173\156\175%"; var $ConvertToPercent=TRUE; var $SqlOperator=_qO30::_qO32; function renderheadertotal($_qle) { return _qO0("\173\143\141\164ego\162\171}",$_qle,$this->_ql5v->Localization->_ql62[_qOj::_qO23]); } } class pivotpercentagecountfield extends pivotsumfield { var $DecimalNumber=2; var $FormatString="\173n}%"; var $ConvertToPercent=TRUE; var $SqlOperator=_qO30::_ql33; function renderheadertotal($_qle) { return _qO0("\173\143ategory\175",$_qle,$this->_ql5v->Localization->_ql62[_qOj::_ql24]); } } class pivotminfield extends pivotsumfield { var $SqlOperator=_qO30::_qO33; function renderheadertotal($_qle) { return _qO0("\173\143atego\162\171}",$_qle,$this->_ql5v->Localization->_ql62[_qOj::_ql22]); } } class pivotmaxfield extends pivotsumfield { var $SqlOperator=_qO30::_ql34; function renderheadertotal($_qle) { return _qO0("\173\143\141tegor\171\175",$_qle,$this->_ql5v->Localization->_ql62[_qOj::_qO22]); } } class pivotcountfield extends pivotsumfield { var $SqlOperator=_qO30::_ql33; function renderheadertotal($_qle) { return _qO0("\173\143ategory\175",$_qle,$this->_ql5v->Localization->_ql62[_qOj::_qO21]); } } class _qO7r extends pivotfield { var $FieldName; var $Expand; var $_ql6f; public static function _ql7s() { $_ql5k=new _qls(_qOj::_qOn); $_ql5k->Expand =TRUE; $_ql5k->_qO6g(_qOj::_qOn); return $_ql5k; } } class _qO7s extends _qO3f { var $_ql7t; var $_qO7t=FALSE; var $_ql7u; var $_qO7u=""; public $_ql7v; public $_qO7v; public $_ql7w=array(); var $_ql5v; var $_ql6a; var $_qO5y; var $_qO7w; var $_ql7x; var $_qOb; function __construct($_qle,$_ql5k) { $this->Value =$_qle; $this->_qO3i =strlen($this->Value); $this->_qO3g =array(); if ( isset ($_ql5k)) { $this->_ql7t =$_ql5k; $this->Expand =$_ql5k->Expand; $this->_ql5v =$_ql5k->_ql5v; } } public static function _qO7x($_qle,$_ql5k) { $_qO3k=new _qO7s($_qle,$_ql5k); return $_qO3k; } public static function _ql7y($_qle,$_ql5k) { $_qO3k=new _qO7y($_qle,$_ql5k); return $_qO3k; } function _ql7z($_ql2y="") { return parent::_ql3o($_ql2y); } function _qO7z($_ql2y="") { return parent::_ql3p($_ql2y); } function _qO7j($_ql2y=0) { return parent::_qO3p($_ql2y); } function _ql80() { return parent::_ql3q(); } function _qO80($_qO3m) { $this->_qO7u =($_qO3m != NULL) ? $_qO3m->_qO7u."_".$this->Value : $this->Value; $this->_ql7u =md5($this->_qO7u); $this->_qO5y =$this->_ql5v->_qO5y."\137".$this->_ql7u; } function _ql5x($_qO5x) { $this->_ql5v =$_qO5x; $this->_ql6a =$_qO5x->_ql6a; $this->_qO80($this->_ql3g); if ($this->_ql7x === NULL) $this->_ql7x =$this->_ql5v->AllowSortingData; if ($this->_qO7w === NULL) $this->_qO7w =_qOj::_qll; if ($this->_ql7v === NULL) $this->_ql7v =""; if ($this->_qO7v === NULL) $this->_qO7v =""; } function _ql6t() { if ($this->Expand != $this->_ql7t->Expand || $this->_qO7w == _qOj::_qlm) { $this->_ql6a->_qO5v[$this->_qO5y ]=array(_qOj::_qlz => $this->Expand ,_qOj::_ql15 => $this->_qO7w ,); } } function _qO6k() { if ( isset ($this->_ql6a->_qO5v[$this->_qO5y ])) { $_ql6l=$this->_ql6a->_qO5v[$this->_qO5y ]; $this->Expand =$_ql6l[_qOj::_qlz]; $this->_qO7w =$_ql6l[_qOj::_ql15]; } } function _ql6z($_qO6t,$_qle) { $_ql81=count($this->_qO3g); $_ql55=0; switch ($_qO6t) { case _qOj::_ql2r: foreach ($this->_qO3g as $_qO3q) { if ($_ql55<$_qle) $_qO3q->_qO3y(TRUE); else $_qO3q->_qO3y(FALSE); $_ql55 ++; } break; case _qOj::_qO2r: foreach ($this->_qO3g as $_qO3q) { if ($_ql81-$_ql55-1<$_qle) $_qO3q->_qO3y(TRUE); else $_qO3q->_qO3y(FALSE); $_ql55 ++; } break; case _qOj::_ql2s: foreach ($this->_qO3g as $_qO3q) { if (0144*$_ql55/$_ql81<$_qle) $_qO3q->_qO3y(TRUE); else $_qO3q->_qO3y(FALSE); $_ql55 ++; } break; case _qOj::_qO2s: foreach ($this->_qO3g as $_qO3q) { if (0144*($_ql81-$_ql55-1)/$_ql81<$_qle) $_qO3q->_qO3y(TRUE); else $_qO3q->_qO3y(FALSE); $_ql55 ++; } break; } } function _qO81($_qle) { $this->_qO7w =$_qle; return $this; } function _ql82($_qle) { $this->Expand =$_qle; return $this; } function _qO82($_qle) { $this->_qOb =$_qle; return $this; } function getsortvalue() { return $this->_qOb; } function _qO6m($_ql6n) { if ( isset ($_ql6n->_ql62[$this->_qO5y ])) { $_qO51=$_ql6n->_ql62[$this->_qO5y ]; $_qO6n=$this->_ql5v; switch ($_qO51[_qOj::_qOy]) { case _qOj::_qlz: if ($_qO6n->EventHandler->onbeforegroupexpand($this,array()) == TRUE) { $this->_ql82(TRUE); $_qO6n->EventHandler->ongroupexpand($this,array()); } break; case _qOj::_qOz: if ($_qO6n->EventHandler->onbeforegroupcollapse($this,array()) == TRUE) { $this->_ql82(FALSE); $_qO6n->EventHandler->ongroupcollapse($this,array()); } break; case _qOj::_ql10: if ($_qO6n->EventHandler->_ql83($this,array()) == TRUE) { $this->_qO81($_qO51[_qOj::_qO1m][_qOj::_ql15])->_qO83(); $_qO6n->setsortstate(_qOj::_ql2q); $_qO6n->EventHandler->_ql84($this,array()); } break; } } } function _qO83() { $_qO84=array(_qOj::_qO1i => $this->_qO5y ,_qOj::_qlu => $this->_qO7w); $this->_ql5v->_ql6q[$this->_ql7t->_ql6f ]=$_qO84; return $this; } function _ql85() { $_qO85=array(); foreach ($this->_qO3g as $_ql86) array_push($_qO85,$_ql86->_qO5y); return array(_qOj::_qlz => $this->Expand ,_qOj::_qOs => urlencode($this->Value),_qOj::_ql1f => $this->_qO7t ,_qOj::_qO1f => $this->_qO7u ,_qOj::_ql1g => $this->_ql7v ,_qOj::_qO1g => $this->_qO7v ,_qOj::_qO1i => $this->_qO5y ,_qOj::_ql1j => $_qO85,_qOj::_qOj => $this->_ql7u ,_qOj::_ql15 => $this->_qO7w ,_qOj::_qOu => $this->_qOb ,_qOj::_ql1h => $this->_ql7w ,); } function _dosortinggroups($_qOk) { if (count($this->_qO3g)>0) { switch ($_qOk) { case _qOj::_qll: uasort($this->_qO3g ,'Groups_Compare_asc'); break; case _qOj::_qlm: uasort($this->_qO3g ,'Groups_Compare_desc'); break; } foreach ($this->_qO3g as $_ql86) $_ql86->_dosortinggroups($_qOk); } } function _qO86() { if (!empty($this->_qO3g)) { foreach ($this->_qO3g as $_qO3s) { $_ql5k=$_qO3s->_ql7t; $_qOk=($_ql5k->Sort != NULL) ? $_ql5k->Sort : $this->_ql5v->_ql87[$_ql5k->_ql6f ]; break; } switch ($_qOk) { case _qOj::_qll: uasort($this->_qO3g ,'Groups_Compare_asc'); break; case _qOj::_qlm: uasort($this->_qO3g ,'Groups_Compare_desc'); break; case "cu\163\164om": if (function_exists("\107roups_C\157\155pare_\143\165sto\155")) uasort($this->_qO3g ,'Groups_Compare_custom'); break; } foreach ($this->_qO3g as $_ql86) $_ql86->_qO86(); } } function _qO87() { $_ql88=0; $_qO88=2; $_qO2y=array(); if ($this->Expand) { $_ql3f=new _ql3c(); $this->_ql3t($_qO88); $this->_qO3v(1); $this->_qO3u(0); $_ql3f->_ql3a($this); $_ql89=new _ql3c(); while (!$_ql3f->_qO3b()) { $_qO3k=$_ql3f->_qO3a(); $_qO3k->_ql3y($_ql88 ++); $_ql89->_ql3a($_qO3k); if ($_qO3k->Expand) { foreach ($_qO3k->_qO3g as $_qO3s) if ($_qO3s->_qO3o()) { $_qO3s->_ql3t($_qO3k->_ql3u()+1); $_qO3s->_qO3v(1); $_qO3s->_qO3u(0); $_ql3f->_ql3a($_qO3s); } } } while (!$_ql89->_qO3b()) { $_qO3k=$_ql89->_qO3a(); $_qO3m=$_qO3k->_ql3r(); if ($_qO3k->_ql3v()>=$_qO3m->_ql3v()) $_qO3m->_qO3u($_qO3k->_ql3v()+1); $_qO3m->_ql3w($_qO3k->_qO3w()); array_push($_qO2y,$_qO3k); } } return $_qO2y; } function _qO89() { $_qO70="\173\163\151gn}\173\164\145xt}\173\163\157rt}"; $_ql8a="\074\163pan \143\154as\163\075'\173\163\164at\165\163}' \157\156cl\151\143k=\047pivot\137\147rou\160\137to\147\147le(\164\150is)\047\076</s\160\141n>"; $_qO7d="<span \143\154\141ss=\047\153ptDe\163\143'>\173t\145\170t}</\163\160an>"; $_qO7e="<sp\141\156 class=\047\153ptSor\164\102utton\040\153ptSo\162\164\173di\162\145ctio\156\175\173st\141\164us}' t\151\164le='\173\164oolti\160\175' onc\154\151ck='p\151\166ot_gr\157\165p_sor\164\137toggl\145\050this)\047\076</sp\141\156>"; if ($this->_ql5v->AllowSortingData) { switch (strtolower($this->_qO7w)) { case _qOj::_qll: $_ql7f=_qO0("\173\144\151\162ect\151\157n}","Asc",$_qO7e); $_ql7f=_qO0("\173\164oolti\160\175",$this->_ql5v->Localization->_qO62[_qOj::_ql2e],$_ql7f); break; case _qOj::_qlm: $_ql7f=_qO0("\173d\151\162\145ction\175","\104\145\163c",$_qO7e); $_ql7f=_qO0("\173t\157\157\154tip}",$this->_ql5v->Localization->_qO62[_qOj::_qO2e],$_ql7f); break; case _qOj::_qO1j: default : $_ql7f=""; break; } $_qO7f="Off"; if (!empty($this->_ql5v->_ql6q)) foreach ($this->_ql5v->_ql6q as $_ql30 => $_qO84) if (!empty($_qO84) && $_qO84[_qOj::_qO1i] == $this->_qO5y) $_qO7f="On"; $_ql7f=_qO0("\173\163tatu\163}",$_qO7f,$_ql7f); } else $_ql7f=""; $_qO70=_qO0("\173\163ort}",$this->_ql5v->AllowSortingData ? $_ql7f: "",$_qO70); $_qO8a=""; if ($this->_qO7t) $_qO8a=_qO0("\173\163tatus}",$this->Expand ? "\153\160tExpa\156\144": "kpt\103\157llapse",$_ql8a); $_ql46=""; $_ql8=_qO0("\173\164ext}",$this->_ql7t->renderheader($this->Value).$_ql46,$_qO70); $_ql8=_qO0("\173sig\156\175",$_qO8a,$_ql8); return $_ql8; } function _ql8b() { return $this->_ql7t->renderheadertotal($this->Value); } function _qO5z() { return ""; } } class _qO8b extends _qO7s { var $Expand=TRUE; } class _ql8c extends _qO7s { var $Expand=TRUE; } class _qO7y extends _qO7s { var $Expand=TRUE; function _qO89() { return "\074b>".$this->_ql5v->Localization->_ql62[_qOj::_ql20]."</b\076"; } } class _qO8c extends _qO7y { } class _ql8d extends _qO7y { } class _qO8d { var $_qO5y; var $_ql5v; var $_ql62; function _ql5x($_qO5x) { $this->_ql5v =$_qO5x; $this->_qO5y =$_qO5x->_qO5y."_c\155d"; $this->_ql8e(); } function _ql8e() { if ( isset ($_POST[$this->_qO5y ])) { $_ql5y=$_POST[$this->_qO5y ]; $_ql5y=_qO0("\134","",$_ql5y); $this->_ql62 =json_decode($_ql5y,TRUE); } } function _qO5z() { $_qO8e="<in\160ut i\144\075'\173id}\047 na\155e='\173id}\047 ty\160e=\047hi\144de\156' \166alu\145\075'\047 />"; $_ql6n=_qO0("\173id}",$this->_qO5y ,$_qO8e); return $_ql6n; } } class _ql8f { var $LoadingText; var $DoneText; function _ql5x($_qO5x) { if ($this->LoadingText === NULL) $this->LoadingText =$_qO5x->Localization->_qO62[_qOj::_ql2d]; if ($this->DoneText === NULL) $this->DoneText =$_qO5x->Localization->_qO62[_qOj::_qO2c]; } function _qO5z() { $_qO8f="\074\144iv c\154ass\075'kp\164\123t\141tus\047><\163\160a\156 c\154as\163\075\047kpt\104\157n\145\124e\170\164'\076\173d\157net\145xt\175</s\160an>\074spa\156\040c\154ass\075'kp\164\114o\141din\147\124e\170t'>\173\154o\141\144i\156\147t\145xt}\074/sp\141n>\074/di\166>"; $_qO7f=_qO0("\173\144one\164\145x\164}",$this->DoneText ,$_qO8f); $_qO7f=_qO0("\173load\151\156g\164\145xt\175",$this->LoadingText ,$_qO7f); return $_qO7f; } } class pivotpager { var $PageSize=012; var $PageIndex=0; var $ShowPageSize=FALSE; var $PageSizeText; var $PageSizeOptions="5\054\0610,20\05440"; var $ShowPageInfo=TRUE; var $PageInfoTemplate; var $_ql8g; var $_qO8g; var $_qO5y; var $_ql5v; var $_ql6a; function _ql5x($_qO5x) { $this->_ql5v =$_qO5x; $this->_ql6a =$_qO5x->_ql6a; $this->_qO5y =$_qO5x->_qO5y."_\160g"; if ($this->PageInfoTemplate === NULL) $this->PageInfoTemplate =$_qO5x->Localization->_qO62[_qOj::_qO24]; if ($this->PageSizeText === NULL) $this->PageSizeText =$_qO5x->Localization->_qO62[_qOj::_qO25]; } function _qO6k() { if ( isset ($this->_ql6a->_qO5v[$this->_qO5y ])) { $_ql6l=$this->_ql6a->_qO5v[$this->_qO5y ]; $this->PageIndex =$_ql6l[_qOj::_ql1k]; $this->PageSize =$_ql6l[_qOj::_qO1k]; $this->_ql8g =$_ql6l[_qOj::_ql1l]; $this->_qO8g =$_ql6l[_qOj::_qO1l]; } } function _qO6m($_ql6n) { if ( isset ($_ql6n->_ql62[$this->_qO5y ])) { $_qO51=$_ql6n->_ql62[$this->_qO5y ]; $_qO6o=$_qO51[_qOj::_qOy]; $_ql6p=$_qO51[_qOj::_qO1m]; switch ($_qO6o) { case _qOj::_ql1m: if ($this->_ql5v->EventHandler->onbeforepagechange($this,array(_qOj::_ql1k => $_ql6p[_qOj::_ql1k])) == TRUE) { $this->PageIndex =$_ql6p[_qOj::_ql1k]; $this->_ql5v->EventHandler->onpagechange($this,array(_qOj::_ql1k => $_ql6p[_qOj::_ql1k])); } break; case _qOj::_ql1n: if ($this->_ql5v->EventHandler->onbeforepagesizechange($this,array(_qOj::_qO1k => $_ql6p[_qOj::_qO1k])) == TRUE) { $this->PageSize =$_ql6p[_qOj::_qO1k]; $this->_ql5v->EventHandler->onpagesizechange($this,array(_qOj::_qO1k => $_ql6p[_qOj::_qO1k])); } break; } } $this->_qO8g =ceil($this->_ql8g /$this->PageSize); if ($this->PageIndex >=$this->_qO8g) $this->PageIndex =$this->_qO8g -1; if ($this->PageIndex <0) $this->PageIndex =0; } function _ql6t() { $this->_ql6a->_qO5v[$this->_qO5y ]=array(_qOj::_ql1k => $this->PageIndex ,_qOj::_qO1k => $this->PageSize ,_qOj::_ql1l => $this->_ql8g ,_qOj::_qO1l => $this->_qO8g); } function _ql8h() { $_qO8h="\074d\151\166 c\154ass=\047kpt\111nfo\047>\173\164ext\175</d\151v>"; $_ql3=_qO0("\173Pag\145\111nde\170\175",($this->_qO8g >0) ? ($this->PageIndex +1): 0,$this->PageInfoTemplate); $_ql3=_qO0("\173\124otalPa\147\145s}",$this->_qO8g ,$_ql3); $_ql8i=($this->_qO8g >0) ? ($this->PageIndex *$this->PageSize +1): 0; $_qO8i=($this->PageIndex +1)*$this->PageSize; if ($_qO8i>$this->_ql8g) $_qO8i=$this->_ql8g; $_ql3=_qO0("\173F\151\162stInde\170\111nPage\175",$_ql8i,$_ql3); $_ql3=_qO0("\173L\141\163tIndex\111\156Page}",$_qO8i,$_ql3); $_ql3=_qO0("\173\124\157talRows\175",$this->_ql8g ,$_ql3); $_ql8j=_qO0("\173\164\145xt}",$_ql3,$_qO8h); return $_ql8j; } function _qO8j() { $_ql8k="\074div c\154\141\163s='k\160\164PageS\151\172e'>\173\164\145xt}\173\163ele\143\164}</d\151\166>"; $_qO8k="\074sele\143\164 onch\141\156ge='p\151\166ot_pa\147\145size\137\163ele\143\164_onc\150\141nge(t\150\151s)'>\173\157\160tio\156\163}</\163\145lect\076"; $_qO72="\074\157ptio\156\040value=\047\173valu\145\175' \173s\145\154ecte\144\175>\173\166\141lue}<\057\157ption\076"; $_ql79=""; $_ql78=explode(',',$this->PageSizeOptions); for ($_qO8=0; $_qO8<sizeof($_ql78); $_qO8 ++) { $_qO79=_qO0("\173\166\141\154ue}",$_ql78[$_qO8],$_qO72); $_qO79=_qO0("\173\163\145lecte\144\175",($this->PageSize == (int) $_ql78[$_qO8]) ? "\163elect\145\144": "",$_qO79); $_ql79.=$_qO79; } $_qO5e=_qO0("\173\157ptions\175",$_ql79,$_qO8k); $_ql8l=_qO0("\173text}",$this->PageSizeText ,$_ql8k); $_ql8l=_qO0("\173\163elect}",$_qO5e,$_ql8l); return $_ql8l; } function render() { return "\133\160ag\145\162 z\157\156e]"; } } class pivotprevnextandnumericpager extends pivotpager { var $Range=012; var $FirstPageText; var $FirstPageToolTip; var $PrevPageText; var $PrevPageToolTip; var $NextPageText; var $NextPageToolTip; var $LastPageText; var $LastPageToolTip; function _ql5x($_qO5x) { parent::_ql5x($_qO5x); $_qO51=$_qO5x->Localization->_ql62; $_qO8l=$_qO5x->Localization->_qO62; if ($this->FirstPageText === NULL) $this->FirstPageText =$_qO51[_qOj::_qO1w]; if ($this->FirstPageToolTip === NULL) $this->FirstPageToolTip =$_qO8l[_qOj::_ql27]; if ($this->PrevPageText === NULL) $this->PrevPageText =$_qO51[_qOj::_qO1v]; if ($this->PrevPageToolTip === NULL) $this->PrevPageToolTip =$_qO8l[_qOj::_qO26]; if ($this->NextPageText === NULL) $this->NextPageText =$_qO51[_qOj::_ql1v]; if ($this->NextPageToolTip === NULL) $this->NextPageToolTip =$_qO8l[_qOj::_ql26]; if ($this->LastPageText === NULL) $this->LastPageText =$_qO51[_qOj::_ql1w]; if ($this->LastPageToolTip === NULL) $this->LastPageToolTip =$_qO8l[_qOj::_qO27]; } function render() { $_ql8m="\074\144\151v cl\141ss='\153\160t\120\141ger\040\153pt\116\145x\164Pr\145vAn\144\116u\155\145ric\120\141g\145\162'>\173\156\141v}\173\160\141ges\151\172e}\173\151\156fo}<d\151\166 styl\145\075'cle\141\162:both\047\076</di\166\076</di\166\076"; $_qO8m="<di\166\040class\075\047kptN\141\166'>\173\146\151rst}\040\173pre\166\175 \173\156\165mbers\175\040\173ne\170\164} \173\154\141st}<\057\144iv>"; $_ql8n="\074a c\154\141ss=\047\153ptN\165m \173\163ele\143\164ed\175\047 \173\150ref}\040\173oncl\151\143k}><s\160\141n>\173\156\165mber\175\074/spa\156\076</a> "; $_qO71="\074input t\171\160e='bu\164\164on'\040\157ncli\143\153='\173\157\156c\154\151c\153\175' \164\151t\154\145='\173\164itl\145\175' cl\141\163s='no\144\145cor'\057\076"; $_qO8n="<a hre\146\075'javasc\162\151pt:vo\151\144 0' o\156\143lick\075\047\173o\156\143lick\175\047 titl\145\075'\173t\151\164le}'>\173\164ext}\074\057a>"; $_ql8o="\074\163pan clas\163\075 '\173\143\154ass}'\076\173butto\156\175</sp\141\156>"; $_qO8o=floor($this->PageIndex /$this->Range)*$this->Range; $_ql8p=""; if ($_qO8o>0) { $_ql7r=_qO0("\173href}","href='\152\141\166asc\162\151\160t:v\157\151d 0'",$_ql8n); $_ql7r=_qO0("\173onclic\153\175","\157\156click\075\047pivot_\147\157page(\164\150is,".($_qO8o-1).")'",$_ql7r); $_ql7r=_qO0("\173\156\165mber}","\056..",$_ql7r); $_ql8p.=$_ql7r; } for ($_qO8=$_qO8o; $_qO8<$_qO8o+$this->Range && $_qO8<$this->_qO8g; $_qO8 ++) { $_ql7r=_qO0("\173\156umber}",($_qO8+1),$_ql8n); if ($_qO8 == $this->PageIndex) { $_ql7r=_qO0("\173\163\145lecte\144\175","\153ptNumS\145\154\145cted",$_ql7r); $_ql7r=_qO0("\173\150ref\175","",$_ql7r); $_ql7r=_qO0("\173\157\156click\175","",$_ql7r); } else { $_ql7r=_qO0("\173\163elected\175","",$_ql7r); $_ql7r=_qO0("\173hr\145\146\175","href='\152\141\166ascr\151\160t:vo\151\144 0'",$_ql7r); $_ql7r=_qO0("\173on\143\154\151ck}","onclick\075\047pivot\137\147opage\050\164his,".$_qO8.")\047",$_ql7r); } $_ql8p.=$_ql7r; } if ($_qO8o+$this->Range <$this->_qO8g) { $_ql7r=_qO0("\173\150ref}","href=\047\152ava\163\143ri\160\164:vo\151\144 0'",$_ql8n); $_ql7r=_qO0("\173onc\154\151ck}","\157\156clic\153\075'pi\166\157t_g\157\160age\050\164hi\163\054".($_qO8o+$this->Range)."\051'",$_ql7r); $_ql7r=_qO0("\173n\165\155ber\175","\056\056.",$_ql7r); $_ql7r=_qO0("\173se\154\145\143ted}","",$_ql7r); $_ql8p.=$_ql7r; } $_qO8p=_qO0("\173\157nclick}",($this->PageIndex >0) ? "pi\166\157t_gopag\145\050this,\060\051": "",$_qO71); $_qO8p=_qO0("\173\164\151tle}",$this->FirstPageToolTip ,$_qO8p); $_ql8q=_qO0("\173o\156\143\154ick\175",($this->PageIndex >0 && $this->FirstPageText !== NULL) ? "\160ivot_go\160\141ge(thi\163\0540)": "",$_qO8n); $_ql8q=_qO0("\173\164\145xt}",$this->FirstPageText ,$_ql8q); $_ql8q=_qO0("\173tit\154\145\175",$this->FirstPageToolTip ,$_ql8q); $_qO8q=_qO0("\173button}",$_qO8p.$_ql8q,$_ql8o); $_qO8q=_qO0("\173class}","\153ptFi\162\163t",$_qO8q); $_ql8r=_qO0("\173\157nclic\153\175",($this->PageIndex >0) ? "pi\166\157t_gopa\147\145(this,".($this->PageIndex -1)."\051": "",$_qO71); $_ql8r=_qO0("\173title}",$this->PrevPageToolTip ,$_ql8r); $_qO8r=_qO0("\173on\143\154\151ck}",($this->PageIndex >0 && $this->PrevPageText !== NULL) ? "\160ivot\137\147opage(\164\150\151s,".($this->PageIndex -1)."\051": "",$_qO8n); $_qO8r=_qO0("\173te\170\164\175",$this->PrevPageText ,$_qO8r); $_qO8r=_qO0("\173ti\164\154\145}",$this->PrevPageToolTip ,$_qO8r); $_ql8s=_qO0("\173butt\157\156}",$_ql8r.$_qO8r,$_ql8o); $_ql8s=_qO0("\173c\154\141\163s}","\153ptPre\166",$_ql8s); $_qO8s=_qO0("\173\157\156click\175",($this->PageIndex <$this->_qO8g -1) ? "pivot_\147\157\160age\050\164his,".($this->PageIndex +1)."\051": "",$_qO71); $_qO8s=_qO0("\173titl\145\175",$this->NextPageToolTip ,$_qO8s); $_ql8t=_qO0("\173o\156\143\154ick\175",(($this->PageIndex <$this->_qO8g -1) && $this->NextPageText !== NULL) ? "pivot_g\157\160\141ge(t\150\151s,".($this->PageIndex +1)."\051": "",$_qO8n); $_ql8t=_qO0("\173text}",$this->NextPageText ,$_ql8t); $_ql8t=_qO0("\173title}",$this->NextPageToolTip ,$_ql8t); $_qO8t=_qO0("\173\142utton\175",$_ql8t.$_qO8s,$_ql8o); $_qO8t=_qO0("\173cla\163\163\175","\153\160tNext",$_qO8t); $_ql8u=_qO0("\173oncli\143\153\175",($this->PageIndex <$this->_qO8g -1) ? "pi\166\157\164_gop\141\147e(this\054".($this->_qO8g -1)."\051": "",$_qO71); $_ql8u=_qO0("\173\164\151\164le}",$this->LastPageToolTip ,$_ql8u); $_qO8u=_qO0("\173\157\156clic\153\175",(($this->PageIndex <$this->_qO8g -1) && $this->LastPageText !== NULL) ? "\160\151vot_gop\141\147e(this\054".($this->_qO8g -1).")": "",$_qO8n); $_qO8u=_qO0("\173\164ext}",$this->LastPageText ,$_qO8u); $_qO8u=_qO0("\173titl\145\175",$this->LastPageToolTip ,$_qO8u); $_ql8v=_qO0("\173butto\156\175",$_qO8u.$_ql8u,$_ql8o); $_ql8v=_qO0("\173\143lass}","kp\164\114ast",$_ql8v); $_qO8v=_qO0("\173num\142\145\162s}",$_ql8p,$_qO8m); $_qO8v=_qO0("\173prev}",$_ql8s,$_qO8v); $_qO8v=_qO0("\173next}",$_qO8t,$_qO8v); $_qO8v=_qO0("\173\146\151rst}",$_qO8q,$_qO8v); $_qO8v=_qO0("\173last}",$_ql8v,$_qO8v); $_ql8l=($this->ShowPageSize) ? $this->_qO8j(): ""; $_ql8j=($this->ShowPageInfo) ? $this->_ql8h(): ""; $_ql8w=_qO0("\173nav}",$_qO8v,$_ql8m); $_ql8w=_qO0("\173info\175",$_ql8j,$_ql8w); $_ql8w=_qO0("\173page\163\151ze}",$_ql8l,$_ql8w); return $_ql8w; } } class pivotprevnextpager extends pivotpager { var $FirstPageText; var $FirstPageToolTip; var $PrevPageText; var $PrevPageToolTip; var $NextPageText; var $NextPageToolTip; var $LastPageText; var $LastPageToolTip; function _ql5x($_qO8w) { parent::_ql5x($_qO5x); $_qO51=$_qO5x->Localization->_ql62; $_qO8l=$_qO5x->Localization->_qO62; if ($this->FirstPageText === NULL) $this->FirstPageText =$_qO51[_qOj::_qO1w]; if ($this->FirstPageToolTip === NULL) $this->FirstPageToolTip =$_qO8l[_qOj::_ql27]; if ($this->PrevPageText === NULL) $this->PrevPageText =$_qO51[_qOj::_qO1v]; if ($this->PrevPageToolTip === NULL) $this->PrevPageToolTip =$_qO8l[_qOj::_qO26]; if ($this->NextPageText === NULL) $this->NextPageText =$_qO51[_qOj::_ql1v]; if ($this->NextPageToolTip === NULL) $this->NextPageToolTip =$_qO8l[_qOj::_ql26]; if ($this->LastPageText === NULL) $this->LastPageText =$_qO51[_qOj::_ql1w]; if ($this->LastPageToolTip === NULL) $this->LastPageToolTip =$_qO8l[_qOj::_qO27]; } function render() { $_ql8m="<\144\151v clas\163\075'kpt\120\141ger \153\160\164Nex\164\120rev\116\145xtP\141\147er'>\173\160\141gesi\172\145}\173n\141\166\175\173\151\156fo}<\144\151v sty\154\145='cle\141\162:both\047\076</di\166\076</di\166\076"; $_qO8m="\074div c\154\141ss='kp\164\116av'>\173\146\151rst\175\040\173pr\145\166} \173\156\145xt} \173\154ast}<\057\144iv>"; $_qO71="\074inp\165\164\040typ\145\075'butt\157\156' onc\154\151ck='\173\157ncl\151\143k}' t\151\164le='\173\164\151tle\175\047 c\154\141ss=\047\156od\145\143or\047\057>"; $_qO8n="\074a hr\145\146='\152\141va\163\143ri\160\164:\166\157id\0400' \157\156c\154\151ck\075\047\173\157ncl\151\143k}\047 tit\154e='\173\164it\154\145}'\076\173t\145xt}<\057a>"; $_ql8o="\074span\040\143las\163\075 '\173\143las\163\175'>\173\142utt\157n}<\057\163pa\156\076"; $_qO8p=_qO0("\173onc\154\151ck\175",($this->PageIndex >0) ? "\160i\166\157t_\147\157pa\147\145(\164\150i\163\0540\051": "",$_qO71); $_qO8p=_qO0("\173titl\145\175",$this->FirstPageToolTip ,$_qO8p); $_ql8q=_qO0("\173\157ncli\143\153}",($this->PageIndex >0 && $this->FirstPageText !== NULL) ? "\160ivot_\147\157pag\145\050th\151\163,0\051": "",$_qO8n); $_ql8q=_qO0("\173\164\145xt\175",$this->FirstPageText ,$_ql8q); $_ql8q=_qO0("\173\164itle\175",$this->FirstPageToolTip ,$_ql8q); $_qO8q=_qO0("\173\142utt\157\156}",$_qO8p.$_ql8q,$_ql8o); $_qO8q=_qO0("\173class\175","\153pt\106irst",$_qO8q); $_ql8r=_qO0("\173\157ncl\151\143k}",($this->PageIndex >0) ? "\160\151vot\137\147o\160\141g\145(th\151\163,".($this->PageIndex -1)."\051": "",$_qO71); $_ql8r=_qO0("\173\164itl\145\175",$this->PrevPageToolTip ,$_ql8r); $_qO8r=_qO0("\173\157ncli\143\153}",($this->PageIndex >0 && $this->PrevPageText !== NULL) ? "\160iv\157\164_g\157\160ag\145(th\151s,".($this->PageIndex -1).")": "",$_qO8n); $_qO8r=_qO0("\173\164ext}",$this->PrevPageText ,$_qO8r); $_qO8r=_qO0("\173\164itl\145\175",$this->PrevPageToolTip ,$_qO8r); $_ql8s=_qO0("\173\142utt\157\156}",$_ql8r.$_qO8r,$_ql8o); $_ql8s=_qO0("\173clas\163\175","\153\160tP\162\145v",$_ql8s); $_qO8s=_qO0("\173\157nc\154\151ck\175",($this->PageIndex <$this->_qO8g -1) ? "\160ivot_\147\157p\141\147e(\164his\054".($this->PageIndex +1).")": "",$_qO71); $_qO8s=_qO0("\173\164itle\175",$this->NextPageToolTip ,$_qO8s); $_ql8t=_qO0("\173on\143\154ic\153\175",(($this->PageIndex <$this->_qO8g -1) && $this->NextPageText !== NULL) ? "p\151\166ot\137\147op\141\147e\050thi\163\054".($this->PageIndex +1).")": "",$_qO8n); $_ql8t=_qO0("\173\164ext}",$this->NextPageText ,$_ql8t); $_ql8t=_qO0("\173titl\145\175",$this->NextPageToolTip ,$_ql8t); $_qO8t=_qO0("\173bu\164\164on\175",$_ql8t.$_qO8s,$_ql8o); $_qO8t=_qO0("\173\143lass\175","\153ptN\145\170t",$_qO8t); $_ql8u=_qO0("\173\157ncli\143\153}",($this->PageIndex >0) ? "pi\166\157t_\147opag\145\050t\150is,".($this->_qO8g -1)."\051": "",$_qO71); $_ql8u=_qO0("\173\164it\154\145}",$this->LastPageToolTip ,$_ql8u); $_qO8u=_qO0("\173oncl\151\143k}",(($this->PageIndex <$this->_qO8g -1) && $this->LastPageText !== NULL) ? "pi\166\157t_g\157page\050thi\163\054".($this->_qO8g -1)."\051": "",$_qO8n); $_qO8u=_qO0("\173\164ext}",$this->LastPageText ,$_qO8u); $_qO8u=_qO0("\173title\175",$this->LastPageToolTip ,$_qO8u); $_ql8v=_qO0("\173butt\157\156}",$_qO8u.$_ql8u,$_ql8o); $_ql8v=_qO0("\173class}","\153ptLas\164",$_ql8v); $_qO8v=_qO0("\173pr\145\166\175",$_ql8s,$_qO8m); $_qO8v=_qO0("\173\156\145\170t}",$_qO8t,$_qO8v); $_qO8v=_qO0("\173\146\151rst}",$_qO8q,$_qO8v); $_qO8v=_qO0("\173\154\141st}",$_ql8v,$_qO8v); $_ql8l=($this->ShowPageSize) ? $this->_qO8j(): ""; $_ql8j=($this->ShowPageInfo) ? $this->_ql8h(): ""; $_ql8w=_qO0("\173\156\141v}",$_qO8v,$_ql8m); $_ql8w=_qO0("\173info}",$_ql8j,$_ql8w); $_ql8w=_qO0("\173\160\141gesiz\145\175",$_ql8l,$_ql8w); return $_ql8w; } } class pivotnumericpager extends pivotpager { var $Range=012; function render() { $_ql8m="<div c\154\141ss='kp\164\120ager\040\153ptNu\155\145ricPa\147\145r'>\173\160age\163\151ze}\173\156\141v}\173i\156\146o}<di\166\040sty\154\145='cle\141\162:both\047\076</di\166\076</div\076"; $_qO8m="\074div cl\141\163s='kpt\116\141v'>\173\156\165mber\163\175</di\166\076"; $_ql8n="\074a cla\163\163='kptN\165\155 \173s\145\154ecte\144\175' \173\150\162ef}\040\173oncl\151\143k}><s\160\141n>\173n\165\155ber}\074\057spa\156\076</a> "; $_qO8o=floor($this->PageIndex /$this->Range)*$this->Range; $_ql8p=""; if ($_qO8o>0) { $_ql7r=_qO0("\173\150ref}","hr\145\146\075'ja\166\141script\072\166oid \060\047",$_ql8n); $_ql7r=_qO0("\173on\143\154ick}","on\143\154ick='gr\151\144_gopag\145\050this\054".($_qO8o-1).")'",$_ql7r); $_ql7r=_qO0("\173\156umber}","\056..",$_ql7r); $_ql8p.=$_ql7r; } for ($_qO8=$_qO8o; $_qO8<$_qO8o+$this->Range && $_qO8<$this->_qO8g; $_qO8 ++) { $_ql7r=_qO0("\173\156\165mber}",($_qO8+1),$_ql8n); if ($_qO8 == $this->PageIndex) { $_ql7r=_qO0("\173sel\145\143\164ed}","\153ptNu\155\123\145lect\145\144",$_ql7r); $_ql7r=_qO0("\173hr\145\146\175","",$_ql7r); $_ql7r=_qO0("\173\157\156\143lick\175","",$_ql7r); } else { $_ql7r=_qO0("\173selec\164\145\144}","",$_ql7r); $_ql7r=_qO0("\173\150ref}","href='\152\141vascri\160\164:void\040\060'",$_ql7r); $_ql7r=_qO0("\173on\143\154\151ck}","o\156\143\154ick=\047\147rid_go\160\141ge(th\151\163,".$_qO8.")'",$_ql7r); } $_ql8p.=$_ql7r; } if ($_qO8o+$this->Range <$this->_qO8g) { $_ql7r=_qO0("\173h\162\145\146}","href='j\141\166\141scri\160\164:void\040\060'",$_ql8n); $_ql7r=_qO0("\173\157nclick\175","\157\156click='\147\162\151d_go\160\141ge(th\151\163,".($_qO8o+$this->Range)."\051\047",$_ql7r); $_ql7r=_qO0("\173numb\145\162}","\056..",$_ql7r); $_ql7r=_qO0("\173sele\143\164ed}","",$_ql7r); $_ql8p.=$_ql7r; } $_qO8v=_qO0("\173\156\165mbers}",$_ql8p,$_qO8m); $_ql8l=($this->ShowPageSize) ? $this->_qO8j(): ""; $_ql8j=($this->ShowPageInfo) ? $this->_ql8h(): ""; $_ql8w=_qO0("\173nav}",$_qO8v,$_ql8m); $_ql8w=_qO0("\173info}",$_ql8j,$_ql8w); $_ql8w=_qO0("\173\160agesiz\145\175",$_ql8l,$_ql8w); return $_ql8w; } } class pivotmanualpager extends pivotpager { var $ManualPagerTemplate; var $ButtonType="Button"; var $GoPageButtonText; var $TextBoxWidth="\0625px"; function _ql5x($_qO5x) { parent::_ql5x($_qO5x); if ($this->ManualPagerTemplate === NULL) $this->ManualPagerTemplate =$_qO5x->Localization->_qO62[_qOj::_ql25]; if ($this->GoPageButtonText === NULL) $this->GoPageButtonText =$_qO5x->Localization->_ql62[_qOj::_qO1u]; } function _ql8x($_ql6n) { parent::_ql8x($_ql6n); if ( isset ($_ql6n->_ql62[$this->_qO5y ])) { $_qO51=$_ql6n->_ql62[$this->_qO5y ]; $this->PageIndex =( (int) $_POST[$this->_qO5y."_inpu\164"])-1; if ($this->PageIndex >=$this->_qO8g) $this->PageIndex =$this->_qO8g -1; if ($this->PageIndex <0) $this->PageIndex =0; } } function render() { $_ql8m="\074d\151\166 cla\163\163='k\160\164Pag\145\162 kp\164\115anu\141lPa\147\145r'\076\173pa\147\145siz\145\175\173\156\141v}\173\151nfo\175\074di\166\040st\171\154e='\143\154ea\162\072bo\164\150'>\074\057di\166\076<\057\144iv\076"; $_qO8m="<div\040class=\047kptN\141\166'>\173\155ai\156\175<\057\144i\166\076"; $_qO8x="<\151\156put\040\151d=\047\173id\175\047 n\141\155e=\047\173id\175\047 \164\171pe\075\047te\170\164bo\170\047 st\171\154e='w\151\144th\072\173wi\144\164h}\073\047 \166alu\145\075'\173\164ext}\047\057>"; $_qO70=$this->ManualPagerTemplate; $_ql8y=""; switch (strtolower($this->ButtonType)) { case "\154in\153": $_ql8y="<a\040clas\163\075'\153\160tGo\102utto\156\047 h\162ef=\047\152a\166\141sc\162ipt\072\166oi\144\0400' \157\156cli\143\153='g\162id_g\157\160ag\145\050thi\163\0540)\047>\173\164\145x\164\175<\057\141>"; break; case "\151\155age": $_ql8y="<in\160\165t c\154\141ss\075'kp\164\107oB\165\164to\156 kpt\107oIm\141\147e'\040type\075'but\164\157n'\040\157nc\154\151ck=\047\147ri\144\137gop\141\147e(\164\150is\054\060)'\040\057>"; break; case "\142u\164\164on": default : $_ql8y="<i\156put \143\154as\163\075'kp\164GoBu\164\164o\156\047 \164\171p\145='bu\164ton'\040onc\154\151ck\075'gri\144\137go\160\141ge\050thi\163\0540)\047 va\154\165e=\047\173te\170\164}' \057\076"; break; } $_qO8y=_qO0("\173\151d}",$this->_qO5y."_in\160ut",$_qO8x); $_qO8y=_qO0("\173wi\144\164h}",$this->TextBoxWidth ,$_qO8y); $_qO8y=_qO0("\173te\170\164}",$this->PageIndex +1,$_qO8y); $_ql8z=_qO0("\173tex\164\175",$this->GoPageButtonText ,$_ql8y); $_ql8=_qO0("\173Tex\164\102o\170\175",$_qO8y,$_qO70); $_ql8=_qO0("\173\107\157Pag\145\102utt\157\156}",$_ql8z,$_ql8); $_ql8=_qO0("\173\124\157tal\120\141ge\175",$this->_qO8g ,$_ql8); $_qO8v=_qO0("\173m\141\151n}",$_ql8,$_qO8m); $_ql8l=($this->ShowPageSize) ? $this->_qO8j(): ""; $_ql8j=($this->ShowPageInfo) ? $this->_ql8h(): ""; $_ql8w=_qO0("\173\156av\175",$_qO8v,$_ql8m); $_ql8w=_qO0("\173info\175",$_ql8j,$_ql8w); $_ql8w=_qO0("\173\160\141g\145siz\145\175",$_ql8l,$_ql8w); return $_ql8w; } } class pivoteventhandler { function onbeforefieldmove($_qO8z,$_ql5z) { return TRUE; } function onfieldmove($_qO8z,$_ql5z) { } function onbeforefieldsort($_qO8z,$_ql5z) { return TRUE; } function onfieldsort($_qO8z,$_ql5z) { } function _ql83($_qO8z,$_ql5z) { return TRUE; } function _ql84($_qO8z,$_ql5z) { } function onbeforefieldfilter($_qO8z,$_ql5z) { return TRUE; } function onfieldfilter($_qO8z,$_ql5z) { } function onbeforefieldcollapse($_qO8z,$_ql5z) { return TRUE; } function onfieldcollapse($_qO8z,$_ql5z) { } function onbeforefieldexpand($_qO8z,$_ql5z) { return TRUE; } function onfieldexpand($_qO8z,$_ql5z) { } function onbeforegroupexpand($_qO8z,$_ql5z) { return TRUE; } function ongroupexpand($_qO8z,$_ql5z) { } function onbeforegroupcollapse($_qO8z,$_ql5z) { return TRUE; } function ongroupcollapse($_qO8z,$_ql5z) { } function onbeforepagechange($_qO8z,$_ql5z) { return TRUE; } function onpagechange($_qO8z,$_ql5z) { } function onbeforepagesizechange($_qO8z,$_ql5z) { return TRUE; } function onpagesizechange($_qO8z,$_ql5z) { } function onbeforefilterpanelopen($_qO8z,$_ql5z) { return TRUE; } function onfilterpanelopen($_qO8z,$_ql5z) { } function onrefresh($_qO8z,$_ql5z) { } function onbeforecellrender($_qO8z,$_ql5z) { } function onbeforechangesortdata($_qO8z,$_ql5z) { return TRUE; } function onchangesortdata($_qO8z,$_ql5z) { } function onreadingviewstate($_qO8z,&$_ql5z) { return TRUE; } function onsavingviewstate($_qO8z,$_ql5z) { return TRUE; } } class _ql90 { var $RowHeaderMinWidth; } class _qO90 { public $IgnorePaging=FALSE; protected $_ql91=array(); protected $_ql4t=array(); protected $_qO91=array(); protected $_ql45=array(); protected $_ql92=array(); function __construct() { $this->_ql92["\143o\156\146\151\147"]["\160df"]=array("pa\147eOrie\156\164a\164ion" => "L","\160age\104\151m\145\156si\157\156" => array(01130,0620),"font" => array("\146\141mily" => 'FreeSans',"sty\154\145" => "","si\172\145" => 012),); $this->_ql92["\160rope\162\164ie\163"]["ta\142\154e"]=array("\142orde\162" => "\061","ce\154\154sp\141\143i\156\147" => "\060",); $this->config(array("\146i\154\145Nam\145" => "\113oolP\151\166ot\124\141ble\105xpo\162\164","\164em\160\154at\145" => "\173Ko\157\154Pi\166\157tT\141\142le\175","\163ho\167\106il\164\145rZ\157ne" => TRUE,"\163how\104\141taZ\157ne" => TRUE,"\143ase\123\145nsi\164\151ve" => TRUE,"\160df" => $this->_ql92["co\156\146ig"]["\160df"],)); $this->htmlstyle(array("tab\154\145" => "bord\145\162:1\160x so\154\151d\040gr\145\171\073"."\142orde\162\055c\157ll\141\160se\072col\154aps\145;co\154or\072\142lac\153;","tota\154\122ow" => "bac\153\147ro\165\156d\055c\157\154o\162\072l\151ght\142lu\145\073\040f\157nt\055wei\147\150t:\142old\073","\164o\164\141lC\157lumn" => "ba\143\153gro\165\156d-\143\157lor\072li\147htb\154\165e;\040fo\156t-\167eig\150t\072bol\144;","da\164\141Ce\154\154" => "\164ex\164\055al\151\147n:\162\151gh\164;","\145mpt\171\104at\141Cell" => "text\055alig\156\072c\145nter\073","exp\141\156ded\103\145ll" => "\166ert\151\143al\055ali\147\156:\164\157p\073","c\145\154l" => "pa\144\144in\147\0725\160x; b\157\162d\145\162:1\160x s\157\154i\144\040\147\162e\171;",)); $this->htmlproperty(array("\164abl\145" => $this->_ql92["pro\160\145rt\151es"]["tab\154\145"],)); } function config($_ql2y) { if (is_array($_ql2y)) $this->_ql91 =array_merge($this->_ql91 ,$_ql2y); return $this; } function _qO92() { if ( isset ($this->_ql91["p\144f"]["\146ont"]) && is_array($this->_ql91["pd\146"]["\146\157nt"])) $this->_ql91["\160df"]["\146ont"]=array_merge($this->_ql92["\143on\146\151g"]["pdf"]["\146\157nt"],$this->_ql91["\160df"]["\146\157nt"]); if ( isset ($this->_ql91["pd\146"]) && is_array($this->_ql91["pdf"])) $this->_ql91["\160df"]=array_merge($this->_ql92["\143o\156\146ig"]["\160\144f"],$this->_ql91["\160\144f"]); return $this->_ql91; } function htmlstyle($_ql2y) { if (is_array($_ql2y)) $this->_qO91 =array_merge($this->_qO91 ,$_ql2y); return $this; } function _ql93() { return $this->_qO91; } function htmlproperty($_ql2y) { if (is_array($_ql2y)) $this->_ql45 =array_merge($this->_ql45 ,$_ql2y); return $this; } function _ql3z() { if ( isset ($this->_ql45["t\141\142le"]) && is_array($this->_ql45["\164ab\154\145"])) $this->_ql45["\164ab\154\145"]=array_merge($this->_ql92["\160ro\160\145rt\151\145s"]["t\141\142le"],$this->_ql45["t\141\142le"]); return $this->_ql45; } function changetext($_ql2y) { if (is_array($_ql2y)) $this->_ql4t =array_merge($this->_ql4t ,$_ql2y); return $this; } function _qO93() { return $this->_ql4t; } } class _ql94 { private $_ql7c; public static function _ql43() { $_qO94=new _ql94(); $_qO94->_ql7c =array(); return $_qO94; } public function _ql95($_ql3s) { if ( isset ($_ql3s)) { if (!is_array($_ql3s)) $_qO95=array($_ql3s); else $_qO95=$_ql3s; foreach ($_qO95 as $_ql3s) array_push($this->_ql7c ,$_ql3s); } } public function _ql96() { $_ql3s=array_pop($this->_ql7c); return $_ql3s; } public function _ql3a($_ql3s,$_ql55=-1) { if ( isset ($_ql3s)) { if (!is_array($_ql3s)) $_qO95=array($_ql3s); else $_qO95=$_ql3s; if ($_ql55<0 || $_ql55>count($this->_ql7c)) $_ql55=count($this->_ql7c); array_splice($this->_ql7c ,$_ql55,0,$_qO95); } } public function _qO3a($_ql55=-1) { if ($_ql55<0 || $_ql55>count($this->_ql7c)-1) $_ql55=count($this->_ql7c)-1; $_qO95=array_slice($this->_ql7c ,$_ql55,1); if ( isset ($_qO95[0])) return $_qO95[0]; else return NULL; } public function _qO96($_ql55=-1) { if ($_ql55<0) $_ql55=0; else if ($_ql55>count($this->_ql7c)-1) $_ql55=count($this->_ql7c)-1; $_qO95=array_splice($this->_ql7c ,$_ql55,1); if ( isset ($_qO95[0])) return $_qO95[0]; else return NULL; } function _ql97() { return $this->_ql7c; } function _qO3b() { return empty($this->_ql7c); } function _qO14() { return count($this->_ql7c); } } class _qO97 { private $_qO5j; private function __construct() { } public static function _ql43() { $_ql98=new _qO97(); $_ql98->_qO5j =_ql94::_ql43(); return $_ql98; } function _qO98($_ql7n,$_ql55=-1) { $this->_qO5j->_ql3a($_ql7n,$_ql55); return $this; } function _ql99($_ql2y) { if (is_string($_ql2y)) { $_qO5j=$this->_qO99(); foreach ($_qO5j as $_ql5k) if ($_ql5k->FieldName == $_ql2y) return $_ql5k; } return NULL; } function _ql9a($_ql55=-1) { $_ql7n=$this->_qO5j->_qO96($_ql55); return $_ql7n; } function _qlr($_ql55=-1) { $_ql7n=$this->_qO5j->_qO3a($_ql55); return $_ql7n; } function _qO99($_ql55=0) { return array_slice($this->_qO5j->_ql97(),$_ql55); } function _qO9a($_ql55=0) { $_ql46=""; foreach ($this->_qO99($_ql55) as $_ql5k) $_ql46.=$_ql5k->Text."\076\076>"; return rtrim($_ql46,">"); } function _qO14() { return $this->_qO5j->_qO14(); } function _ql9b() { $_qO9b=""; foreach ($this->_qO5j->_ql97() as $_ql5k) { $_qO9b.="_".$_ql5k->_qO5y; $_ql5k->_qOd =$_qO9b; } return $this; } function _ql9c($_ql55=0) { $_qO5j=$this->_qO99($_ql55); foreach ($_qO5j as $_ql5k) { $_ql5k->_qO5e =array(_qOj::_qlr => $_ql5k->_ql6e ,_qOj::_qO2l => $_ql5k->FieldName ,_qOj::_qOt => $_ql5k->_qO6e ,_qOj::_qls => $_ql5k,); if ($_ql5k->_ql6f == _ql2t::_qlp) $_ql5k->_qO5e[_qOj::_ql2l]=$_ql5k->SqlOperator; } return $this; } } class koolpivottable { var $_ql0="3.8.\060.0"; var $_qO5y; var $_qO43; var $_qO9c; var $_ql9d; var $_ql7j; var $_qO9d; var $_ql9e; var $_qO9e=0; var $_ql9f=0; var $_ql6a; var $_qO9f; var $_ql9g=FALSE; var $_qO6r=FALSE; var $_qO9g=FALSE; var $_ql9h=FALSE; var $_qO9h; var $_qO6s; var $_ql6q=array(); var $_ql9i; var $_ql87=array(_ql2t::_qOq => _qOj::_qll,_ql2t::_qlq => _qOj::_qll); var $_qO6q=NULL; var $_qO9i; private $_ql9j=array(_qOj::_qOo => "",_qOj::_qlu => _qOj::_qlm); private $_qO9j=_qOj::_qO2p; var $id; var $scriptFolder; var $styleFolder; var $HorizontalScrolling=FALSE; var $VerticalScrolling=FALSE; var $Pager; var $Width; var $Height; var $AjaxEnabled=FALSE; var $AjaxLoadingImage=NULL; var $AjaxHandlePage; var $ShowColumnZone=TRUE; var $ShowRowZone=TRUE; var $ShowDataZone=TRUE; var $ShowFilterZone=TRUE; var $SeparateDataZone=FALSE; var $SeparateRowZone=FALSE; var $EmptyValue="-"; var $ErrorValue="\055"; var $ShowStatus=TRUE; var $KeepViewStateInSession=FALSE; var $Localization; var $AllowCaching=FALSE; var $CacheFolder; var $CacheTime; var $AllowSorting=FALSE; var $AllowSortingData=FALSE; var $AllowReorder=FALSE; var $AllowFiltering=FALSE; var $Status; var $ClientEvents; var $EventHandler; var $Appearance; var $DataSource; var $ExportSettings; var $_ql5e="\125TF\055\070"; var $ShowGrandColumn=TRUE; var $ShowGrandRow=TRUE; var $CssClasses=array(); var $RowZoneWidth='auto'; var $RowZoneMinWidth='auto'; function __construct($_ql9k) { $this->id =$_ql9k; $this->_qO5y =$_ql9k; foreach (_ql2t::$_qO2t as $_ql30) $this->_ql9e[$_ql30]=_qO97::_ql43(); $this->_qO9c =array(); foreach (array(_ql2t::_qlq => _qOj::_qO2o,_ql2t::_qOq => _qOj::_ql2o) as $_ql30 => $_qle) { $_qO3k=_qO7s::_ql7y($_qle,NULL); $_qO3k->_ql5x($this); $this->_ql7j[$_ql30]=$_qO3k; $_qO9k=_qO7r::_ql7s(); $this->_ql9e[$_ql30]->_qO98($_qO9k); } $this->_ql6a =new _qO5u($this); $this->Localization =new _qO61(); $this->_qO9f =new _qO8d(); $this->Status =new _ql8f(); $this->ClientEvents =array(); $this->EventHandler =new pivoteventhandler(); $this->Appearance =new _ql90(); $this->ExportSettings =new _qO90(); } function adddatafield($_ql5k) { $this->_ql9l($_ql5k,_ql2t::_qlp); return $this; } function addfilterfield($_ql5k) { $this->_ql9l($_ql5k,_ql2t::_qOp); return $this; } function addrowfield($_ql5k) { $this->_ql9l($_ql5k,_ql2t::_qOq); return $this; } function addcolumnfield($_ql5k) { $this->_ql9l($_ql5k,_ql2t::_qlq); return $this; } function _ql9l($_ql5k,$_ql30) { $_ql6h=$_ql5k->FieldName; $_qO6p=$_ql5k->Text; $_qO9l=$_ql6h; $_ql6o=$this->DataSource; $_ql5h=$_ql6o->_qO5k(); if (!empty($_ql5h)) foreach ($_ql5h as $_ql9m) if ($_ql9m["\141li\141\163"] == $_ql6h) $_qO9l=$_ql9m["\145\170pres\163\151on"]; if ($_ql5k instanceof pivotdatefield) { $_ql7q=$_ql5k->getdatefields(); foreach ($_ql7q as $_qO7p => $_qO9m) if ($_qO9m) { $_ql9n=$_ql6h."_".$_qO7p; $_qO9n=$_ql6o->_ql5s($_qO7p)."\050".$_qO9l.")"; $_ql9o=$_qO6p."\047s ".ucfirst($_qO7p); $_ql9m=array("alia\163" => $_ql9n,"\145\170press\151\157n" => $_qO9n); array_push($_ql5h,$_ql9m); $_qO9o=new pivotfield($_ql9n); $_qO9o->Text =$_ql9o; $_qO9o->_qO6g($_qO9n); $this->_ql9e[$_ql30]->_qO98($_qO9o); } } else { $_qO6f=$_ql5k->getvaluemap(); if ( isset ($_qO6f)) { $_ql9p=$_qO6f->getmapfields(); foreach ($_ql9p as $_qO6h => $_ql9n) { if (empty($_ql9n) || $_ql9n == $_ql6h) { $_ql9n=$_ql6h; $_ql9o=$_qO6p; } else { $_ql9o=$_ql9n; } $_qO9o=_qls::_ql43($_ql9n,$_qO6h); $_qO9o->setvaluemap($_qO6f); $_qO9o->Text =$_ql9o; $_qO9o->_qO6g($_qO9l); $this->_ql9e[$_ql30]->_qO98($_qO9o); } } else { $_ql5k->_qO6g($_qO9l); $this->_ql9e[$_ql30]->_qO98($_ql5k); } } return $this; } function getfilterfield($_ql6h) { return $this->_ql99($_ql6h,_ql2t::_qOp); } function getdatafield($_ql6h) { return $this->_ql99($_ql6h,_ql2t::_qlp); } function getrowfield($_ql6h) { return $this->_ql99($_ql6h,_ql2t::_qOq); } function getcolumnfield($_ql6h) { return $this->_ql99($_ql6h,_ql2t::_qlq); } function _ql99($_ql6h,$_ql30) { return $this->_ql9e[$_ql30]->_ql99($_ql6h); } function _qO9p($_ql30,$_ql9q) { $_ql5k=$this->_ql99($_ql9q,$_ql30); $_qO2y=array(); foreach ($_ql5k->_ql6b as $_qO3k) if ($_qO3k->_qO7z()) { $_qO9q=$_qO3k->_ql80(); foreach ($_qO9q as $_qO3q) array_push($_qO2y,$_qO3q); } return $_qO2y; } function _ql9r($_ql30,$_ql9q) { $_ql5k=$this->_ql99($_ql9q,$_ql30); $_qO2y=array(); if (! isset ($_ql5k)) return $_qO2y; foreach ($_ql5k->_ql6b as $_qO3k) if ($_qO3k->_qO7z()) { $_qO9q=$_qO3k->_ql80(); foreach ($_qO9q as $_qO3q) array_push($_qO2y,$_qO3q->Value); } return $_qO2y; } function getgroupnames($_ql9q) { $_qO9r=array(); foreach (array(_ql2t::_qlq,_ql2t::_qOq) as $_ql30) $_qO9r=array_merge($_qO9r,$this->_ql9r($_ql30,$_ql9q)); return $_qO9r; } function getrowgroupnames($_ql9q) { $_qO9r=$this->_ql9r(_ql2t::_qOq,$_ql9q); return $_qO9r; } function getcolumngroupnames($_ql9q) { $_qO9r=$this->_ql9r(_ql2t::_qlq,$_ql9q); return $_qO9r; } function setdatafieldforsorting($_ql5k) { $this->_ql9i =$_ql5k; return $this; } function setinitsortedgroup($_qOg,$_ql7f=_qOj::_qlm) { $this->_ql9j[_qOj::_qOo]=$_qOg; $this->_ql9j[_qOj::_qlu]=$_ql7f; return $this; } function setsortstate($_qle) { $this->_qO9j =$_qle; return $this; } function _ql5x() { $this->_ql6a->_ql5x($this); $_qO2t=0; foreach (_ql2t::$_qO2t as $_ql30) foreach ($this->_ql9e[$_ql30]->_qO99() as $_ql5k) { $_ql5k->_ql5x($this,$_qO2t ++); $_ql5k->_ql6f =$_ql30; } if ( isset ($this->Pager)) $this->Pager->_ql5x($this); $this->_qO9f->_ql5x($this); $this->Status->_ql5x($this); } function _ql9s() { unset ($_POST[$this->_ql5v->_qO5y._qOj::_ql1u]); } function _qO6k() { foreach (_ql2t::$_qO2t as $_ql30) foreach ($this->_ql9e[$_ql30]->_qO99() as $_ql5k) $_ql5k->_qO6k(); if ( isset ($this->Pager)) $this->Pager->_qO6k(); if ( isset ($this->_ql6a->_qO5v[$this->_qO5y ])) { $_ql6l=$this->_ql6a->_qO5v[$this->_qO5y ]; $_qO9s=$_ql6l[_qOj::_qO1n]; $this->_qO9e =$_ql6l[_qOj::_qO1p]; $this->_ql9f =$_ql6l[_qOj::_ql1q]; $this->_qO9h =$_ql6l[_qOj::_ql1o]; $this->_ql6q =$_ql6l[_qOj::_ql1r]; $this->_qO9j =$_ql6l[_qOj::_ql2p]; $_ql9t=array(); foreach (_ql2t::$_qO2t as $_ql30) foreach ($this->_ql9e[$_ql30]->_qO99() as $_ql5k) $_ql9t[$_ql5k->_qO5y ]=$_ql5k; foreach (_ql2t::$_qO2t as $_ql30) { $this->_ql9e[$_ql30]=_qO97::_ql43(); foreach ($_qO9s[$_ql30] as $_qO5y) $this->_ql9e[$_ql30]->_qO98($_ql9t[$_qO5y]); } } else $this->_qO9h =uniqid(); } function _ql6t() { $this->_ql6a->_ql3b(); foreach (_ql2t::$_qO2t as $_ql30) { $_qO9s[$_ql30]=array(); foreach ($this->_ql9e[$_ql30]->_qO99() as $_ql5k) { $_ql5k->_ql6t(); array_push($_qO9s[$_ql30],$_ql5k->_qO5y); } } foreach ($this->_qO9d[_ql2t::_qlq] as $_qO3k) $_qO3k->_ql6t(); foreach ($this->_qO9d[_ql2t::_qOq] as $_qO3k) $_qO3k->_ql6t(); if ( isset ($this->Pager)) $this->Pager->_ql6t(); $this->_ql6a->_qO5v[$this->_qO5y ]=array(_qOj::_qO1n => $_qO9s,_qOj::_ql1o => $this->_qO9h ,_qOj::_ql17 => $this->AllowReorder ,_qOj::_qO1o => $this->HorizontalScrolling ,_qOj::_ql1p => $this->VerticalScrolling ,_qOj::_qO1p => $this->_qO9e ,_qOj::_ql1q => $this->_ql9f ,_qOj::_qO1q => $this->ClientEvents ,_qOj::_ql1r => $this->_ql6q ,_qOj::_ql2p => $this->_qO9j ,); $_ql60=json_encode($this->_ql6a->_qO5v); $this->EventHandler->onsavingviewstate($this,array('pivotId' => $this->id ,'viewstate' => $_ql60)); } function _qO9t($_ql9u,$_qO9u) { $_ql9v=$this->ExportSettings; $_ql91=$_ql9v->_qO92(); $_qO9v=$_ql9v->_ql93(); $_qO47=$_ql9v->_ql3z(); $_ql9w=$this->_ql7j[_ql2t::_qlq]->_qO7j(0); $_qO9w=$this->_ql7j[_ql2t::_qOq]->_qO7j(0); $_ql9w->_ql3z($_ql9x,$_qO9x,$_ql9y,$_qO9y,$_ql9z); $_qO9w->_ql3z($_qO9z,$_qla0,$_qOa0,$_qla1,$_qOa1); $_qO9x=($_qO9x>0) ? $_qO9x: 1; $_qla0=($_qla0>0) ? $_qla0: 1; $_qla2=$this->_ql9e[_ql2t::_qlp]->_qO14(); $_qOa2=($_qla2>1) ? 1: 0; $_qla3="Filt\145r fie\154\144s:\040".$this->_ql9e[_ql2t::_qOp]->_qO9a(); $_qOa3="D\141\164a f\151\145ld\163\072 ".$this->_ql9e[_ql2t::_qlp]->_qO9a(); $_qla4="\103olum\156\040fi\145\154ds:\040".$this->_ql9e[_ql2t::_qlq]->_qO9a(1); $_qOa4="Row f\151\145lds\072\040".$this->_ql9e[_ql2t::_qOq]->_qO9a(1); $_qO2w="ta\142\154e"; $_qO2w.=($this->HorizontalScrolling ? "\040horiz\157\156tal\123\143ro\154l": "").($this->VerticalScrolling ? "\040ver\164\151calS\143\162ol\154": ""); $_qla5=_qO4y::_ql56()->_ql4i(_ql2t::_ql2v($_qO2w))->_qO4j($_qO2w,$_qO47)->_ql4e(_ql2t::_qO2x($_qO9v)); $_qOa5=_qO4y::_ql57()->_ql4i(_ql2t::$_qO2u["\146\151eld\111\164em"])->_ql4j($_qla3); $_qla6=_qO4y::_qO56()->_qO4i($this->_qO5y."_\146\151lte\162\172on\145\105x")->_ql4i(_ql2t::$_qO2u["fil\164\145rZ\157\156e"])->_ql3k($_qOa5); $_qOa6=_qO4y::_ql4z()->_ql4i(_ql2t::$_qO2u["\143ell"])->_qO4j("\143\145ll",$_qO47)->_qO4f($_ql9y*$_qla2+$_qla0)->_ql3k($_qla6); $_qla7=_qO4y::_qO55()->_ql3k($_qOa6); $_qOa7=_qO4y::_qO57('thead'); if ($_ql91["showF\151\154terZ\157\156e"]) $_qOa7->_ql3k($_qla7); $_qOa5=_qO4y::_ql57()->_ql4i(_ql2t::$_qO2u["\146ie\154\144Ite\155"])->_ql4j($_qOa3); $_qla6=_qO4y::_qO56()->_qO4i($this->_qO5y."\137da\164\141zo\156\145Ex")->_ql4i(_ql2t::$_qO2u["\144ata\132\157ne"])->_ql3k($_qOa5); $_qOa6=_qO4y::_ql4z()->_ql4i(_ql2t::$_qO2u["c\145ll"])->_qO4j("\143\145ll",$_qO47)->_qO4f($_qla0)->_ql3k($_qla6); $_qla7=_qO4y::_qO55()->_ql3k($_qOa6); $_qOa5=_qO4y::_ql57()->_ql4i(_ql2t::$_qO2u["f\151\145\154dItem"])->_ql4j($_qla4); $_qla6=_qO4y::_qO56()->_qO4i($this->_qO5y."_c\157\154\165mn\172oneE\170")->_ql4i(_ql2t::$_qO2u["\143o\154\165mnZ\157\156e"])->_ql3k($_qOa5); $_qOa6=_qO4y::_ql4z()->_ql4i(_ql2t::$_qO2u["\143\145\154l"])->_qO4j("cell",$_qO47)->_qO4f($_ql9y*$_qla2)->_ql3k($_qla6); $_qla7->_ql3k($_qOa6); if ($_ql91["s\150owDat\141\132o\156\145"]) $_qOa7->_ql3k($_qla7); $_qla8=array(); for ($_ql55=0; $_ql55<$_qO9x+1; $_ql55 ++) $_qla8[$_ql55]=_qO4y::_qO55(); $_qOa5=_qO4y::_ql57()->_ql4i(_ql2t::$_qO2u["\146ield\111\164em"])->_ql4j($_qOa4); $_qla6=_qO4y::_qO56()->_qO4i($this->_qO5y."\137rowzone\105\170")->_ql4i(_ql2t::$_qO2u["\162\157wZone"])->_ql3k($_qOa5); $_qOa6=_qO4y::_ql4z()->_qO4f($_qla0)->_qO4g($_qO9x+$_qOa2)->_ql3k($_qla6)->_ql4i(_ql2t::$_qO2u["cell"])->_qO4j("\143\145ll",$_qO47); $_qla8[0]->_ql4n($_qOa6,0); foreach ($this->_qO9d[_ql2t::_qlq] as $_qO3k) { $_qO3k->_ql3z($_qO3z,$_ql40,$_qO40,$_ql41,$_qO41); $_qO40=($_qO40>1) ? $_qO40-1: $_qO40; $_qO41=$_ql9y-1-$_qO41; $_qOa8=($_qO3z<0) ? 0: $_qO3z; $_qOa6=_qO4y::_ql4z(); if ($_qO3z>=0) $_qOa6->_qO4f($_qO40*$_qla2)->_qO4g(($_ql40>0) ? 1: ($_qO9x-$_qOa8))->_ql4j($_qO3k->Value)->_ql4i(_ql2t::_ql2v("\143\157\154um\156\110e\141\144er\040cel\154"))->_qO4j("col\165mnHe\141\144e\162\040c\145ll",$_qO47)->_qO4i($_qO3k->_qO5y."Ex"); $_qla9=_qO4y::_ql4z(); if ($_qO3k->_qO7z() || $_qO3z<0) { if ($_qO3z<0) $_ql4s=$_qO3k->Value; else $_ql4s=$_qO3k->_ql8b(); $_qla9->_qO4f($_qla2)->_qO4g($_qO9x-$_qOa8)->_ql4j($_ql4s)->_ql4i(_ql2t::_ql2v("\143ol\165\155nH\145ade\162\040c\157\154u\155\156H\145\141d\145rT\157\164a\154 to\164alCo\154umn \145xpan\144edC\145\154l \143el\154"))->_qO4j("c\157\154um\156\110e\141\144e\162\040c\157lum\156Hea\144erT\157ta\154 to\164al\103olu\155\156 \145\170p\141\156de\144\103el\154 ce\154l",$_qO47); } $_qla8[$_qOa8]->_qO4n(array($_qOa6,$_qla9),$_qO41+1); } if ($_qOa2>0) for ($_qO51=0; $_qO51<$_ql9y; $_qO51 ++) { $_qOa9=$this->_qO9d[_ql2t::_qlq][$_qO51]; $_qO2w=(!$_qOa9->_qO7z()) ? "": "t\157talC\157\154umn"; $_qO2y=array(); for ($_ql40=0; $_ql40<$_qla2; $_ql40 ++) array_push($_qO2y,_qO4y::_ql4z()->_ql4i(_ql2t::_ql2v($_qO2w." \143\145ll dat\141\104esc"))->_qO4j($_qO2w."\040cell da\164\141\104esc",$_qO47)->_ql4j($this->_ql9e[_ql2t::_qlp]->_qlr($_ql40)->renderheadertotal($this->_qO9d[_ql2t::_qlq][$_qO51]->Value))); $_qla8[$_qO9x]->_qO4n($_qO2y,$_qO51+1); } $_qla8[$_qO9x]->_ql4i(_ql2t::$_qO2u["\144ataD\145\163c"])->_qO4j("data\104\145\163c",$_qO47); for ($_ql55=0; $_ql55<$_qO9x+1; $_ql55 ++) $_qla8[$_ql55]->_ql4o(); $_qOa7->_qO4m($_qla8); $_qla5->_ql3k($_qOa7); $_qla8=array(); $_ql3f=new _qO3e(); $_qlaa=array(); if ($_ql9u<0) $_ql9u=0; if ($_qO9u<0) $_qO9u=$_qOa0-1; for ($_ql50=$_ql9u; $_ql50<$_ql9u+$_qO9u; $_ql50 ++) array_push($_qlaa,$_ql50); if ($_qO9u>=0) array_push($_qlaa,$_qOa0-1); foreach ($_qlaa as $_ql50) { $_qla8[$_ql50]=_qO4y::_qO55(); $_qO3k=$this->_qO9d[_ql2t::_qOq][$_ql50]; $_qO3k->_ql3z($_qO3z,$_ql40,$_qO40,$_ql41,$_qO41); $_qO40=($_qO40>1) ? $_qO40-1: $_qO40; $_qO41=$_qOa0-1-$_qO41; if ($_qO3z>=0 && !$_qO3k->_qO7z()) { $_qOa6=_qO4y::_ql4z()->_qO4f(($_ql40>0) ? 1: ($_qla0-$_qO3z))->_qO4g($_qO40)->_ql4j($_qO3k->Value)->_ql4i(_ql2t::_ql2v("cell r\157\167Heade\162"))->_qO4j("cell ro\167\110\145ade\162",$_qO47)->_qO4i($_qO3k->_qO5y."Ex"); $_qla8[$_qO41]->_ql4n($_qOa6,$_qO3z); } if ($_qO3k->_qO7z() || $_qO3z<0) { if ($_qO3z<0) $_ql4s=$_qO3k->Value; else $_ql4s=$_qO3k->_ql8b(); $_qO3z=($_qO3z<0) ? 0: $_qO3z; $_qla9=_qO4y::_ql4z()->_qO4f($_qla0-$_qO3z)->_ql4j($_ql4s)->_ql4i(_ql2t::_ql2v("\143ell ro\167\110\145ade\162\040rowH\145\141derTo\164\141l"))->_qO4j("cell r\157\167\110eade\162\040rowH\145\141derTo\164\141l",$_qO47); $_qla8[$_qO41]->_ql4n($_qla9,$_qO3z)->_ql4i(_ql2t::$_qO2u["\164o\164\141lRo\167"])->_qO4j("\164\157talRow",$_qO47); } $_qOaa=$_qO3k; if ($_qOaa !== $_qO9w) while ($_qOaa->_ql3g !== $_qO9w) { $_qOaa=$_qOaa->_ql3g; $_ql3f->_ql3a($_qOa0-1-$_qOaa->_qO3x()); } } while (!$_ql3f->_qO3b()) { $_qO3k=$this->_qO9d[_ql2t::_qOq][$_ql3f->_qO3a()]; $_qO3k->_ql3z($_qO3z,$_ql40,$_qO40,$_ql41,$_qO41); $_qO40=($_qO40>1) ? $_qO40-1: $_qO40; $_qlab=$_qO3k; while (reset($_qlab->_qO3g)) $_qlab=reset($_qlab->_qO3g); $_qO41=$_qOa0-1-$_qlab->_qO3x(); $_qOab=0; if ($_qO41<$_ql9u) { $_qOab=$_ql9u-$_qO41; $_qO41=$_ql9u; } $_qO40=min($_qO40-$_qOab,$_ql9u+$_qO9u-$_qO41); $_qOa6=_qO4y::_ql4z()->_qO4g($_qO40)->_ql4j($_qO3k->Value)->_ql4i(_ql2t::_ql2v("\143e\154\154 exp\141\156de\144\103e\154l"))->_qO4j("cell\040expan\144edCe\154\154",$_qO47)->_qO4i($_qO3k->_qO5y."\105x"); $_qla8[$_qO41]->_ql4n($_qOa6,$_qO3z); } foreach ($_qlaa as $_ql50) { $_qO2y=array(); for ($_qO51=0; $_qO51<$_ql9y; $_qO51 ++) { $_qOa9=$this->_qO9d[_ql2t::_qlq][$_qO51]; $_qlac=$this->_qO9d[_ql2t::_qOq][$_ql50]; $this->_qO7k($_qOa9,$_qlac,$_ql7l,$_qOac,$_qOd); $_qO2w="c\145\154l"; if ($_qOa9->_qO7z()) { $_qO2w.="\040tot\141\154Colum\156"; } if ($_qlac->_qO7z()) { $_qO2w.="\040\164otalR\157\167"; } for ($_ql40=0; $_ql40<$_qla2; $_ql40 ++) { $_qlad=$this->_ql9e[_ql2t::_qlp]->_qlr($_ql40); $_ql7m=$_qlad->_qO6e; if (! isset ($this->_qO9c[$_ql7l][$_qOac][$_qOd][$_ql7m])) { $_qOad=$_qlad->displayformat($this->EmptyValue); $_qO2w.=" \145\155ptyDat\141\103ell"; } else { $_qOad=$_qlad->displayformat($this->_qO9c[$_ql7l][$_qOac][$_qOd][$_ql7m]); $_qO2w.="\040da\164\141\103ell"; } $_qOa6=_qO4y::_ql4z()->_ql4j($_qOad)->_ql4i(_ql2t::_ql2v($_qO2w))->_qO4j($_qO2w,$_qO47); array_push($_qO2y,$_qOa6); } } $_qla8[$_ql50]->_qO4n($_qO2y,$_qla0); } foreach ($_qlaa as $_ql50) $_qla8[$_ql50]->_ql4o(); $_qla5->_qO4m($_qla8); return $_qla5; } function exporttohtml() { $_ql9v=$this->ExportSettings; $_ql91=$_ql9v->_qO92(); $_qlae=$_ql91["tem\160\154ate"]; ob_end_clean(); header("\120\162agma: p\165\142lic"); header("\105xpir\145\163\072 0"); header("\103ache-\103\157ntrol:\040\155ust-\162\145valid\141\164e, po\163\164-ch\145\143k=0,\040\160re-ch\145\143k=0"); header("\103\141che-Con\164\162ol: pu\142\154ic"); header("\103onten\164\055Descri\160\164ion: \106\151le Tr\141\156sfer"); header("\103onten\164\055Type: \141\160plica\164\151on/fo\162\143e-do\167\156loa\144\073 cha\162\163et=ut\146\0558"); header("Cont\145\156t-\104\151sp\157\163i\164\151o\156: a\164tac\150men\164; f\151le\156ame\075\042".$_ql91["\146ile\116\141me"].".ht\155\154\042"); header("\103onte\156\164-Tr\141nsfe\162-En\143\157d\151ng:\040bi\156ary"); $_ql9u=-1; $_qO9u=-1; if ( isset ($this->Pager) && !$_ql9v->IgnorePaging) { $_ql9u=$this->Pager->PageIndex *$this->Pager->PageSize; $_qO9u=($_ql9u+$this->Pager->PageSize <$this->Pager->_ql8g) ? $this->Pager->PageSize : ($this->Pager->_ql8g -$_ql9u); } $_qla5=$this->_qO9t($_ql9u,$_qO9u); $_qOae=$_qla5->_qO4e().$_qla5->_ql4v($_ql9v->_qO93(),$_ql91["\143ase\123\145ns\151\164iv\145"]); $_qlaf=_qO0("\173\113oo\154\120ivo\164\124ab\154\145}",$_qOae,$_qlae); echo $_qlaf; exit (); } function exporttopdf() { error_reporting(0); if (!class_exists("\124CPD\106",FALSE)) { $_qOaf=dirname(dirname( __FILE__)); require_once $_qOaf."/lib\162\141ry\057tcpd\146\057c\157\156f\151\147/l\141ng/\145\156g\056ph\160"; require_once $_qOaf."\057libr\141\162y/\164\143pd\146/tc\160\144f.\160hp"; } $_ql9v=$this->ExportSettings; $_ql91=$_ql9v->_qO92(); $_qlae=$_ql91["temp\154\141te"]; $_qlag=new tcpdf(PDF_PAGE_ORIENTATION,PDF_UNIT,PDF_PAGE_FORMAT,TRUE,$this->_ql5e ,FALSE); $_qOag=$_ql91["pdf"]["fon\164"]; $_qlag->setfont($_qOag["\146amily"],$_qOag["\163\164yle"],$_qOag["size"]); $_qlag->setautopagebreak(TRUE); $_qlag->addpage($_ql91["pdf"]["pa\147\145Orient\141\164ion"],$_ql91["\160d\146"]["pa\147eDim\145\156s\151\157n"]); $_ql9u=-1; $_qO9u=-1; if ( isset ($this->Pager) && !$_ql9v->IgnorePaging) { $_ql9u=$this->Pager->PageIndex *$this->Pager->PageSize; $_qO9u=($_ql9u+$this->Pager->PageSize <$this->Pager->_ql8g) ? $this->Pager->PageSize : ($this->Pager->_ql8g -$_ql9u); } $_qla5=$this->_qO9t($_ql9u,$_qO9u); $_qOae=$_qla5->_qO4e().$_qla5->_ql4v($_ql9v->_qO93(),$_ql91["\143as\145\123ens\151\164iv\145"]); $_qlaf=_qO0("\173Ko\157\154Pi\166\157tT\141ble\175",$_qOae,$_qlae); ob_end_clean(); $_qlag->writehtml($_qlaf,TRUE,FALSE,FALSE,FALSE,''); $_qlag->output($_ql91["\146ileName"].".\160\144f","\104"); exit (); } function exporttoexcel() { error_reporting(0); if (!class_exists("\120HP\105\170ce\154",FALSE)) { $_qOaf=dirname(dirname( __FILE__)); require_once $_qOaf.'/library/PHPExcel/Classes/PHPExcel.php'; require_once $_qOaf.'/library/PHPExcel/Classes/PHPExcel/Cell.php'; require_once $_qOaf.'/library/PHPExcel/Classes/PHPExcel/IOFactory.php'; } $_ql9v=$this->ExportSettings; $_ql91=$_ql9v->_qO92(); $_qlah=new phpexcel(); $_qlah->setactivesheetindex(0); $_ql9u=-1; $_qO9u=-1; if ( isset ($this->Pager) && !$_ql9v->IgnorePaging) { $_ql9u=$this->Pager->PageIndex *$this->Pager->PageSize; $_qO9u=($_ql9u+$this->Pager->PageSize <$this->Pager->_ql8g) ? $this->Pager->PageSize : ($this->Pager->_ql8g -$_ql9u); } $_qla5=$this->_qO9t($_ql9u,$_qO9u); $_qO2y=$_qla5->_qO4x(); $_qOah=0; $_qlai=1; foreach ($_qO2y as $_qO50) { foreach ($_qO50 as $_ql52) { $_ql3=$_ql52->_qO4s($_ql9v->_qO93(),$_ql91["cas\145Se\156\163i\164\151ve"]); $_ql3=$_ql52->_qO4s(); if ($_ql3 != "\142la\156\153") { $_qO52=$_ql52->_ql4g(); $_qO54=$_ql52->_ql4h(); $_qOai=phpexcel_cell::stringfromcolumnindex($_qOah).$_qlai; $_qlaj=phpexcel_cell::stringfromcolumnindex($_qOah+$_qO52-1).($_qlai+$_qO54-1); $_qlah->getactivesheet()->setcellvalue($_qOai,$_ql3); if ($_qOai != $_qlaj) { $_qlah->getactivesheet()->mergecells($_qOai."\072".$_qlaj); $_qlah->getactivesheet()->getstyle($_qOai)->getalignment()->setvertical(phpexcel_style_alignment::VERTICAL_CENTER); } } $_qOah += 1; } $_qlai ++; $_qOah=0; } $_qlah->getactivesheet()->settitle($_ql91["\146il\145\116am\145"]); $_qlah->setactivesheetindex(0); ob_end_clean(); header('Content-Type: application/vnd.ms-excel'); header('Content-Disposition: attachment;filename="'.$_ql91["f\151leNa\155\145"].'.xls"'); header('Cache-Control: max-age=0'); header('Cache-Control: max-age=1'); header('Last-Modified: '.gmdate('D, d M Y H:i:s').' GMT'); header('Cache-Control: cache, must-revalidate'); header('Pragma: public'); $_qOaj=phpexcel_iofactory::createwriter($_qlah,'Excel5'); $_qOaj->save('php://output'); exit; } function exporttoword() { error_reporting(0); $_ql9v=$this->ExportSettings; $_ql91=$_ql9v->_qO92(); $_qlae=$_ql91["tem\160la\164\145"]; ob_end_clean(); header("P\162\141gm\141\072\040pub\154\151c"); header("\105xpir\145\163:\0400"); header("\103\141ch\145\055C\157\156tr\157l: \155ust\055rev\141\154i\144at\145, p\157st\055che\143\153=\060, p\162\145-c\150eck\0750"); header("\103ach\145\055C\157\156tr\157l: \160\165b\154\151c"); header("Cont\145\156t-D\145scri\160\164i\157\156:\040Fil\145 Tr\141\156s\146er"); header("Con\164\145nt\055Type\072 ap\160\154i\143\141t\151on/\155swo\162d"); header("Co\156\164ent-Di\163\160ositi\157\156: att\141\143hment\073\040fil\145\156ame\075\042".$_ql91["fileNam\145"].".doc\042"); header("\103\157ntent\055\124ransfe\162\055Enco\144\151ng: b\151\156ary"); $_ql9u=-1; $_qO9u=-1; if ( isset ($this->Pager) && !$_ql9v->IgnorePaging) { $_ql9u=$this->Pager->PageIndex *$this->Pager->PageSize; $_qO9u=($_ql9u+$this->Pager->PageSize <$this->Pager->_ql8g) ? $this->Pager->PageSize : ($this->Pager->_ql8g -$_ql9u); } $_qla5=$this->_qO9t($_ql9u,$_qO9u); $_qOae=$_qla5->_qO4e().$_qla5->_ql4v($_ql9v->_qO93(),$_ql91["cas\145Sens\151\164i\166e"],"\047"); $_qlaf=_qO0("\173Koo\154\120iv\157\164T\141\142l\145}",$_qOae,$_qlae); echo $_qlaf; exit (); } function _qO7k($_qOa9,$_qlac,&$_ql7l,&$_qOac,&$_qOd) { $_qOac=$_qOa9->_ql3g->_qO5y.$_qlac->_ql3g->_qO5y; $_qOd=$_qOa9->_ql7u.$_qlac->_ql7u; $_ql7l=$_qOa9->_ql7t->_qOd.$_qlac->_ql7t->_qOd; } function _qlak($_ql30,$_qO3k) { $_qO3k->_ql5x($this); $_qO3k->_qO6k(); if ($this->_qO9j == _qOj::_qO2p && $_qO3k->Value == $this->_ql9j[_qOj::_qOo]) { $_qO3k->_qO81($this->_ql9j[_qOj::_qlu]); $_qO3k->_qO83(); } $_qO3k->_qO6m($this->_qO9f); $this->_qO9i[$_ql30][$_qO3k->_qO5y ]=$_qO3k; return $this; } function _qOak($_ql30,&$_qlal) { $_ql6o=$this->DataSource; $_ql98=$this->_ql9e[$_ql30]; $_qOal=$_ql98->_qlr(0); $_qle=$this->Localization->_ql62[_qOj::_ql20]; $_qlam=_qO7s::_ql7y($_qle,$_qOal); $_qOam=$this->_ql7j[$_ql30]; $_qOam->_ql3k($_qlam); $this->_qlak($_ql30,$_qlam); $_ql3f=new _ql3c(); $_ql3f->_ql3a($_qlam); array_push($_qOal->_ql6b ,$_qOam); while (!$_ql3f->_qO3b()) { $_qO3k=$_ql3f->_qO3a(); $_qO3z=$_qO3k->_qO3t()+2; if ($_qO3z<$_ql98->_qO14()) { $_ql5k=$_ql98->_qlr($_qO3z); $_qlan=$_ql98->_qlr($_qO3z+1); $_qOan=$_ql98->_qlr($_qO3z-1); array_push($_ql5k->_ql6b ,$_qO3k); $_ql5k->_ql3z($_ql6h,$_qO6i,$_ql6j,$_qO6j,$_qlao); $_ql5a=$_qO3k->_ql7v; $_qOao=$_qO3k->_qO7v; $_qlap=array(); $_qOap=FALSE; if (!empty($_qlal[$_ql5k->_qOd ][$_qO3k->_qO5y ][_qOj::_ql1j]) && !$this->_ql9h) { $_qlaq=$_qlal[$_ql5k->_qOd ]; $_qO85=$_qlaq[$_qO3k->_qO5y ][_qOj::_ql1j]; foreach ($_qO85 as $_qOaq) { $_qlar=$_qlaq[$_qOaq]; array_push($_qlap,array(_qOj::_qOs => urldecode($_qlar[_qOj::_qOs]),_qOj::_qlz => $_qlar[_qOj::_qlz],_qOj::_ql15 => $_qlar[_qOj::_ql15],_qOj::_qOu => $_qlar[_qOj::_qOu],_qOj::_ql1g => $_qlar[_qOj::_ql1g],_qOj::_qO1g => $_qlar[_qOj::_qO1g],_qOj::_ql1h => $_qlar[_qOj::_ql1h])); } } else if ($_ql5k->_ql6e == $_qOan->_ql6e) { foreach ($_qO3k->_ql7w as $_qle) array_push($_qlap,array(_qOj::_qOs => $_qle,_qOj::_qOu => $_qle)); $_qOap=TRUE; } else { $_ql5h=array($_ql5k->_qO5e); $_qOar=array(_qOj::_qO1h => _ql1g::_ql59($_ql5a),_qOj::_ql1i => _ql1g::_ql59($_qOao)); $_qO5p=$_ql6o->_ql5l(TRUE)->_ql5m($_ql5h,$_qOar,NULL); $_qO4q=$_ql6o->_queryall($_qO5p); foreach ($_qO4q as $_ql4r) array_push($_qlap,array(_qOj::_qOs => $_ql4r[$_qO6j],_qOj::_qOu => $_ql4r[$_qO6j])); $_qOap=TRUE; } foreach ($_qlap as $_qlas) { $_qle=$_qlas[_qOj::_qOs]; if ($_qOap) $_qle=$_ql5k->_ql6i($_qle); if ($_ql5k->_qO6x($_qle)) { $_qO3q=$_qO3k->_qO7j($_qle); if (empty($_qO3q)) { $_qO3q=_qO7s::_qO7x($_qle,$_ql5k); $_qO3k->_ql3k($_qO3q); if ( isset ($_qlas[_qOj::_qlz])) $_qO3q->_ql82($_qlas[_qOj::_qlz]); if ( isset ($_qlas[_qOj::_ql15])) $_qO3q->_qO81($_qlas[_qOj::_ql15]); $_qO3q->_qO82($_qlas[_qOj::_qOu]); $this->_qlak($_ql30,$_qO3q); $_qO3q->_ql7v =_ql1g::_ql59(); $_qO3q->_qO7v =_ql1g::_ql59(); if ($_qO3z<$_ql98->_qO14()-1) $_qO3q->_qO7t =TRUE; if ($_qO3q->Expand || $_ql5k->_ql6e == $_qlan->_ql6e) $_ql3f->_ql3a($_qO3q); } if ($_qOap) { $_qOas=$_ql6o->_qO5r($_ql6o->_qO5q($_qlas[_qOj::_qOs])); $_qO3q->_ql7v->_ql5c($_ql6j._qO30::_qO34.$_qOas,_qO30::_ql31); $_qO3q->_qO7v->_ql5c($_ql6h._qO30::_qO34.$_qOas,_qO30::_ql31); array_push($_qO3q->_ql7w ,$_qlas[_qOj::_qOs]); } else { $_qO3q->_ql7v =$_qlas[_qOj::_ql1g]; $_qO3q->_qO7v =$_qlas[_qOj::_qO1g]; $_qO3q->_ql7w =$_qlas[_qOj::_ql1h]; } } } foreach ($_qO3k->_qO3g as $_qO3q) { if ($_qO3q->_ql7v instanceof _ql1g) $_qO3q->_ql7v =$_qO3q->_ql7v->_ql5c($_ql5a)->_qO5a(); if ($_qO3q->_qO7v instanceof _ql1g) $_qO3q->_qO7v =$_qO3q->_qO7v->_ql5c($_qOao)->_qO5a(); } if ($this->AllowCaching) { $_qlal[$_ql5k->_qOd ][$_qO3k->_qO5y ]=$_qO3k->_ql85(); foreach ($_qO3k->_qO3g as $_qO3q) { $_qlal[$_ql5k->_qOd ][$_qO3q->_qO5y ]=$_qO3q->_ql85(); } } } } return $_qOam; } function process() { $this->_ql5x(); $this->_qO6k(); if (! isset ($this->_ql6a->_qO5v[$this->_qO5y ])) $this->_ql9g =TRUE; $_ql6n=$this->_qO9f; $_qlat=round(microtime(TRUE)*01750); { if ( isset ($_ql6n->_ql62[$this->_qO5y ])) { $_qO51=$_ql6n->_ql62[$this->_qO5y ]; $_qO6o=$_qO51[_qOj::_qOy]; $_ql6p=$_qO51[_qOj::_qO1m]; switch ($_qO6o) { case _qOj::_ql11: if ($this->EventHandler->onbeforefieldmove($this,array()) == TRUE) { $_qOat=_ql2t::$_qO2t[strtolower($_ql6p[_qOj::_ql1s])]; $_qlau=_ql2t::$_qO2t[strtolower($_ql6p[_qOj::_qO1s])]; $_ql5k=$this->_ql9e[$_qOat]->_ql9a($_ql6p[_qOj::_ql1t]); $this->_ql9e[$_qlau]->_qO98($_ql5k,$_ql6p[_qOj::_qO1t]); $this->EventHandler->onfieldmove($this,array()); } break; case _qOj::_qO10: if ($this->EventHandler->_qOau($this,array()) == TRUE) { $this->_ql9g =TRUE; $this->EventHandler->onrefresh($this,array()); } break; case _qOj::_ql2g: if ($this->EventHandler->onbeforechangesortdata($this,array()) == TRUE) { if ($_ql6p[_qOj::_qO2g] == _qOj::_ql2h) $this->_ql9i =$this->_ql9e[_ql2t::_qlp]->_qlr(0); $this->EventHandler->onchangesortdata($this,array()); } break; } } } $_qlav=round(microtime(TRUE)*01750); $_ql6o=$this->DataSource; foreach (_ql2t::$_qO2t as $_ql30) { $this->_ql9e[$_ql30]->_ql9b()->_ql9c(); $_qO5j[$_ql30]=$this->_ql9e[$_ql30]->_qO99(); } $_qOav=$_qO5j[_ql2t::_qlq]; $_qlaw=$_qO5j[_ql2t::_qOq]; $_qOaw=$_qO5j[_ql2t::_qlp]; $_qlat=round(microtime(TRUE)*01750); { $_qlax=NULL; $this->_ql9d =array(); $this->_qO9c =array(); if ($this->AllowCaching) { $_qlaq=new _ql65($this->CacheFolder ,$this->CacheTime); $_qlaq->_qO5y =$this->_qO9h; if (!$this->_ql9g) { $_qlax=$_qlaq->_qO68(_qOj::_qly); if ( isset ($_qlax[_qOj::_ql12]) && (!$this->_qO6r)) { $_qOax=$_qlax[_qOj::_ql12]; foreach (_ql2t::$_qO2t as $_ql30) if ($_ql30 != _ql2t::_qlp) foreach ($_qO5j[$_ql30] as $_ql5k) $_ql5k->_qO6v($_qOax[$_ql5k->_qO5y ]); } else $this->_qO6r =TRUE; if (!$this->_qO6r) { if ( isset ($_qlax[_qOj::_qO11])) $this->_ql9d =$_qlax[_qOj::_qO11]; } } } else $this->_ql9g =TRUE; } $_qlav=round(microtime(TRUE)*01750); foreach (_ql2t::$_qO2t as $_ql30) foreach ($_qO5j[$_ql30] as $_ql5k) $_ql5k->_qO6m($_ql6n); $_qlat=round(microtime(TRUE)*01750); { if ($this->_ql9g) { $_ql6o->_ql5e =$this->_ql5e; $this->_qO6r =TRUE; } if ($this->_qO6r) { if ( isset ($_qlax[_qOj::_ql13])) $_qlax[_qOj::_ql13]=NULL; $this->_ql9d =NULL; } } $_qlav=round(microtime(TRUE)*01750); $_qlat=round(microtime(TRUE)*01750); { if (! isset ($_qlax[_qOj::_ql13])) $_qlax[_qOj::_ql13]=array(); foreach (array(_ql2t::_qlq,_ql2t::_qOq) as $_ql30) $this->_qOak($_ql30,$_qlax[_qOj::_ql13]); } $_qlav=round(microtime(TRUE)*01750); foreach (array(_ql2t::_qlq,_ql2t::_qOq) as $_ql30) { $_qlay[$_ql30]=$this->_ql7j[$_ql30]->_qO7j(0); } $_qO7i=$_qlay[_ql2t::_qlq]; $_ql7k=$_qlay[_ql2t::_qOq]; $_qlat=round(microtime(TRUE)*01750); { $_qOay=array(); $_qlaz=array(); foreach (_ql2t::$_qO2t as $_ql30) foreach ($_qO5j[$_ql30] as $_ql5k) if ($_ql5k->_ql6u()) array_push($_qOay,$_ql5k->_qO5e); foreach ($_qOaw as $_ql5k) array_push($_qlaz,$_ql5k->_qO5e); foreach ($_qOav as $_qO51 => $_qOaz) foreach ($_qlaw as $_ql50 => $_qlb0) { $_ql7l=$_qOaz->_qOd.$_qlb0->_qOd; $_qOb0=array(); $_qlb1=array(); for ($_ql55=1; $_ql55<=$_qO51; $_ql55 ++) array_push($_qOb0,$_qOav[$_ql55]->_qO5e); for ($_ql55=1; $_ql55<=$_ql50; $_ql55 ++) array_push($_qlb1,$_qlaw[$_ql55]->_qO5e); $_qOb1=array(); $_qlb2=array(); foreach (array($_qOay,$_qOb0,$_qlb1) as $_qOb2) foreach ($_qOb2 as $_qO5e) if (!in_array($_qO5e[_qOj::_qOt],$_qlb2)) { array_push($_qlb2,$_qO5e[_qOj::_qOt]); array_push($_qOb1,$_qO5e); } $_qlb3=array_merge($_qOb1,$_qlaz); $_qOb3=FALSE; $_qlb4=_ql1g::_ql59(); $_qOb4=_ql1g::_ql59(); foreach ($_qOaz->_ql6b as $_qlb5) foreach ($_qlb0->_ql6b as $_qOb5) { $_qOac=$_qlb5->_qO5y.$_qOb5->_qO5y; if (! isset ($this->_ql9d[$_ql7l][$_qOac])) { $_qlb4->_ql5c(_ql1g::_ql59($_qlb5->_ql7v)->_ql5c($_qOb5->_ql7v),_qO30::_ql31); $_qOb4->_ql5c(_ql1g::_ql59($_qlb5->_qO7v)->_ql5c($_qOb5->_qO7v),_qO30::_ql31); $_qOb3=TRUE; } } if ($_qOb3) { $_qO5m=array(_qOj::_qO1h => $_qlb4,_qOj::_ql1i => $_qOb4); $_qO5p=$_ql6o->_ql5l(FALSE)->_ql5m($_qlb3,$_qO5m,$_qOb1); $_ql51=0; $_qO5i=$_ql6o->getquerysize(); while (TRUE) { if ($_qO5i == 0) { $_qO4q=$_ql6o->_queryall($_qO5p); $_qO5i=PHP_INT_MAX; } else if ($_qO5i>0) { $_qO4q=$_ql6o->_querylimit($_qO5p,$_ql51,$_qO5i); $_ql51 += $_qO5i; } $_qlat=round(microtime(TRUE)*01750); foreach ($_qO4q as $_ql4r) { $_qO6t=TRUE; foreach ($_qOay as $_qlb6) { $_ql7n=$_qlb6[_qOj::_qls]; $_qle=$_ql7n->_ql6i($_ql4r[$_qlb6[_qOj::_qOt]]); if (!$_ql7n->_qO6x($_qle)) { $_qO6t=FALSE; break; } } if ($_qO6t) { $_qOa9=$_qO7i; foreach ($_qOb0 as $_qOb6) { $_ql7n=$_qOb6[_qOj::_qls]; $_qle=$_ql7n->_ql6i($_ql4r[$_qOb6[_qOj::_qOt]]); $_qOa9=$_qOa9->_qO7j($_qle); } $_qlac=$_ql7k; foreach ($_qlb1 as $_qlb7) { $_ql7n=$_qlb7[_qOj::_qls]; $_qle=$_ql7n->_ql6i($_ql4r[$_qlb7[_qOj::_qOt]]); $_qlac=$_qlac->_qO7j($_qle); } if ( isset ($_qOa9) && isset ($_qlac)) { $_qOb7=array($_qOa9); $_ql55=$_qO51+1; while ( isset ($_qOav[$_ql55]) && $_qOav[$_ql55]->_ql6e == $_qOaz->_ql6e) { $_qO5e=end($_qlb1); $_qle=$_qOav[$_ql55]->_ql6i($_ql4r[$_qO5e[_qOj::_qOt]]); $_qOa9=$_qOa9->_qO7j($_qle); array_push($_qOb7,$_qOa9); $_ql55 ++; } $_qlb8=array($_qlac); $_ql55=$_ql50+1; while ( isset ($_qlaw[$_ql55]) && $_qlaw[$_ql55]->_ql6e == $_qlb0->_ql6e) { $_qO5e=end($_qlb1); $_qle=$_qlaw[$_ql55]->_ql6i($_ql4r[$_qO5e[_qOj::_qOt]]); $_qlac=$_qlac->_qO7j($_qle); array_push($_qlb8,$_qlac); $_ql55 ++; } foreach ($_qOb7 as $_qOa9) foreach ($_qlb8 as $_qlac) { foreach ($_qlaz as $_qOb8) { $_ql7n=$_qOb8[_qOj::_qls]; $_qle=$_ql7n->_ql6i($_ql4r[$_qOb8[_qOj::_qOt]]); $_ql5k=$_qOb8[_qOj::_qls]; if ( isset ($_ql5k->RelevantField)) { if (strtolower(get_class($_ql5k)) === 'pivotstringfield') $this->_qlb9($_qOa9,$_qlac,$_qOb8[_qOj::_qOt],''); else $this->_qlb9($_qOa9,$_qlac,$_qOb8[_qOj::_qOt],0); if ($_ql5k->RelevantField === $_qlac->_ql7t->FieldName) { if (strtolower(get_class($_ql5k)) === 'pivotstringfield') { $this->_qOb9($_qOa9,$_qlac,$_qOb8[_qOj::_qOt],$_qle); } else $this->_qlba($_qOa9,$_qlac,$_qOb8[_qOj::_qOt],$_qle); } else { $this->_qOb9($_qOa9,$_qlac,$_qOb8[_qOj::_qOt],'NA'); } } else { $this->_qlb9($_qOa9,$_qlac,$_qOb8[_qOj::_qOt],0); $this->_qlba($_qOa9,$_qlac,$_qOb8[_qOj::_qOt],$_qle); } } } } } } $_qlav=round(microtime(TRUE)*01750); if (count($_qO4q)<$_qO5i) break; } } } $this->_qO9c =$this->_ql9d; foreach ($_qOaw as $_qlad) $this->_qO9c =$_qlad->_qO7g($this->_qO9c); } $_qlav=round(microtime(TRUE)*01750); foreach (array(_ql2t::_qlq,_ql2t::_qOq) as $_ql30) $this->_qO9d[$_ql30]=$_qlay[$_ql30]->_qO87(); $_qlat=round(microtime(TRUE)*01750); if ($this->AllowSorting || $this->AllowSortingData) { $_qOba=array(_ql2t::_qOq => FALSE,_ql2t::_qlq => FALSE); $_qlbb=array(_ql2t::_qOq => FALSE,_ql2t::_qlq => FALSE); if ( isset ($this->_qO6q)) { $this->_qObb($this->_qO6q); $_qOba[$this->_qO6q ]=TRUE; } if (!empty($this->_ql6q)) foreach ($this->_ql6q as $_ql30 => $_qO84) if (!empty($_qO84)) { $_qlbc=_ql2t::_qlk($_ql30); if ( isset ($this->_qO9i[$_ql30][$_qO84[_qOj::_qO1i]])) { $_qO3k=$this->_qO9i[$_ql30][$_qO84[_qOj::_qO1i]]; $this->_qObc($_qlbc,$_qO3k); $_qOba[$_qlbc]=TRUE; } $_qlbb[$_qlbc]=TRUE; if (method_exists($_qlay[$_qlbc],'_DoSortingGroups')) $_qlay[$_qlbc]->_dosortinggroups($_qO84[_qOj::_qlu]); } foreach ($_qlbb as $_ql30 => $_qlbd) if ($_qlbd == FALSE) { foreach ($_qO5j[$_ql30] as $_ql5k) $_ql5k->_qO69 =TRUE; $_qlay[$_ql30]->_qO86(); } foreach ($_qOav as $_qO51 => $_qOaz) $_qOaz->_ql6y(); foreach ($_qlaw as $_ql50 => $_qlb0) $_qlb0->_ql6y(); } $_qlav=round(microtime(TRUE)*01750); foreach (array(_ql2t::_qlq,_ql2t::_qOq) as $_ql30) $this->_qO9d[$_ql30]=$_qlay[$_ql30]->_qO87(); foreach ($this->_qO9d[_ql2t::_qlq] as $_qOa9) foreach ($this->_qO9d[_ql2t::_qOq] as $_qlac) { foreach ($_qlaz as $_qOb8) { if ($_qOa9->_qO7z()) { $this->_qOb9($_qOa9,$_qlac,$_qOb8[_qOj::_qOt],0); $_qO9q=$_qOa9->_ql80(); foreach ($_qO9q as $_qO3q) { $_qle=$this->_qO49($_qO3q,$_qlac,$_qOb8[_qOj::_qOt]); $_ql5k=$_qOb8[_qOj::_qls]; if ( isset ($_ql5k->RelevantField)) { $this->_qOb9($_qOa9,$_qlac,$_qOb8[_qOj::_qOt],'NA'); } else $this->_qlba($_qOa9,$_qlac,$_qOb8[_qOj::_qOt],$_qle); } } else if ($_qlac->_qO7z()) { $this->_qOb9($_qOa9,$_qlac,$_qOb8[_qOj::_qOt],0); $_qO9q=$_qlac->_ql80(); foreach ($_qO9q as $_qO3q) { $_qle=$this->_qO49($_qOa9,$_qO3q,$_qOb8[_qOj::_qOt]); $_ql5k=$_qOb8[_qOj::_qls]; if ( isset ($_ql5k->RelevantField)) { $this->_qOb9($_qOa9,$_qlac,$_qOb8[_qOj::_qOt],'NA'); } else $this->_qlba($_qOa9,$_qlac,$_qOb8[_qOj::_qOt],$_qle); } } } $this->_qO9c =$this->_ql9d; foreach ($_qOaw as $_qlad) $this->_qO9c =$_qlad->_qO7g($this->_qO9c); } $_qlat=round(microtime(TRUE)*01750); if ($this->AllowCaching) { $_qOax=array(); foreach (_ql2t::$_qO2t as $_ql30) if ($_ql30 != _ql2t::_qlp) foreach ($_qO5j[$_ql30] as $_ql5k) $_qOax[$_ql5k->_qO5y ]=$_ql5k->_ql6x(); $_qlax[_qOj::_ql12]=$_qOax; foreach ($_qOav as $_qOaz) foreach ($_qlaw as $_qlb0) { $_ql7l=$_qOaz->_qOd.$_qlb0->_qOd; if ( isset ($this->_ql9d[$_ql7l])) $_qlax[_qOj::_qO11][$_ql7l]=$this->_ql9d[$_ql7l]; } $_qlaq->_qO67(_qOj::_qly,$_qlax); } $_qlav=round(microtime(TRUE)*01750); $_qlat=round(microtime(TRUE)*01750); if ( isset ($this->Pager)) { $this->Pager->_ql8g =$_qlay[_ql2t::_qOq]->_qO3w()-1; $this->Pager->_qO6m($_ql6n); } $this->_ql6t(); $_qlav=round(microtime(TRUE)*01750); } function _qlb9($_qOa9,$_qlac,$_qObd,$_qle) { $this->_qO7k($_qOa9,$_qlac,$_ql7l,$_qOac,$_qOd); if (! isset ($this->_ql9d[$_ql7l][$_qOac][$_qOd][$_qObd])) $this->_ql9d[$_ql7l][$_qOac][$_qOd][$_qObd]=$_qle; return $this; } function _qOb9($_qOa9,$_qlac,$_qObd,$_qle) { $this->_qO7k($_qOa9,$_qlac,$_ql7l,$_qOac,$_qOd); $this->_ql9d[$_ql7l][$_qOac][$_qOd][$_qObd]=$_qle; return $this; } function _qlba($_qOa9,$_qlac,$_qObd,$_qle) { $this->_qO7k($_qOa9,$_qlac,$_ql7l,$_qOac,$_qOd); $this->_ql9d[$_ql7l][$_qOac][$_qOd][$_qObd] += $_qle; return $this; } function _qO49($_qOa9,$_qlac,$_qObd) { $this->_qO7k($_qOa9,$_qlac,$_ql7l,$_qOac,$_qOd); if ( isset ($this->_ql9d[$_ql7l][$_qOac][$_qOd][$_qObd])) return $this->_ql9d[$_ql7l][$_qOac][$_qOd][$_qObd]; else return 0; } function _qlbe($_ql50,$_qO51,$_ql40) { $_qO2y=array(); $_qlb8=$this->_qO9p($_ql50[0],$_ql50[1]); $_qOb7=$this->_qO9p($_qO51[0],$_qO51[1]); $_qOa3=$this->_ql99($_ql40,_ql2t::_qlp); $_ql46=$_qOa3->_qO5e; foreach ($_qOb7 as $_qOa9) { $_qObe=array(); foreach ($_qlb8 as $_qlac) { $_qle=$this->_qO49($_qOa9,$_qlac,$_ql46[_qOj::_qOt]); array_push($_qObe,$_qle); } array_push($_qO2y,$_qObe); } return $_qO2y; } function getvalues($_ql50,$_qO51,$_ql40) { $_qO2y=array(); $_qlb8=$this->_qO9p(_ql2t::_qOq,$_ql50); $_qOb7=$this->_qO9p(_ql2t::_qlq,$_qO51); $_qOa3=$this->_ql99($_ql40,_ql2t::_qlp); $_ql46=$_qOa3->_qO5e; foreach ($_qOb7 as $_qOa9) { $_qObe=array(); foreach ($_qlb8 as $_qlac) { $_qle=$this->_qO49($_qOa9,$_qlac,$_ql46[_qOj::_qOt]); array_push($_qObe,$_qle); } array_push($_qO2y,$_qObe); } return $_qO2y; } function _qObb($_qlbf) { foreach ($this->_qO9d[$_qlbf] as $_qO3k) $_qO3k->_qO82($_qO3k->Value); } function _qObc($_qlbf,$_qO84) { foreach ($this->_qO9d[$_qlbf] as $_qO3k) { if ($_qlbf == _ql2t::_qlq) { $_qOa9=$_qO3k; $_qlac=$_qO84; } else if ($_qlbf == _ql2t::_qOq) { $_qOa9=$_qO84; $_qlac=$_qO3k; } else return FALSE; $this->_qO7k($_qOa9,$_qlac,$_ql7l,$_qOac,$_qOd); if (empty($this->_ql9i)) $this->_ql9i =$this->_ql9e[_ql2t::_qlp]->_qlr(0); $_ql7m=$this->_ql9i->_qO6e; if ( isset ($this->_qO9c[$_ql7l][$_qOac][$_qOd][$_ql7m])) $_qO3k->_qOb =$this->_qO9c[$_ql7l][$_qOac][$_qOd][$_ql7m]; else $_qO3k->_qOb =0; } } function _qObf() { $_qO70="\074div\040\151d='\173\151\144}_fil\164\145rzone'\040\143lass\075\047kpt\106\151\154terZ\157\156eDiv'>\173\151tems}<\057\144iv>"; $_qO7d="\074span \143\154ass='kp\164\104esc'>\173\164\145xt}<\057\163\160an\076"; $_ql6w=""; foreach ($this->_ql9e[_ql2t::_qOp]->_qO99() as $_ql5k) { $_ql6w.=$_ql5k->_ql7d(); } if ($_ql6w != "") { $_ql8=_qO0("\173items}",$_ql6w,$_qO70); } else { $_qlbg=_qO0("\173tex\164\175",$this->Localization->_qO62[_qOj::_ql2b],$_qO7d); $_ql8=_qO0("\173\151\164\145ms}",$_qlbg,$_qO70); } $_ql8=_qO0("\173id}",$this->_qO5y ,$_ql8); return $_ql8; } function _qObg() { $_qO70="\074\144iv id=\047\173id}_col\165\155nzone'\040\143lass=\047\153ptCol\165\155nZone\104\151v'>\173\151\164\145ms}<\057\144\151v>"; $_qO7d="\074span cla\163\163='kptDe\163\143'>\173t\145\170\164}</s\160\141n>"; $_ql6w=""; foreach ($this->_ql9e[_ql2t::_qlq]->_qO99(1) as $_ql5k) { $_ql6w.=$_ql5k->_ql7d(); } if ($_ql6w != "") { $_ql8=_qO0("\173item\163\175",$_ql6w,$_qO70); } else { $_qlbg=_qO0("\173text}",$this->Localization->_qO62[_qOj::_ql2a],$_qO7d); $_ql8=_qO0("\173items}",$_qlbg,$_qO70); } $_ql8=_qO0("\173id}",$this->_qO5y ,$_ql8); return $_ql8; } function _qlbh() { $_qO70="<div i\144\075'\173id}\137\162\157wzon\145\047 clas\163\075'kptR\157\167Zone\104\151\166'><t\141\142le cel\154\163pacing\075\0470'st\171\154\145='bo\162\144er:0px\073\047><tbo\144\171\076\173i\164\145\155s}</\164\142\157dy><\057\164able>\074\057div>"; $_qO7d="\074span cl\141\163\163='kp\164\104\145sc'>\173\164ext}</\163\160an>"; $_qO74="<td>\173\146\151\145ld}<\057\164\144>"; $_ql6w=""; foreach ($this->_ql9e[_ql2t::_qOq]->_qO99(1) as $_ql5k) { $_qO6w=_qO0("\173\146ield}",$_ql5k->_ql7d(),$_qO74); $_ql6w.=$_qO6w; } if ($_ql6w != "") { $_ql8=_qO0("\173\151\164ems}",$_ql6w,$_qO70); } else { $_qlbg=_qO0("\173text}",$this->Localization->_qO62[_qOj::_qO2a],$_qO7d); $_ql8=_qO0("\173it\145\155\163}",$_qlbg,$_qO70); } $_ql8=_qO0("\173id}",$this->_qO5y ,$_ql8); return $_ql8; } function _qObh() { $_qO70="<div id=\047\173id}_da\164\141\172one'\040\143lass='\153\160tDat\141\132oneDi\166\047>\173it\145\155s}</di\166\076"; $_qO7d="\074\163pan cl\141\163s='kpt\104\145\163c'>\173\164\145xt}<\057\163pan\076"; $_ql6w=""; foreach ($this->_ql9e[_ql2t::_qlp]->_qO99() as $_ql5k) { $_ql6w.=$_ql5k->_ql7d(_ql2t::_qlp); } if ($_ql6w != "") { $_ql8=_qO0("\173it\145\155\163}",$_ql6w,$_qO70); } else { $_qlbg=_qO0("\173\164\145xt}",$this->Localization->_qO62[_qOj::_qO2b],$_qO7d); $_ql8=_qO0("\173items\175",$_qlbg,$_qO70); } $_ql8=_qO0("\173\151\144\175",$this->_qO5y ,$_ql8); return $_ql8; } function _qlbi() { $_qO70="\074\144iv cla\163\163='kptCo\154\165mnHead\145\162Div'>\074\164able \143\154ass='\153\160\164Tabl\145\047 cells\160\141cing='\060\047 sty\154\145\075'ta\142\154\145-lay\157\165\164: au\164\157\073'><\143\157\154grou\160\076\173col\163\175\074/col\147\162oup>\074\164body>\173\164\162s}</\164\142ody><\057\164able><\057\144iv>"; $_qObi="\074\164\162>\173t\144\163\175</t\162\076"; $_ql70=$this->CssClasses; $_qlbj="<td\173\151\144} clas\163\075\047kpt\103\157\154umnH\145\141der\173\167\162apte\170\164} \173c\163\163\175'\173c\157\154span}\173\162\157wsp\141\156\175>\173\164\145\170t}</\164\144\076"; $_qlbj=_qO0("\173css}",isset ($_ql70['column header']) ? $_ql70['column header']: "",$_qlbj); $_qObj="<td \143\154\141ss='\153\160\164Colu\155\156Header\040\153ptCol\165\155nHea\144\145rTotal\173\167raptex\164\175\040\173c\163\163}'\173c\157\154span}\173\162\157wspan\175\076\173tex\164\175\074/td>"; $_qObj=_qO0("\173css\175",isset ($_ql70['column header']) ? $_ql70['column header']: "",$_qObj); $_qlbk="<td \173\151\144} cla\163\163\075'kpt\103\157lumnH\145\141\144er \153\160tCol\165\155nHeade\162\124\157tal\173\167\162apte\170\164\175 \173\143\163s}'\173\143\157\154span\175\173rowspa\156\175\076\173t\145\170\164}\173\163\157\162t}</\164\144>"; $_qlbk=_qO0("\173css}",isset ($_ql70['column header']) ? $_ql70['column header']: "",$_qlbk); $_qObk="<col/>"; $_qlbl="<tr \143\154\141ss='\153\160\164Dime\156\163ionRow\047\076\173td\163\175</tr\076"; $_qObl="<td></td\076"; $_qlbm=$this->_ql7j[_ql2t::_qlq]->_qO7j(0); $_qObm=$_qlbm->_ql3v(); $_qlbn=$_qlbm->_qO3w(); $_qObn=$this->_ql9e[_ql2t::_qlp]->_qO14(); $_qla8=array(); for ($_qO8=0; $_qO8<$_qObm; $_qO8 ++) { array_push($_qla8,$_qObi); } $_qlbo=""; if ($_qObn>1) { $_qlbo=$_qObi; } $_qObo=$this->_qO9d[_ql2t::_qlq]; $_qO50=""; for ($_qO8=0; $_qO8<count($_qObo); $_qO8 ++) { if ($_qObo[$_qO8]->_ql7t->FieldName == _qOj::_qOn) { if ($this->ShowGrandColumn) { $_qlbp=_qO0("\173\164\145xt\175",$_qObo[$_qO8]->_qO89(),$_qlbk); $_qlbp=_qO0("\173\162ow\163\160a\156\175",($_qObm>1) ? "\040rowspa\156\075'\173\162\157ws\160\141n}'": "",$_qlbp); $_qlbp=_qO0("\173rowspa\156\175",$_qObm,$_qlbp); $_qlbp=_qO0("\173\167\162aptext\175",$_qObo[$_qO8]->_ql7t->HeaderTextWrap ? "": "\040\153ptNoW\162\141p",$_qlbp); $_qlbp=_qO0("\173id}"," id='\173\151\144}'",$_qlbp); $_qlbp=_qO0("\173id}",$_qlbm->_qO5y ,$_qlbp); $_qO7e="\074span \143\154ass='k\160\164Sort\102\165tton \153\160tSor\164\173dir\145\143tion\175\173stat\165\163}' ti\164\154e='\173\164\157olt\151\160}' o\156\143lick=\047\160ivot\137\147roup_\163\157rt_to\147\147le(t\150\151s)'><\057\163pan>"; if ($this->AllowSortingData) { switch (strtolower($_qlbm->_qO7w)) { case _qOj::_qll: $_ql7f=_qO0("\173direc\164\151on}","Asc",$_qO7e); $_ql7f=_qO0("\173toolti\160\175",$this->Localization->_qO62[_qOj::_ql2e],$_ql7f); break; case _qOj::_qlm: $_ql7f=_qO0("\173d\151\162\145ctio\156\175","\104esc",$_qO7e); $_ql7f=_qO0("\173\164ooltip}",$this->Localization->_qO62[_qOj::_qO2e],$_ql7f); break; case _qOj::_qO1j: default : $_ql7f=_qO0("\173\144irecti\157\156}","\101sc",$_qO7e); $_ql7f=_qO0("\173tooltip}",$this->Localization->_qO62[_qOj::_ql2e],$_ql7f); break; } $_qO7f="\117\146\146"; if (!empty($this->_ql6q)) foreach ($this->_ql6q as $_ql30 => $_qO84) if (!empty($_qO84) && $_qO84[_qOj::_qO1i] == $_qlbm->_qO5y) $_qO7f="On"; $_ql7f=_qO0("\173\163tatus}",$_qO7f,$_ql7f); } else $_ql7f=""; $_qlbp=_qO0("\173sor\164\175",$this->AllowSortingData ? $_ql7f: "",$_qlbp); if ($_qObn>1) { $_qlbp=_qO0("\173\143\157\154span\175","\040\143olspan=\047\173colspa\156\175'",$_qlbp); $_qlbp=_qO0("\173colsp\141\156}",$_qObn,$_qlbp); } else { $_qlbp=_qO0("\173\143olspa\156\175","",$_qlbp); } if (! isset ($_qla8[0])) { array_push($_qla8,$_qObi); } $_qla8[0]=_qO0("\173t\144\163\175",$_qlbp,$_qla8[0]); } } else { $_qObp=$_qObo[$_qO8]->_qO3w(); $_qlbq=$_qObo[$_qO8]->_ql3v(); $_qO88=$_qObo[$_qO8]->_qO3t(); $_qOa6=_qO0("\173\151\144}"," id=\047\173id}'",$_qlbj); $_qOa6=_qO0("\173\151\144}",$_qObo[$_qO8]->_qO5y ,$_qOa6); $_qOa6=_qO0("\173\164ext}",$_qObo[$_qO8]->_qO89(),$_qOa6); $_qOa6=_qO0("\173wraptex\164\175",$_qObo[$_qO8]->_ql7t->HeaderTextWrap ? "": "\040kptNo\127\162\141p",$_qOa6); if ($_qObn>1) { $_qOa6=_qO0("\173cols\160\141\156}","\040\143olspan=\047\173colsp\141\156}'",$_qOa6); $_qOa6=_qO0("\173colspan}",(($_qObp>1) ? $_qObp-1: $_qObp)*$_qObn,$_qOa6); } else { $_qOa6=_qO0("\173colspan\175",($_qObp>1) ? "\040\143olspa\156\075'\173co\154\163pan}'": "",$_qOa6); $_qOa6=_qO0("\173colspa\156\175",$_qObp-1,$_qOa6); } if ($_qO88<$_qObm-1&$_qObp<=1) { $_qOa6=_qO0("\173rowspan}"," rowsp\141\156\075'\173\162\157wspa\156\175'",$_qOa6); $_qOa6=_qO0("\173\162\157\167span\175",$_qObm-$_qO88,$_qOa6); } else { $_qOa6=_qO0("\173\162owspan\175","",$_qOa6); } $_qla8[$_qO88]=_qO0("\173\164ds}",$_qOa6."\173tds}",$_qla8[$_qO88]); if ($_qObp>1) { $_qla9=_qO0("\173\164ext}",$_qObo[$_qO8]->_ql8b(),$_qObj); $_qla9=_qO0("\173w\162\141\160text\175",$_qObo[$_qO8]->_ql7t->HeaderTextWrap ? "": "\040kptN\157\127\162ap",$_qla9); $_qla9=_qO0("\173\162owspa\156\175","\040\162owspan=\047\173rowspa\156\175'",$_qla9); $_qla9=_qO0("\173rowspan\175",$_qObm,$_qla9); if ($_qObn>1) { $_qla9=_qO0("\173colspa\156\175"," \143\157lspan='\173\143\157lsp\141\156}'",$_qla9); $_qla9=_qO0("\173cols\160\141\156}",$_qObn,$_qla9); } else { $_qla9=_qO0("\173colsp\141\156\175","",$_qla9); } $_qla8[$_qO88]=_qO0("\173tds}",$_qla9."\173\164ds}",$_qla8[$_qO88]); } } if ($_qObn>1) { $_qObq=""; for ($_qlbr=0; $_qlbr<$_qObn; $_qlbr ++) { $_qO7e="\074spa\156\040\143las\163\075'kptS\157\162tButt\157\156 kpt\123\157rt\173\144\151rect\151\157n}' t\151\164le='\173\164\157olti\160\175' o\156\143lick=\047\160ivot_\147\162oup_s\157\162t_tog\147\154e(thi\163\051'></s\160\141n>"; $_qObr=$this->_ql9e[_ql2t::_qlp]->_qlr($_qlbr)->renderheadertotal($_qObo[$_qO8]->Value); $_qOa6=_qO0("\173id}"," \151\144\075'\173\151\144}'",$_qlbj); $_qOa6=_qO0("\173\151d}",$_qObo[$_qO8]->_qO5y.$_qObr,$_qOa6); $_qOa6=_qO0("\173c\157\154\163pan\175","",$_qOa6); $_qOa6=_qO0("\173rowsp\141\156\175","",$_qOa6); $_qOa6=_qO0("\173text\175",$_qObr,$_qOa6); $_qOa6=_qO0("\173w\162\141\160text\175",$_qObo[$_qO8]->_ql7t->HeaderTextWrap ? "": " \153\160tNoWrap",$_qOa6); $_qObq.=$_qOa6; $_qO50.=$_qObk; } $_qlbo=_qO0("\173tds}",$_qObq."\173\164\144\163}",$_qlbo); } else { $_qO50.=$_qObk; } } $_qlbs=""; for ($_qO8=0; $_qO8<$_qlbn*$_qObn; $_qO8 ++) { $_qlbs.=$_qObl; } $_qObs=_qO0("\173tds}",$_qlbs,$_qlbl); for ($_qO8=0; $_qO8<$_qObm; $_qO8 ++) { $_qla8[$_qO8]=_qO0("\173t\144\163}","",$_qla8[$_qO8]); } $_qlbo=_qO0("\173tds}","",$_qlbo); $_ql8=_qO0("\173\164rs}",implode("",$_qla8).$_qlbo.$_qObs,$_qO70); $_ql8=_qO0("\173col\163\175",$_qO50,$_ql8); return $_ql8; } function _qlbt() { $_qO70="<div \143\154ass='kp\164\122owHea\144\145rDiv'\173\155inwi\144\164h}><\164\141ble \143\154ass='\153\160tTabl\145\047 cell\163\160acin\147\075'0' \076\074colgr\157\165p>\173\143\157ls}</\143olgr\157\165\160><t\142\157dy>\173\164\162s}</\164\142\157dy>\074\057tab\154\145></d\151\166>"; $_qObi="<tr>\173\164\144s}</t\162\076"; $_ql70=$this->CssClasses; $_qlbj="<t\144\040id='\173\151\144\175' c\154\141ss='k\160\164RowH\145\141der\173\167\162apt\145\170t} \173\143\163s}'\173\143\157lspan\175\173rows\160\141\156}>\173\164\145xt}<\057\164d>"; $_qlbj=_qO0("\173css}",isset ($_ql70['row header']) ? $_ql70['row header']: "",$_qlbj); $_qObj="\074\164d cla\163\163='\173c\154\141ss}\173\167\162apte\170\164} \173\143\163s}'\040\163cope=\047\143ol'\173\143\157lspan\175\173rows\160\141n}>\173\164\145xt}</\164\144>"; $_qObj=_qO0("\173\143\163s}",isset ($_ql70['row header']) ? $_ql70['row header']: "",$_qObj); $_qlbk="<td \151\144='\173id\175\047 clas\163\075'kpt\122\157wHead\145\162 \173c\154\141ss} \173\143ss}' \163\143\157pe=\047\143ol'\173\143\157lspa\156\175\173ro\167\163pan}>\173\164\145xt}\173\163ort}<\057\164d>"; $_qlbk=_qO0("\173\143\163s}",isset ($_ql70['row header']) ? $_ql70['row header']: "",$_qlbk); $_qObk="<col/>"; $_qlbm=$this->_ql7j[_ql2t::_qOq]->_qO7j(0); $_qObm=$_qlbm->_ql3v(); $_qlbn=$_qlbm->_qO3w(); $_qObn=$this->_ql9e[_ql2t::_qlp]->_qO14(); $_qObt=$this->_qO9d[_ql2t::_qOq]; $_ql9u=0; $_qO9u=count($_qObt)-1; if ( isset ($this->Pager)) { $_ql9u=$this->Pager->PageIndex *$this->Pager->PageSize; $_qO9u=($_ql9u+$this->Pager->PageSize <$this->Pager->_ql8g) ? $this->Pager->PageSize : ($this->Pager->_ql8g -$_ql9u); } $_qla8=array(); for ($_qO8=0; $_qO8<$_qO9u; $_qO8 ++) { array_push($_qla8,$_qObi); } $_qlbu=array(); $_qO50=""; for ($_qObu=0; $_qObu<$_qObm; $_qObu ++) { $_qlbv=0; for ($_qObv=0; $_qObv<count($_qObt)-1; $_qObv ++) { $_qObp=$_qObt[$_qObv]->_qO3w(); $_qlbq=$_qObt[$_qObv]->_ql3v(); $_qO88=$_qObt[$_qObv]->_qO3t(); if ($_qO88 == $_qObu) { if ($_qObp>1) { if ($_qlbv>=$_ql9u && $_qlbv<$_ql9u+$_qO9u) { $_qOa6=_qO0("\173\151d}",$_qObt[$_qObv]->_qO5y ,$_qlbj); $_qOa6=_qO0("\173\164\145xt}",$_qObt[$_qObv]->_qO89(),$_qOa6); $_qOa6=_qO0("\173wr\141\160\164ex\164\175",$_qObt[$_qObv]->_ql7t->HeaderTextWrap ? "": " kp\164\116oWrap",$_qOa6); $_qOa6=_qO0("\173co\154\163pan}","",$_qOa6); $_qOa6=_qO0("\173r\157\167span}"," row\163\160\141n='\173\162owspa\156\175'",$_qOa6); $_qOa6=_qO0("\173\162owspa\156\175",($_qlbv+$_qObp-1<$_ql9u+$_qO9u) ? ($_qObp-1): ($_ql9u+$_qO9u-$_qlbv),$_qOa6); $_qla8[$_qlbv-$_ql9u]=_qO0("\173tds\175",$_qOa6."\173tds}",$_qla8[$_qlbv-$_ql9u]); } else if ($_qlbv<$_ql9u && $_qlbv+$_qObp-1>$_ql9u) { $_qOa6=_qO0("\173\151d}",$_qObt[$_qObv]->_qO5y ,$_qlbj); $_qOa6=_qO0("\173\164\145xt}",$_qObt[$_qObv]->_qO89(),$_qOa6); $_qOa6=_qO0("\173wrap\164\145xt}",$_qObt[$_qObv]->_ql7t->HeaderTextWrap ? "": "\040kptNoW\162\141p",$_qOa6); $_qOa6=_qO0("\173\143\157lspan}","",$_qOa6); $_qOa6=_qO0("\173rowspan\175","\040\162owspa\156\075'\173ro\167\163pan}\047",$_qOa6); $_qOa6=_qO0("\173\162owspa\156\175",($_qlbv+$_qObp-1<$_ql9u+$_qO9u) ? ($_qlbv+$_qObp-1-$_ql9u): ($_qO9u),$_qOa6); $_qla8[0]=_qO0("\173tds}",$_qOa6."\173\164\144s}",$_qla8[0]); } $_qlbv += ($_qObp-1); if ($_qlbv>=$_ql9u && $_qlbv<$_ql9u+$_qO9u) { $_qla9=_qO0("\173\164\145xt}",$_qObt[$_qObv]->_ql8b(),$_qObj); $_qla9=_qO0("\173\167rapt\145\170\164}",$_qObt[$_qObv]->_ql7t->HeaderTextWrap ? "": "\040kptNo\127\162ap",$_qla9); $_qla9=_qO0("\173row\163\160\141n}","",$_qla9); $_qla9=_qO0("\173\143olspan\175","\040colspan\075\047\173co\154\163pan}'",$_qla9); $_qla9=_qO0("\173\143olspan}",$_qObm,$_qla9); +$_qla9=_qO0("\173\143\154ass}","\153\160\164RowH\145\141\144erT\157\164al",$_qla9); $_qla8[$_qlbv-$_ql9u]=_qO0("\173\164ds}",$_qla9,$_qla8[$_qlbv-$_ql9u]); } $_qlbu[$_qlbv]=1; $_qlbv ++; } else { while ( isset ($_qlbu[$_qlbv])) { $_qlbv ++; } if ($_qlbv>=$_ql9u && $_qlbv<$_ql9u+$_qO9u) { $_qOa6=_qO0("\173\151d}",$_qObt[$_qObv]->_qO5y ,$_qlbj); $_qOa6=_qO0("\173\164ext}",$_qObt[$_qObv]->_qO89(),$_qOa6); $_qOa6=_qO0("\173\167raptext}",$_qObt[$_qObv]->_ql7t->HeaderTextWrap ? "": " kp\164\116\157Wrap",$_qOa6); $_qOa6=_qO0("\173\162owspa\156\175","",$_qOa6); $_qOa6=_qO0("\173\143\157lspan}"," colspa\156\075'\173col\163\160an}'",$_qOa6); $_qOa6=_qO0("\173\143olspan\175",$_qObm-$_qO88,$_qOa6); $_qla8[$_qlbv-$_ql9u]=_qO0("\173tds}",$_qOa6."\173tds}",$_qla8[$_qlbv-$_ql9u]); } $_qlbu[$_qlbv]=1; $_qlbv ++; } } elseif ($_qO88<$_qObu) { $_qlbv ++; } } $_qO50.=$_qObk; } for ($_qO8=0; $_qO8<$_qO9u; $_qO8 ++) { $_qla8[$_qO8]=_qO0("\173\164ds}","",$_qla8[$_qO8]); } $_qlbw=_qO0("\173tds}",$_qlbk,$_qObi); $_qlbw=_qO0("\173rowsp\141\156\175","",$_qlbw); $_qlbw=_qO0("\173\143olspan\175"," c\157\154span='\173\143\157lspa\156\175'",$_qlbw); $_qlbw=_qO0("\173co\154\163\160an}",$_qObm,$_qlbw); $_qlbw=_qO0("\173\143\154ass}","\153ptRowH\145\141\144erGr\141\156dTota\154",$_qlbw); $_qlbw=_qO0("\173\164ext}",$_qlbm->_qO89(),$_qlbw); $_qlbw=_qO0("\173\151\144}",$_qlbm->_qO5y ,$_qlbw); $_qO7e="<s\160\141\156 cl\141\163\163='k\160\164SortB\165\164ton \153\160tSo\162\164\173d\151\162ectio\156\175\173st\141\164us}' \164\151tle=\047\173too\154\164ip}' \157\156click\075\047piv\157\164_grou\160\137sort_\164\157ggle\050\164his)'\076\074/sp\141\156>"; if ($this->AllowSortingData) { switch (strtolower($_qlbm->_qO7w)) { case _qOj::_qll: $_ql7f=_qO0("\173\144irect\151\157n}","Asc",$_qO7e); $_ql7f=_qO0("\173\164\157\157ltip\175",$this->Localization->_qO62[_qOj::_ql2e],$_ql7f); break; case _qOj::_qlm: $_ql7f=_qO0("\173\144irectio\156\175","Desc",$_qO7e); $_ql7f=_qO0("\173\164\157olti\160\175",$this->Localization->_qO62[_qOj::_qO2e],$_ql7f); break; case _qOj::_qO1j: default : $_ql7f=_qO0("\173\144\151recti\157\156}","Asc",$_qO7e); $_ql7f=_qO0("\173\164oolti\160\175",$this->Localization->_qO62[_qOj::_ql2e],$_ql7f); break; } $_qO7f="\117\146f"; if (!empty($this->_ql6q)) foreach ($this->_ql6q as $_ql30 => $_qO84) { if (!empty($_qO84) && $_qO84[_qOj::_qO1i] == $_qlbm->_qO5y) $_qO7f="\117n"; } $_ql7f=_qO0("\173status}",$_qO7f,$_ql7f); } else $_ql7f=""; $_qlbw=_qO0("\173sort}",$this->AllowSortingData ? $_ql7f: "",$_qlbw); $_ql8=$_qO70; $_ql8=_qO0("\173\164rs}",implode("",$_qla8).($this->ShowGrandRow ? $_qlbw: ""),$_ql8); $_ql8=_qO0("\173\143\157ls}",$_qO50,$_ql8); $_ql8=_qO0("\173\155\151nwidth\175",($this->Appearance->RowHeaderMinWidth !== NULL) ? " styl\145\075'min-\167\151\144th\072".$this->Appearance->RowHeaderMinWidth."'": "",$_ql8); return $_ql8; } function _qObw() { $_qO70="\074\144iv cla\163\163='kptC\157\156tent\104\151v'><t\141\142le c\145\154lsp\141\143ing='\060\047 cla\163\163='kpt\124\141\142le\047\040styl\145\075'tabl\145\055layo\165\164: aut\157\073'><co\154\147roup>\173\143ols}<\057\143olgr\157\165\160><t\142\157dy>\173\164\162s}<\057\164body\076\074/tab\154\145></di\166\076"; $_qObi="<tr\076\173tds}</\164\162>"; $_qlbj="<td \143\154\141ss='\153\160tData\103\145ll \173\143\163s}'>\173\164ext\175\074/td>"; $_qObk="<co\154\040/>"; $_qlbx=$this->_qO9d[_ql2t::_qlq]; $_qObx=$this->_qO9d[_ql2t::_qOq]; $_ql9u=0; $_qO9u=count($_qObx)-1; if ( isset ($this->Pager)) { $_ql9u=$this->Pager->PageIndex *$this->Pager->PageSize; $_qO9u=($_ql9u+$this->Pager->PageSize <$this->Pager->_ql8g) ? $this->Pager->PageSize : ($this->Pager->_ql8g -$_ql9u); } $_qO50=""; for ($_qObu=0; $_qObu<count($_qlbx); $_qObu ++) { if ($_qlbx[$_qObu]->_ql7t->FieldName != _qOj::_qOn || $this->ShowGrandColumn) { for ($_qlby=0; $_qlby<$this->_ql9e[_ql2t::_qlp]->_qO14(); $_qlby ++) $_qO50.=$_qObk; } } $_qla8=""; for ($_qObv=$_ql9u; $_qObv<$_ql9u+$_qO9u+($this->ShowGrandRow ? 1: 0); $_qObv ++) { if ($_qObv == $_ql9u+$_qO9u) { $_qObv=count($_qObx)-1; } $_qObq=""; for ($_qObu=0; $_qObu<count($_qlbx); $_qObu ++) { if ($_qlbx[$_qObu]->_ql7t->FieldName != _qOj::_qOn || $this->ShowGrandColumn) { $this->_qO7k($_qlbx[$_qObu],$_qObx[$_qObv],$_ql7l,$_qOac,$_qOd); for ($_qO8=0; $_qO8<$this->_ql9e[_ql2t::_qlp]->_qO14(); $_qO8 ++) { $_qlad=$this->_ql9e[_ql2t::_qlp]->_qlr($_qO8); $_ql7m=$_qlad->_qO6e; $_qle=( isset ($this->_qO9c[$_ql7l][$_qOac][$_qOd][$_ql7m])) ? $_qlad->displayformat($this->_qO9c[$_ql7l][$_qOac][$_qOd][$_ql7m]): $_qlad->displayformat($this->EmptyValue); $_qOa6=_qO0("\173text}",$_qle,$_qlbj); if ( isset ($this->CssClasses['data cell'])) $_qOa6=_qO0("\173css\175",$this->CssClasses['data cell']." \173\143\163s}",$_qOa6); if ($_qObx[$_qObv]->_ql7t->FieldName == _qOj::_qOn) { $_qOa6=_qO0("\173css}"," kptR\157\167Gran\144\124otalDa\164\141Cel\154\173css}",$_qOa6); } else if ($_qObx[$_qObv]->_ql3v()>0) { $_qOa6=_qO0("\173cs\163\175","\040kpt\122\157wT\157\164alDa\164\141Cel\154\173css}",$_qOa6); } if ($_qlbx[$_qObu]->_ql7t->FieldName == _qOj::_qOn) { $_qOa6=_qO0("\173\143ss}","\040\153ptCol\165\155nGrand\124\157talDa\164\141Cell",$_qOa6); } else if ($_qlbx[$_qObu]->_ql3v()>0) { $_qOa6=_qO0("\173css}","\040kptColu\155\156TotalD\141\164aCell",$_qOa6); } else { $_qOa6=_qO0("\173\143ss}","",$_qOa6); } $_qObq.=$_qOa6; } } } $_qla7=_qO0("\173\164\144s}",$_qObq,$_qObi); $_qla8.=$_qla7; } $_ql8=_qO0("\173\164rs}",$_qla8,$_qO70); $_ql8=_qO0("\173co\154\163\175",$_qO50,$_ql8); return $_ql8; } function _qOby() { $_qO70="\074div c\154\141ss='kp\164\126erti\143\141lScro\154\154Div'\040\163t\171\154e='w\151\144th:17\160\170;over\146\154ow-y:\040\163cro\154\154; ove\162\146low-x\072\040hidd\145\156;'><d\151\166 styl\145\075'wid\164\150:17px\047\076</di\166\076</di\166\076"; return $_qO70; } function _qlbz() { $_qO70="<div\040\143lass='\153\160tHori\172\157ntalS\143\162ollD\151\166' st\171\154e='h\145\151ght:1\067\160x;ove\162\146low-x\072\040scr\157\154l; ov\145\162flow-\171\072 hidd\145\156;'><d\151\166 styl\145\075'heig\150\164:17p\170\047></di\166\076</di\166\076"; return $_qO70; } function _qObz() { return $this->Status->_qO5z(); } function renderpivottable() { $this->_qlc0(); $_qOc0="\n<\041\055-Koo\154\120ivotT\141\142le ve\162\163ion ".$this->_ql0." - ww\167\056koolph\160\056net \055\055>\n"; if ( isset ($this->_qO6s)) { $_qO5l=$this->_qO6s->_qO6z(); } else { $_qlc1="\074table\040\143lass='\153\160tTabl\145\173horiz\157\156talsc\162\157lli\156\147\175\173ver\164\151ca\154\163crol\154\151ng}' \143\145llsp\141\143ing='\060\047><co\154\147roup>\173\143\157ls}\074\057colg\162\157up><t\142\157dy>\173\146\151lter_\172\157ne}\173\144ata_\141\156d_col\165\155n_zo\156\145}\173ro\167\137and_\143\157lumnh\145\141der_a\156\144_ver\164\151cal_s\143\162olli\156\147_zone\175\173rowhe\141\144er_a\156\144_con\164\145nt_zo\156\145}\173h\157\162izon\164\141l_sc\162\157lling\137\172one}\173\160ag\145\162_zon\145\175\173st\141\164us_z\157\156e}</\164\142ody>\074\057tabl\145\076"; $_qOc1="<tr><\164\144 colsp\141\156\075'\173\164\157tal_\143\157lspan\175\047 cl\141\163s='k\160\164Filte\162\132one'>\173\172\157ne}\074\057td><\057\164r>"; $_qlc2=""; if ($this->SeparateDataZone) { if ($this->ShowDataZone) $_qlc2.="<tr\076\074td co\154\163pan='\173\164\157tal\137\143olspa\156\175' cl\141\163s='k\160\164DataZ\157\156e'>\173\144\141ta_zo\156\145}</td\076\074/tr>"; if ($this->ShowColumnZone) $_qlc2.="<tr><\164\144 colsp\141\156='\173t\157\164al_c\157\154span}\047\040cl\141\163s='k\160\164Colum\156\132one'>\173\143\157lum\156\137zone}\074\057td><\057\164r>"; } else $_qlc2="\074\164r><td\040\143olspa\156\075'\173d\141\164a_col\163\160an}'\040\143las\163\075'kptD\141\164aZone\047\076\173da\164\141\137zon\145\175</td>\074\164d cla\163\163='kpt\103\157lumnZ\157\156e' co\154\163pan='\173\143olumn\137\143olspa\156\175'>\173c\157\154umn\137\172one}<\057\164d></\164\162>"; $_qOc2="\173zone}"; $_qlc3="\173\172\157ne}"; if ($this->SeparateRowZone) { $_qOc3= "<t\162\076<td co\154\163\160an='\062\047 cla\163\163='kp\164\122owZo\156\145'>\173\162\157w_zon\145\175</td>\074\057tr><\164\162><td \143\157lspan\075\047\173ro\167\137colsp\141\156}' cl\141\163s='' \163\164yle='\167\151dth:$this->RowZoneWidth; mi\156\055width:$this->RowZoneMinWidth'>\046\156bsp;</t\144\076<td c\157\154span=\047\173colum\156\150ead\145\162_col\163\160an}' \143\154ass='\153\160\164Col\165\155nHead\145\162Zone'\076\173colum\156\150eader\137\172one}<\057\164d>\173\166\145\162tic\141\154_scro\154\154ing_z\157\156e}</t\162\076"; } else { $_qOc3= "<tr><td\040\143olspan\075\047\173row\137\143o\154\163pan\175\047\040cl\141ss=\047kpt\122owZo\156e' s\164yle\075'wi\144\164h:$this->RowZoneWidth; mi\156-widt\150\072$this->RowZoneMinWidth'\076\173ro\167\137z\157\156e}\074/td\076<td\040col\163pan\075'\173\143o\154\165m\156\150ea\144\145r\137\143o\154\163p\141\156}'\040cl\141ss=\047kpt\103\157l\165\155n\110\145a\144\145r\132\157n\145\047>\173col\165mnh\145\141d\145\162_\172\157ne\175</t\144\076\173\166e\162\164i\143al_\163\143r\157\154l\151\156g\137\172o\156\145}\074/tr\076"; } $_qlc4="\173z\157\156e}"; $_qOc4="\173zo\156\145}"; $_qlc5="<\164\144 r\157\167sp\141\156=\0472' \143\154a\163\163=\047kp\164Ver\164ic\141lSc\162\157l\154\151n\147\132on\145\047 \163\164y\154e='\167\151dt\150:17\160\170'\076\173z\157\156e\175\074/\164\144>"; $_qOc5="<t\162\076<t\144\040c\157\154sp\141n='\173row\150\145a\144\145r\137co\154\163p\141n}'\040cla\163\163='\153ptRo\167Hea\144\145rZ\157ne'\076\173r\157whe\141\144e\162\137zo\156e}<\057\164d\076<td\040col\163\160a\156\075'\173\143o\156\164e\156\164_\143\157l\163pan\175' c\154ass=\047kp\164\103o\156\164e\156\164Z\157\156e\047>\173\143ont\145nt_\172\157n\145\175<\057td>\074/t\162\076"; $_qlc6="\173\172on\145\175"; $_qOc6="\173\172one}"; $_qlc7="<tr>\074\164d cols\160\141n='\173\164\157tal_c\157\154span\175\047 cla\163\163='kp\164\110orizo\156\164alScr\157\154lingZ\157\156e'>\173\172\157ne}<\057\164d></\164\162>"; $_qOc7="\074\164r><td \143\157lspan\075\047\173to\164\141l_col\163\160an}\047\040cla\163\163='kpt\120\141gerZo\156\145'>\173\172\157ne}</\164\144></tr\076"; $_qlc8="\074tr><td \143\157lspan=\047\173total\137\143olspa\156\175' cl\141\163s='k\160\164Stat\165\163Zone'>\173\172one}<\057\164d></t\162\076"; if ($this->VerticalScrolling) { $_qOc8=3; $_qlc9=1; $_qOc9=2; $_qlca=$_qOca=1; $_qlcb=$_qOcb=1; $_qO50="\074col\040\057><col\040\057><co\154\040style\075\047widt\150\07217p\170\047 />"; } else { $_qOc8=2; $_qlc9=$_qOc9=1; $_qlca=$_qOca=1; $_qlcb=$_qOcb=1; $_qO50="<col /\076\074col /\076"; } $_qO5l=$_qlc1; $_qlcc=""; if ($this->ShowStatus) { $_qlcc=_qO0("\173z\157\156\145}",$this->_qObz(),$_qlc8); $_qlcc=_qO0("\173tota\154\137colspan\175",$_qOc8,$_qlcc); } $_qOcc=""; if ($this->Pager !== NULL) { $_qOcc=_qO0("\173\172one}",$this->Pager->render(),$_qOc7); $_qOcc=_qO0("\173tot\141\154_colsp\141\156}",$_qOc8,$_qOcc); } $_qlcd=""; if ($this->HorizontalScrolling) { $_qlcd=_qO0("\173\172one}",$this->_qlbz(),$_qlc7); $_qlcd=_qO0("\173\164\157tal_co\154\163pan}",$_qOc8,$_qlcd); } $_qOcd=_qO0("\173z\157\156e}",$this->_qObw(),$_qOc6); $_qlce=_qO0("\173\172\157\156e}",$this->_qlbt(),$_qlc6); $_qOce=_qO0("\173row\150\145\141der\137\172\157ne}",$_qlce,$_qOc5); $_qOce=_qO0("\173\143ontent\137\172one}",$_qOcd,$_qOce); $_qOce=_qO0("\173rowhe\141\144er_col\163\160an}",$_qlcb,$_qOce); $_qOce=_qO0("\173conten\164\137\143olsp\141\156}",$_qOcb,$_qOce); $_qlcf=""; if ($this->VerticalScrolling) { $_qlcf=_qO0("\173z\157\156\145}",$this->_qOby(),$_qlc5); } $_qOcf=_qO0("\173zone}",$this->_qlbi(),$_qOc4); $_qlcg=""; if ($this->ShowRowZone) { $_qlcg=_qO0("\173\172\157ne}",$this->_qlbh(),$_qlc4); } $_qOcg=_qO0("\173\166\145rtical\137\163\143rol\154\151ng_zo\156\145}",$_qlcf,$_qOc3); $_qOcg=_qO0("\173\143olumn\150\145ader_z\157\156e}",$_qOcf,$_qOcg); $_qOcg=_qO0("\173row_\172\157\156e}",$_qlcg,$_qOcg); $_qOcg=_qO0("\173column\150\145ader_c\157\154span}",$_qOca,$_qOcg); $_qOcg=_qO0("\173r\157\167\137cols\160\141n}",$_qlca,$_qOcg); $_qlch=""; if ($this->ShowColumnZone) { $_qlch=_qO0("\173\172\157ne}",$this->_qObg(),$_qlc3); } $_qOch=""; if ($this->ShowDataZone) { $_qOch=_qO0("\173\172one}",$this->_qObh(),$_qOc2); } $_qlci=""; if ($_qOch != "" && $_qlch != "" || $this->SeparateDataZone) { $_qlci=_qO0("\173\144\141ta_zon\145\175",$_qOch,$_qlc2); $_qlci=_qO0("\173c\157\154\165mn_z\157\156e}",$_qlch,$_qlci); $_qlci=_qO0("\173dat\141\137\143olsp\141\156}",$_qlc9,$_qlci); $_qlci=_qO0("\173colum\156\137colspa\156\175",$_qOc9,$_qlci); $_qlci=_qO0("\173\164\157tal_col\163\160an}",$_qOc8,$_qlci); } $_qOci=""; if ($this->ShowFilterZone) { $_qOci=_qO0("\173zon\145\175",$this->_qObf(),$_qOc1); $_qOci=_qO0("\173total\137\143olspan\175",$_qOc8,$_qOci); } $_qO5l=_qO0("\173filt\145\162_zone}",$_qOci,$_qlc1); $_qO5l=_qO0("\173data_\141\156d_col\165\155\156_z\157\156e}",$_qlci,$_qO5l); $_qO5l=_qO0("\173\162ow_and\137\143olumnh\145\141der_\141\156d_ver\164\151cal\137\163crol\154\151ng_zo\156\145}",$_qOcg,$_qO5l); $_qO5l=_qO0("\173\162\157wheade\162\137and_c\157\156tent_\172\157ne}",$_qOce,$_qO5l); $_qO5l=_qO0("\173\150orizont\141\154_scrol\154\151ng_zon\145\175",$_qlcd,$_qO5l); $_qO5l=_qO0("\173\160ager_z\157\156e}",$_qOcc,$_qO5l); $_qO5l=_qO0("\173\163tatus_zo\156\145}",$_qlcc,$_qO5l); $_qO5l=_qO0("\173c\157\154s}",$_qO50,$_qO5l); $_qO5l=_qO0("\173\150orizo\156\164alscro\154\154ing}",$this->HorizontalScrolling ? " kpt\110\157rizonta\154\123croll\151\156g": "",$_qO5l); $_qO5l=_qO0("\173\166\145rtical\163\143rollin\147\175",$this->VerticalScrolling ? "\040kpt\126\145\162tica\154\123croll\151\156g": "",$_qO5l); } $_ql8=_qO0("\173\151\144}",$this->id ,_ql7()); if (_qO7($_ql8)) { $_ql8=_qO0("\173\167idth}",($this->Width === NULL) ? "": "\167idth:".$this->Width.";",$_ql8); $_ql8=_qO0("\173h\145\151ght}",($this->Height === NULL) ? "": "h\145\151\147ht:".$this->Height."\073",$_ql8); $_ql8=_qO0("\173styl\145\175",$this->_qO43 ,$_ql8); $_ql8=_qO0("\173tra\144\145\155ark}",$_qOc0,$_ql8); $_ql8=_qO0("\173ta\142\154\145}",$_qO5l,$_ql8); $_ql8=_qO0("\173v\151\145\167stat\145\175",$this->_ql6a->_qO5z(),$_ql8); $_ql8=_qO0("\173\143omma\156\144}",$this->_qO9f->_qO5z(),$_ql8); $_ql8=_qO0("\173\166\145rsio\156\175",$this->_ql0 ,$_ql8); } return $_ql8; } function render() { $_qlcj=$this->registercss(); $_qlcj.=$this->renderpivottable(); $_qOcj= isset ($_POST["__ko\157\154\141jax"]) || isset ($_GET["__\153\157\157laja\170"]); $_qlcj.=($_qOcj) ? "": $this->registerscript(); $_qlcj.="<scri\160\164 type='\164\145xt/ja\166\141scri\160\164'>"; $_qlcj.=$this->startupscript(); $_qlcj.="\074/sc\162\151\160t>"; if ($this->AjaxEnabled && class_exists("Upd\141\164\145Pane\154")) { $_qlck=new updatepanel($this->id."\137updat\145\160\141nel"); $_qlck->content =$_qlcj; $_qlck->cssclass =$this->_qO43."K\120\124_Update\120\141\156el"; if ($this->AjaxLoadingImage) { $_qlck->setloading($this->AjaxLoadingImage); } $_qlcj=$_qlck->render(); } return $_qlcj; } function _qlc0() { $this->styleFolder =_qO0("\134","\057",$this->styleFolder); $_qOck=trim($this->styleFolder ,"\057"); $_qlcl=strrpos($_qOck,"\057"); $this->_qO43 =substr($_qOck,($_qlcl ? $_qlcl: -1)+1); } function registercss() { $this->_qlc0(); $_qOcl="<scr\151\160t type\075\047text/\152\141vasc\162\151pt'>i\146\040(do\143\165men\164\056getEl\145\155entBy\111\144('__\173\163\164yl\145\175KPT')\075\075null\051\173var \137\150ead =\040\144ocum\145\156\164.ge\164\105lemen\164\163ByTa\147\116ame('\150\145ad')\133\060];v\141\162 _lin\153\040= do\143\165ment\056\143reate\105\154emen\164\050'lin\153\047); _l\151\156k.id\040\075 '__\173\163tyle\175\113PT';\137\154ink.r\145\154='st\171\154eshe\145\164'; _l\151\156k.hr\145\146='\173\163\164ylep\141\164h}/\173\163\164yl\145\175/\173\163\164yle}\056\143ss';\137\150ead.\141\160pend\103\150ild\050\137link\051\073}</\163\143ript\076"; $_qlcj=_qO0("\173sty\154\145\175",$this->_qO43 ,$_qOcl); $_qlcj=_qO0("\173styl\145\160ath}",$this->_qlcm(),$_qlcj); return $_qlcj; } function registerscript() { $_qOcl="<script\040\164ype='\164\145xt/ja\166\141scri\160\164'>if(\164\171peo\146\040_li\142\113PT=='u\156\144efine\144\047)\173d\157\143umen\164\056writ\145\050unes\143\141pe(\042\045\063Csc\162\151pt ty\160\145='tex\164\057javas\143\162ipt'\040\163rc='\173\163\162c}\047\0453E \045\063C/sc\162\151pt%3E\042\051);_\154\151bKPT=\061\073}</\163\143ript>"; $_qlcj=_qO0("\173src\175",$this->_qOcm()."\077".md5("js"),$_qOcl); return $_qlcj; } function startupscript() { $_qOcl="var \173\151d}; fu\156\143tion \173\151d}_in\151\164()\173\040\173id}\040\075 ne\167\040KoolP\151\166otTab\154\145('\173i\144\175',\173\101\152axEna\142\154ed},'\173\101jaxH\141\156\144leP\141\147e}');\175"; $_qOcl.="i\146\040(typeof\050\113oolPi\166\157tTabl\145\051=='fu\156\143tio\156\047)\173\173\151d}_in\151\164();}"; $_qOcl.="else\173\151\146(typeo\146\050__KPT\111\156its)=\075\047unde\146\151ned\047\051\173__\113\120TInit\163\075new A\162\162ay();\175\040__KP\124\111nits.\160\165sh(\173\151\144}_ini\164\051;\173r\145\147ister\137\163cript\175\175"; $_qlcn="\151f(typeo\146\050_libKP\124\051=='un\144\145fined\047\051\173v\141\162 _he\141\144 = d\157\143\165men\164\056getEl\145\155\145nts\102\171TagNa\155\145('hea\144\047)[0];\166\141r _sc\162\151pt = \144\157cumen\164\056crea\164\145\105lem\145\156t('sc\162\151pt')\073\040_sc\162\151pt.ty\160\145='tex\164\057java\163\143ript'\073\040_scr\151\160t.src\075\047\173s\162\143}'; _\150\145ad.a\160\160endCh\151\154d(_s\143\162ipt);\137\154ibKP\124\0751;}"; $_qOcn=_qO0("\173src}",$this->_qOcm()."\077".md5("\152\163"),$_qlcn); $_qlcj=_qO0("\173\151d}",$this->id ,$_qOcl); $_qlcj=_qO0("\173\101jaxEna\142\154ed}",$this->AjaxEnabled ? "1": "0",$_qlcj); $_qlcj=_qO0("\173Ajax\110\141ndlePag\145\175",$this->AjaxHandlePage ,$_qlcj); $_qlcj=_qO0("\173\162egiste\162\137\163crip\164\175",$_qOcn,$_qlcj); return $_qlcj; } function _qOcm() { if ($this->scriptFolder == "") { $_ql5=_qO3(); $_qlco=substr(_qO0("\134","\057",__FILE__),strlen($_ql5)); return $_qlco; } else { $_qlco=_qO0("\134","\057",__FILE__); $_qlco=$this->scriptFolder.substr($_qlco,strrpos($_qlco,"\057")); return $_qlco; } } function _qlcm() { $_qOco=$this->_qOcm(); $_qlcp=_qO0(strrchr($_qOco,"/"),"",$_qOco)."/styl\145\163"; return $_qlcp; } } } ?> 
